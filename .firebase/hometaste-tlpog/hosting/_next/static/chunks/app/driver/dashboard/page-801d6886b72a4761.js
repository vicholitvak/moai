(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3904,4597,9946],{1243:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},3927:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>ek});var t=a(95155),r=a(12115),i=a(35695),l=a(25731),n=a(46751),c=a(56671),d=a(97168),o=a(89852),m=a(82714),x=a(88482),u=a(95784),h=a(19946);let g=(0,h.A)("bike",[["circle",{cx:"18.5",cy:"17.5",r:"3.5",key:"15x4ox"}],["circle",{cx:"5.5",cy:"17.5",r:"3.5",key:"1noe27"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["path",{d:"M12 17.5V14l-3-3 4-3 2 3h2",key:"1npguv"}]]);var p=a(71539);let j=(0,h.A)("car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);var v=a(29799),f=a(40646),N=a(13052),y=a(75525),b=a(81586),w=a(42355),A=a(35317);let k=[{id:1,title:"Informaci\xf3n Personal",description:"Datos b\xe1sicos de contacto"},{id:2,title:"Veh\xedculo",description:"Informaci\xf3n de tu veh\xedculo"},{id:3,title:"Pago",description:"Informaci\xf3n bancaria"}],C=[{id:"bike",name:"Bici",icon:g,mapIcon:"\uD83D\uDEB4‍♂️",color:"bg-green-100 border-green-300 text-green-800",description:"Ideal para \xe1reas urbanas",benefits:["Ecol\xf3gico","F\xe1cil estacionamiento","Sin gastos de combustible"]},{id:"motorcycle",name:"Moto",icon:p.A,mapIcon:"\uD83C\uDFCD️",color:"bg-blue-100 border-blue-300 text-blue-800",description:"R\xe1pida y eficiente",benefits:["Entrega r\xe1pida","Econ\xf3mica","Maniobrable"]},{id:"car",name:"Auto",icon:j,mapIcon:"\uD83D\uDE97",color:"bg-purple-100 border-purple-300 text-purple-800",description:"Para pedidos grandes",benefits:["Mayor capacidad","Protecci\xf3n clim\xe1tica","C\xf3modo"]}],D=["Banco de Chile","BancoEstado","Santander","BCI","Scotiabank","Banco Falabella","Banco Ripley","Ita\xfa","BBVA","Banco Security"];function T(e){let{onComplete:s}=e,{user:a}=(0,l.A)(),[i,h]=(0,r.useState)(1),[g,p]=(0,r.useState)(!1),[j,T]=(0,r.useState)({displayName:(null==a?void 0:a.displayName)||"",phone:"",vehicleType:"motorcycle",vehicleInfo:{make:"",model:"",year:new Date().getFullYear(),licensePlate:"",color:""},documents:{driverLicense:"",vehicleRegistration:"",insuranceProof:""},bankInfo:{accountHolderName:(null==a?void 0:a.displayName)||"",bankName:"",accountNumber:"",routingNumber:""}}),E=(e,s)=>{T(a=>({...a,[e]:s}))},S=(e,s,a)=>{T(t=>({...t,[e]:{...t[e]||{},[s]:a}}))},R=e=>{switch(e){case 1:return!!(j.displayName&&j.phone);case 2:return!!j.vehicleType;case 3:return!!(j.bankInfo.accountHolderName&&j.bankInfo.bankName&&j.bankInfo.accountNumber);default:return!0}},I=async()=>{if(a){p(!0);try{let e=A.Dc.now(),t={displayName:j.displayName,email:a.email||"",avatar:a.photoURL||"",phone:j.phone,vehicleType:j.vehicleType,vehicleInfo:{make:L.name,model:L.name,year:new Date().getFullYear(),licensePlate:"N/A",color:"N/A"},currentLocation:{coordinates:{latitude:0,longitude:0,timestamp:e},address:{street:"",city:"",state:"",zipCode:"",country:"Chile",fullAddress:""},isActive:!1,lastUpdated:e},isOnline:!1,isAvailable:!1,rating:5,reviewCount:0,totalDeliveries:0,completionRate:100,earnings:{today:0,thisWeek:0,thisMonth:0,total:0},workingHours:{start:"08:00",end:"20:00"},workingDays:["monday","tuesday","wednesday","thursday","friday"],lastLocationUpdate:e};if(!await n.DriversService.createDriverProfile(t,a.uid))throw Error("Failed to create driver profile");c.oR.success("\xa1Perfil de conductor creado exitosamente! Bienvenido a tu dashboard."),s()}catch(e){console.error("Error creating driver profile:",e),c.oR.error("Error al crear el perfil. Int\xe9ntalo de nuevo.")}finally{p(!1)}}},L=C.find(e=>e.id===j.vehicleType);return(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"w-full max-w-4xl",children:[(0,t.jsxs)("div",{className:"bg-white rounded-t-xl p-6 border-b",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"\xa1\xdanete como Conductor! \uD83D\uDE97"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Comienza a ganar dinero entregando pedidos"})]}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)(v.A,{className:"h-8 w-8 text-blue-500"})})]}),(0,t.jsx)("div",{className:"flex items-center justify-between overflow-x-auto px-2",children:k.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center min-w-0 flex-shrink-0",children:[(0,t.jsx)("div",{className:"flex items-center justify-center w-8 h-8 sm:w-10 sm:h-10 rounded-full border-2 ".concat(i>=e.id?"bg-blue-500 border-blue-500 text-white":"border-gray-300 text-gray-400"),children:i>e.id?(0,t.jsx)(f.A,{className:"h-4 w-4 sm:h-5 sm:w-5"}):(0,t.jsx)("span",{className:"text-xs sm:text-sm font-medium",children:e.id})}),(0,t.jsxs)("div",{className:"ml-2 sm:ml-3 min-w-0",children:[(0,t.jsx)("p",{className:"text-xs sm:text-sm font-medium truncate ".concat(i>=e.id?"text-blue-600":"text-gray-400"),children:e.title}),(0,t.jsx)("p",{className:"text-xs text-gray-500 truncate hidden sm:block",children:e.description})]}),s<k.length-1&&(0,t.jsx)(N.A,{className:"h-4 w-4 sm:h-5 sm:w-5 text-gray-300 mx-2 sm:mx-4 flex-shrink-0"})]},e.id))})]}),(0,t.jsxs)("div",{className:"bg-white rounded-b-xl p-8",children:[1===i&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Informaci\xf3n Personal"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Cu\xe9ntanos qui\xe9n eres para comenzar"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(m.J,{htmlFor:"displayName",children:"Nombre completo *"}),(0,t.jsx)(o.p,{id:"displayName",value:j.displayName,onChange:e=>E("displayName",e.target.value),placeholder:"Tu nombre como aparecer\xe1 para los clientes"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(m.J,{htmlFor:"phone",children:"N\xfamero de tel\xe9fono *"}),(0,t.jsx)(o.p,{id:"phone",value:j.phone,onChange:e=>E("phone",e.target.value),placeholder:"+56 9 1234 5678"})]})]}),(0,t.jsx)(x.Zp,{className:"bg-blue-50 border-blue-200",children:(0,t.jsx)(x.Wu,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(y.A,{className:"h-5 w-5 text-blue-600"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-blue-800",children:"Tu informaci\xf3n est\xe1 segura"}),(0,t.jsx)("p",{className:"text-xs text-blue-600",children:"Solo se compartir\xe1 lo necesario para las entregas"})]})]})})})]}),2===i&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Tu Veh\xedculo"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Selecciona tu m\xe9todo de entrega"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(m.J,{className:"text-2xl font-bold mb-8 block text-center text-gray-800",children:"\xa1Elige tu veh\xedculo de entrega!"}),(0,t.jsx)("div",{className:"grid grid-cols-3 gap-2 sm:gap-4 md:gap-8 max-w-6xl mx-auto px-2 sm:px-4",children:C.map(e=>(0,t.jsx)("div",{className:"group cursor-pointer transition-all duration-300 transform hover:scale-105 ".concat(j.vehicleType===e.id?"scale-105":"hover:shadow-2xl"),onClick:()=>E("vehicleType",e.id),children:(0,t.jsxs)(x.Zp,{className:"relative overflow-hidden border-4 transition-all duration-300 ".concat(j.vehicleType===e.id?"ring-4 ring-moai-orange ring-opacity-50 border-moai-orange bg-gradient-to-br from-orange-50 to-orange-100 shadow-2xl":"border-gray-200 hover:border-gray-300 bg-white hover:shadow-xl"),children:[j.vehicleType===e.id&&(0,t.jsx)("div",{className:"absolute top-4 right-4 z-10",children:(0,t.jsx)("div",{className:"bg-moai-orange text-white rounded-full p-2",children:(0,t.jsx)(f.A,{className:"h-6 w-6"})})}),(0,t.jsxs)(x.Wu,{className:"p-3 sm:p-6 md:p-8 text-center relative",children:[(0,t.jsx)("div",{className:"text-4xl sm:text-6xl md:text-8xl mb-2 sm:mb-4 transform group-hover:scale-110 transition-transform duration-300",children:e.mapIcon}),(0,t.jsx)(e.icon,{className:"h-6 w-6 sm:h-8 sm:w-8 md:h-12 md:w-12 mx-auto mb-2 sm:mb-4 transition-colors duration-300 ".concat(j.vehicleType===e.id?"text-moai-orange":"text-gray-500 group-hover:text-gray-700")}),(0,t.jsx)("h3",{className:"font-bold text-sm sm:text-lg md:text-2xl mb-1 sm:mb-3 transition-colors duration-300 ".concat(j.vehicleType===e.id?"text-moai-orange":"text-gray-800"),children:e.name}),e.description&&(0,t.jsx)("p",{className:"text-xs sm:text-sm md:text-base mb-2 sm:mb-4 font-medium transition-colors duration-300 ".concat(j.vehicleType===e.id?"text-orange-700":"text-gray-600"),children:e.description}),e.benefits&&e.benefits.length>0&&(0,t.jsx)("div",{className:"space-y-1 sm:space-y-2 hidden sm:block",children:e.benefits.map((s,a)=>(0,t.jsxs)("div",{className:"flex items-center justify-center text-xs sm:text-sm font-medium transition-colors duration-300 ".concat(j.vehicleType===e.id?"text-orange-600":"text-gray-500"),children:[(0,t.jsx)(f.A,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 sm:mr-2 transition-colors duration-300 ".concat(j.vehicleType===e.id?"text-green-600":"text-green-500")}),s]},a))}),(0,t.jsx)("div",{className:"mt-2 sm:mt-6 py-2 sm:py-3 px-1 sm:px-4 md:px-6 rounded-full font-bold text-xs sm:text-sm md:text-base transition-all duration-300 whitespace-nowrap overflow-hidden ".concat(j.vehicleType===e.id?"bg-moai-orange text-white shadow-lg":"bg-gray-100 text-gray-600 group-hover:bg-gray-200"),children:(0,t.jsx)("span",{className:"block truncate",children:j.vehicleType===e.id?"\xa1Seleccionado!":"Seleccionar"})})]})]})},e.id))})]})]}),3===i&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"text-center mb-8",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Informaci\xf3n de Pago"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Para depositar tus ganancias"})]}),(0,t.jsx)(x.Zp,{className:"bg-green-50 border-green-200",children:(0,t.jsx)(x.Wu,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(b.A,{className:"h-5 w-5 text-green-600"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium text-green-800",children:"Pagos semanales"}),(0,t.jsx)("p",{className:"text-xs text-green-600",children:"Recibe tus ganancias cada viernes"})]})]})})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(m.J,{htmlFor:"accountHolderName",children:"Nombre del titular *"}),(0,t.jsx)(o.p,{id:"accountHolderName",value:j.bankInfo.accountHolderName,onChange:e=>S("bankInfo","accountHolderName",e.target.value),placeholder:"Nombre completo como aparece en la cuenta"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(m.J,{htmlFor:"bankName",children:"Banco *"}),(0,t.jsxs)(u.l6,{onValueChange:e=>S("bankInfo","bankName",e),children:[(0,t.jsx)(u.bq,{className:"bg-white",children:(0,t.jsx)(u.yv,{placeholder:"Selecciona tu banco"})}),(0,t.jsx)(u.gC,{className:"bg-white border shadow-lg",children:D.map(e=>(0,t.jsx)(u.eb,{value:e,className:"bg-white hover:bg-gray-50 text-gray-900",children:e},e))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(m.J,{htmlFor:"accountNumber",children:"N\xfamero de cuenta *"}),(0,t.jsx)(o.p,{id:"accountNumber",value:j.bankInfo.accountNumber,onChange:e=>S("bankInfo","accountNumber",e.target.value),placeholder:"N\xfamero de cuenta corriente"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(m.J,{htmlFor:"routingNumber",children:"RUT *"}),(0,t.jsx)(o.p,{id:"routingNumber",value:j.bankInfo.routingNumber,onChange:e=>S("bankInfo","routingNumber",e.target.value),placeholder:"12.345.678-9"})]})]})]}),(0,t.jsxs)("div",{className:"flex justify-between mt-8 pt-6 border-t",children:[(0,t.jsxs)(d.$,{variant:"outline",onClick:()=>{h(e=>Math.max(e-1,1)),window.scrollTo({top:0,behavior:"smooth"})},disabled:1===i,children:[(0,t.jsx)(w.A,{className:"h-4 w-4 mr-2"}),"Anterior"]}),i<k.length?(0,t.jsxs)(d.$,{onClick:()=>{R(i)?(h(e=>Math.min(e+1,k.length)),window.scrollTo({top:0,behavior:"smooth"})):c.oR.error("Por favor completa todos los campos requeridos")},disabled:!R(i),children:["Siguiente",(0,t.jsx)(N.A,{className:"h-4 w-4 ml-2"})]}):(0,t.jsx)(d.$,{onClick:I,disabled:g||!R(i),className:"bg-blue-500 hover:bg-blue-600",children:g?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creando perfil..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(f.A,{className:"h-4 w-4 mr-2"}),"\xa1Completar registro!"]})})]})]})]})})}var E=a(88145),S=a(41397),R=a(69663),I=a(37128),L=a(35742),P=a(34835);let M=(0,h.A)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);var z=a(37108),Z=a(55868),$=a(16785);let B=(0,h.A)("route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);var O=a(92138),W=a(38564),q=a(46561),U=a(14186),F=a(4516),H=a(69074),V=a(33109),G=a(17580);let _=(0,h.A)("fuel",[["line",{x1:"3",x2:"15",y1:"22",y2:"22",key:"xegly4"}],["line",{x1:"4",x2:"14",y1:"9",y2:"9",key:"xcnuvu"}],["path",{d:"M14 22V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v18",key:"16j0yd"}],["path",{d:"M14 13h2a2 2 0 0 1 2 2v2a2 2 0 0 0 2 2a2 2 0 0 0 2-2V9.83a2 2 0 0 0-.59-1.42L18 5",key:"7cu91f"}]]);var J=a(69037);let K=(0,h.A)("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var Q=a(79397),Y=a(53904),X=a(381);let ee=(0,h.A)("map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);var es=a(33786),ea=a(1243),et=a(71007),er=a(95747),ei=a(53999),el=a(99840),en=a(76037),ec=a(19420),ed=a(81284);let eo=e=>{var s,a,r,i,l,n,c,o;let{isOpen:m,onClose:x,order:u,cooksMap:h,dishesMap:g,onAcceptOrder:p,onUpdateOrderStatus:j,isDriverOnline:v,isOrderAssignedToDriver:f}=e;if(!u)return null;let N=h.get(u.cookerId),y=u.deliveryInfo.phone,b=!f&&v&&["pending","accepted"].includes(u.status),w=f&&["ready","delivering"].includes(u.status);return(0,t.jsx)(el.lG,{open:m,onOpenChange:x,children:(0,t.jsxs)(el.Cf,{className:"sm:max-w-[425px] md:max-w-[600px] lg:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)(el.c7,{children:[(0,t.jsxs)(el.L3,{className:"text-2xl font-bold text-orange-600",children:["Detalles del Pedido #",u.id.substring(0,8)]}),(0,t.jsx)(el.rr,{children:"Informaci\xf3n detallada sobre el pedido y acciones disponibles."})]}),(0,t.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[(0,t.jsx)("span",{className:"text-lg font-semibold",children:"Estado:"}),(0,t.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat((e=>{switch(e){case"pending":return"text-blue-600 bg-blue-100";case"accepted":return"text-yellow-600 bg-yellow-100";case"preparing":return"text-orange-600 bg-orange-100";case"ready":return"text-purple-600 bg-purple-100";case"delivering":return"text-indigo-600 bg-indigo-100";case"delivered":return"text-green-600 bg-green-100";case"cancelled":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}})(u.status)),children:(e=>{switch(e){case"pending":return"Pendiente";case"accepted":return"Aceptado";case"preparing":return"Preparando";case"ready":return"Listo para recoger";case"delivering":return"En camino";case"delivered":return"Entregado";case"cancelled":return"Cancelado";default:return"Desconocido"}})(u.status)})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(F.A,{className:"text-gray-500"}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"font-semibold",children:["Cliente: ",u.customerName]}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:u.deliveryInfo.address})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(ec.A,{className:"text-gray-500"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:u.deliveryInfo.phone}),(0,t.jsx)(d.$,{variant:"outline",size:"sm",onClick:()=>{y&&window.open("tel:".concat(y))},children:"Llamar Cliente"})]}),u.deliveryInfo.instructions&&(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)(ed.A,{className:"text-gray-500 mt-1"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold",children:"Instrucciones de Entrega:"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:u.deliveryInfo.instructions})]})]}),(0,t.jsx)(en.w,{}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(er.A,{className:"text-gray-500"}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:"font-semibold",children:["Cocinero: ",(null==N?void 0:N.displayName)||"Desconocido"]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["Direcci\xf3n de Recogida: ",(null==N||null==(a=N.location)||null==(s=a.address)?void 0:s.fullAddress)||"No disponible"]})]})]}),(0,t.jsx)(en.w,{}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Platos:"}),(0,t.jsx)("div",{className:"space-y-2",children:u.dishes.map((e,s)=>{let a=g.get(e.dishId);return(0,t.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-700",children:[(0,t.jsxs)("span",{children:[e.quantity,"x ",(null==a?void 0:a.name)||e.dishName]}),(0,t.jsxs)("span",{children:["$",(e.quantity*e.price).toLocaleString("es-CL")]})]},s)})})]}),(0,t.jsx)(en.w,{}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm text-gray-700",children:[(0,t.jsx)("span",{children:"Subtotal:"}),(0,t.jsxs)("span",{children:["$",u.subtotal.toLocaleString("es-CL")]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm text-gray-700",children:[(0,t.jsx)("span",{children:"Costo de Env\xedo:"}),(0,t.jsxs)("span",{children:["$",u.deliveryFee.toLocaleString("es-CL")]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm text-gray-700",children:[(0,t.jsx)("span",{children:"Tarifa de Servicio:"}),(0,t.jsxs)("span",{children:["$",u.serviceFee.toLocaleString("es-CL")]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-lg font-bold text-orange-700 mt-2",children:[(0,t.jsx)("span",{children:"Total:"}),(0,t.jsxs)("span",{children:["$",u.total.toLocaleString("es-CL")]})]})]}),(0,t.jsx)(en.w,{}),(0,t.jsxs)("div",{className:"space-y-1 text-sm text-gray-600",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(U.A,{className:"h-4 w-4"}),(0,t.jsxs)("span",{children:["Pedido Realizado: ",(null==(i=u.orderTime)||null==(r=i.toDate())?void 0:r.toLocaleString("es-CL"))||"N/A"]})]}),u.estimatedDeliveryTime&&(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(U.A,{className:"h-4 w-4"}),(0,t.jsxs)("span",{children:["Estimado de Entrega: ",(null==(n=u.estimatedDeliveryTime)||null==(l=n.toDate())?void 0:l.toLocaleString("es-CL"))||"N/A"]})]}),u.actualDeliveryTime&&(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(U.A,{className:"h-4 w-4"}),(0,t.jsxs)("span",{children:["Entregado: ",(null==(o=u.actualDeliveryTime)||null==(c=o.toDate())?void 0:c.toLocaleString("es-CL"))||"N/A"]})]})]})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2 mt-4",children:[b&&(0,t.jsx)(d.$,{onClick:()=>p&&p(u.id),className:"w-full bg-green-500 hover:bg-green-600",children:"Aceptar Pedido"}),w&&(0,t.jsx)(d.$,{onClick:()=>{if(!j)return;let e=null;switch(u.status){case"ready":e="delivering";break;case"delivering":e="delivered"}e&&j(u.id,e)},className:"w-full",children:(()=>{switch(u.status){case"ready":return"Marcar como Recogido (En camino)";case"delivering":return"Marcar como Entregado";default:return null}})()}),(0,t.jsx)(d.$,{variant:"outline",onClick:x,className:"w-full",children:"Cerrar"})]})]})})};var em=a(85339);let ex=e=>{let{onOrderAccepted:s,hasActiveDelivery:a=!1,isDriverOnline:i=!1}=e,{user:o}=(0,l.A)(),[m,u]=(0,r.useState)([]),[h,g]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(!o)return;let e=n.OrdersService.subscribeToAvailableOrders(e=>{u(e.filter(e=>!e.driverId))});return()=>e()},[o]);let p=async e=>{if(o){g(e);try{await n.OrdersService.assignOrderToDriver(e,o.uid)?(c.oR.success("Pedido aceptado exitosamente"),null==s||s(e)):c.oR.error("Error al aceptar el pedido")}catch(e){console.error("Error accepting order:",e),c.oR.error("Error al aceptar el pedido")}finally{g(null)}}};return i?a?(0,t.jsx)(x.Zp,{children:(0,t.jsxs)(x.Wu,{className:"p-8 text-center",children:[(0,t.jsx)(L.A,{className:"h-16 w-16 text-orange-500 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Entrega en progreso"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Completa tu entrega actual antes de aceptar nuevos pedidos"})]})}):0===m.length?(0,t.jsx)(x.Zp,{children:(0,t.jsxs)(x.Wu,{className:"p-8 text-center",children:[(0,t.jsx)(z.A,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No hay entregas disponibles"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Los nuevos pedidos aparecer\xe1n aqu\xed autom\xe1ticamente"})]})}):(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold",children:"Entregas Disponibles"}),(0,t.jsxs)(E.E,{variant:"outline",className:"bg-blue-50 text-blue-700",children:[m.length," disponibles"]})]}),m.map(e=>{var s,r,l;let{progress:n,timeRemaining:c,totalPrepTime:o}=(e=>{var s;if(!e.createdAt)return{progress:0,timeRemaining:"Calculando...",totalPrepTime:30};let a=e.dishes.map(e=>({prepTime:e.prepTime||"30 min",quantity:e.quantity})),t=(0,ei.Dm)(a),r=(null==(s=e.createdAt)?void 0:s.toDate())||new Date;return{progress:(0,ei.uA)(r,t),timeRemaining:(0,ei.$B)(r,t),totalPrepTime:t}})(e),m=n>=100||"ready"===e.status;return(0,t.jsxs)(x.Zp,{className:"transition-all duration-200 ".concat(m?"ring-2 ring-green-200 bg-green-50":""),children:[(0,t.jsx)(x.aR,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(x.ZB,{className:"text-lg",children:["Pedido #",e.id.slice(-8)]}),(0,t.jsxs)(x.BT,{className:"flex items-center gap-2 mt-1",children:[(0,t.jsx)(et.A,{className:"h-4 w-4"}),e.customerName,(0,t.jsx)("span",{className:"text-muted-foreground",children:"•"}),null==(s=e.createdAt)?void 0:s.toDate().toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)(E.E,{className:(e=>{switch(e){case"accepted":return"bg-green-100 text-green-800";case"preparing":return"bg-blue-100 text-blue-800";case"ready":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}})(e.status),children:(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(e=>{switch(e){case"accepted":return(0,t.jsx)(f.A,{className:"h-4 w-4"});case"preparing":return(0,t.jsx)(er.A,{className:"h-4 w-4"});case"ready":return(0,t.jsx)(z.A,{className:"h-4 w-4"});default:return(0,t.jsx)(U.A,{className:"h-4 w-4"})}})(e.status),(e=>{switch(e){case"accepted":return"Aceptado";case"preparing":return"Preparando";case"ready":return"Listo para entrega";default:return e}})(e.status)]})}),(0,t.jsx)("div",{className:"text-lg font-bold mt-1",children:(0,ei.$g)(e.total)})]})]})}),(0,t.jsxs)(x.Wu,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"bg-white p-4 rounded-lg border",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(q.A,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Progreso de preparaci\xf3n"})]}),(0,t.jsx)("span",{className:"text-sm font-mono font-bold",children:m?"\uD83D\uDFE2 LISTO":c})]}),(0,t.jsx)(S.k,{value:n,className:"h-2"}),(0,t.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground mt-1",children:[(0,t.jsxs)("span",{children:["Iniciado: ",null==(r=e.createdAt)?void 0:r.toDate().toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"})]}),(0,t.jsxs)("span",{children:["Estimado: ",(0,ei.bC)((null==(l=e.createdAt)?void 0:l.toDate())||new Date,o).toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{className:"font-medium mb-2 flex items-center gap-2",children:[(0,t.jsx)(er.A,{className:"h-4 w-4"}),"Platos (",e.dishes.length,")"]}),(0,t.jsx)("div",{className:"bg-muted p-3 rounded-lg space-y-1",children:e.dishes.map((e,s)=>(0,t.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,t.jsxs)("span",{children:[e.dishName," x ",e.quantity]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:e.prepTime||"30 min"}),(0,t.jsx)("span",{className:"font-medium",children:(0,ei.$g)(e.price*e.quantity)})]})]},s))})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)(F.A,{className:"h-4 w-4 text-muted-foreground mt-1"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm font-medium block",children:"Direcci\xf3n:"}),(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:e.deliveryInfo.address})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(ec.A,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm font-medium block",children:"Tel\xe9fono:"}),(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:e.deliveryInfo.phone})]})]})]}),e.deliveryInfo.instructions&&(0,t.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 p-3 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)(em.A,{className:"h-4 w-4 text-yellow-600 mt-0.5"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm font-medium text-yellow-800",children:"Instrucciones especiales:"}),(0,t.jsx)("p",{className:"text-sm text-yellow-700 mt-1",children:e.deliveryInfo.instructions})]})]})}),(0,t.jsx)(d.$,{onClick:()=>p(e.id),disabled:h===e.id||a||!i,className:"w-full ".concat(m?"bg-green-600 hover:bg-green-700":"bg-blue-600 hover:bg-blue-700"),size:"lg",children:h===e.id?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Aceptando..."]}):a?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(em.A,{className:"h-5 w-5 mr-2"}),"Entrega en progreso"]}):i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(L.A,{className:"h-5 w-5 mr-2"}),m?"Recoger Pedido":"Aceptar Entrega"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(em.A,{className:"h-5 w-5 mr-2"}),"Act\xedvate en l\xednea"]})})]})]},e.id)})]}):(0,t.jsx)(x.Zp,{children:(0,t.jsxs)(x.Wu,{className:"p-8 text-center",children:[(0,t.jsx)(z.A,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Est\xe1s fuera de l\xednea"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Activa tu estado en l\xednea para ver pedidos disponibles"})]})})};var eu=a(35169),eh=a(50744),eg=a(51154);let ep=e=>{let{order:s,cook:a,currentStep:i,onLocationUpdate:l}=e,n=(0,r.useRef)(null),[c,o]=(0,r.useState)(null),[m,x]=(0,r.useState)(null),[u,h]=(0,r.useState)(null),[g,p]=(0,r.useState)(null),[j,v]=(0,r.useState)(null),[f,N]=(0,r.useState)(null),[y,b]=(0,r.useState)(!0),[w,A]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{try{if(window.google||await k(),n.current){let e=new google.maps.Map(n.current,{zoom:13,center:{lat:-33.4489,lng:-70.6693},mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1}),s=new google.maps.DirectionsService,a=new google.maps.DirectionsRenderer({suppressMarkers:!1,polylineOptions:{strokeColor:"#FF6600",strokeWeight:4}});a.setMap(e),o(e),x(s),h(a)}}catch(e){console.error("Error initializing map:",e),A("Error al cargar el mapa")}finally{b(!1)}})()},[]),(0,r.useEffect)(()=>{let e=async()=>{try{var e,t,r,i;let l=await C();if(p(l),null==a||null==(e=a.location)?void 0:e.coordinates){let e={lat:a.location.coordinates.latitude,lng:a.location.coordinates.longitude,address:(null==(t=a.location.address)?void 0:t.fullAddress)||"Ubicaci\xf3n del cocinero"};v(e)}else{let e=await D((null==a||null==(i=a.location)||null==(r=i.address)?void 0:r.fullAddress)||"Santiago, Chile");v(e)}let n=await D(s.deliveryInfo.address);N(n)}catch(e){console.error("Error loading locations:",e),p({lat:-33.4489,lng:-70.6693,address:"Santiago Centro"}),v({lat:-33.4489,lng:-70.6693,address:(null==a?void 0:a.displayName)||"Cocinero"}),N({lat:-33.4489,lng:-70.6693,address:s.deliveryInfo.address})}};c&&a&&e()},[c,a,s]),(0,r.useEffect)(()=>{c&&m&&u&&g&&j&&f&&T()},[c,m,u,g,j,f,i]);let k=()=>new Promise((e,s)=>{if(window.google)return void e();let a=document.createElement("script");a.src="https://maps.googleapis.com/maps/api/js?key=".concat("AIzaSyCIni3lox4wQG0lX9Sy9zv3Q_iMjV5AvTs","&libraries=geometry"),a.async=!0,a.defer=!0,a.onload=()=>e(),a.onerror=()=>s(Error("Failed to load Google Maps API")),document.head.appendChild(a)}),C=()=>new Promise((e,s)=>{if(!navigator.geolocation)return void s(Error("Geolocation not supported"));navigator.geolocation.getCurrentPosition(s=>{e({lat:s.coords.latitude,lng:s.coords.longitude,address:"Tu ubicaci\xf3n actual"})},s=>{console.warn("Geolocation error:",s),e({lat:-33.4489,lng:-70.6693,address:"Santiago Centro (ubicaci\xf3n aproximada)"})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})}),D=async e=>{if(!window.google)throw Error("Google Maps not loaded");let s=new google.maps.Geocoder;return new Promise((a,t)=>{s.geocode({address:"".concat(e,", Santiago, Chile")},(s,t)=>{if("OK"===t&&s&&s[0]){let e=s[0].geometry.location;a({lat:e.lat(),lng:e.lng(),address:s[0].formatted_address})}else console.warn("Geocoding failed for:",e),a({lat:-33.4489,lng:-70.6693,address:e})})})},T=()=>{let e,s;if(!m||!u||!g||!j||!f)return;let a=[];0===i||1===i?(e=g,s=j):2===i?(e=j,s=f):(e=g,s=f,a=[{location:{lat:j.lat,lng:j.lng},stopover:!0}]);let t={origin:{lat:e.lat,lng:e.lng},destination:{lat:s.lat,lng:s.lng},waypoints:a,travelMode:google.maps.TravelMode.DRIVING,unitSystem:google.maps.UnitSystem.METRIC,avoidHighways:!1,avoidTolls:!1};m.route(t,(e,s)=>{if("OK"===s&&e){u.setDirections(e);let s=e.routes[0];if(s&&s.legs.length>0){let e=0,t="",r="";s.legs.forEach((s,i)=>{var l,n,c,d;e+=(null==(l=s.duration)?void 0:l.value)||0,0===i&&(t=(null==(n=s.duration)?void 0:n.text)||""),0===a.length?r=(null==(c=s.duration)?void 0:c.text)||"":1===i&&(r=(null==(d=s.duration)?void 0:d.text)||"")});let i=Math.ceil(e/60);null==l||l({pickup:t,delivery:r,total:"".concat(i," min")})}E()}else console.error("Directions request failed:",s),A("Error al calcular la ruta")})},E=()=>{c&&g&&j&&f&&new google.maps.Marker({position:{lat:g.lat,lng:g.lng},map:c,title:"Tu ubicaci\xf3n",icon:{path:google.maps.SymbolPath.CIRCLE,scale:8,fillColor:"#4285F4",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:2}})},S=()=>{let e;if(!j&&!f)return;e=0===i||1===i?j:f;let s="https://www.google.com/maps/dir/?api=1&destination=".concat(e.lat,",").concat(e.lng,"&travelmode=driving");window.open(s,"_blank")};return y?(0,t.jsx)("div",{className:"h-full flex items-center justify-center bg-muted/20",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(eg.A,{className:"h-8 w-8 animate-spin text-primary mx-auto mb-2"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Cargando mapa..."})]})}):w?(0,t.jsx)("div",{className:"h-full flex items-center justify-center bg-muted/20",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(F.A,{className:"h-8 w-8 text-muted-foreground mx-auto mb-2"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:w}),(0,t.jsxs)(d.$,{variant:"outline",onClick:S,children:[(0,t.jsx)(L.A,{className:"h-4 w-4 mr-2"}),"Abrir en Google Maps"]})]})}):(0,t.jsxs)("div",{className:"h-full relative",children:[(0,t.jsx)("div",{ref:n,className:"h-full w-full"}),(0,t.jsx)("div",{className:"absolute bottom-4 right-4",children:(0,t.jsxs)(d.$,{onClick:S,size:"sm",className:"shadow-lg",children:[(0,t.jsx)(L.A,{className:"h-4 w-4 mr-2"}),"Navegar"]})}),(0,t.jsx)("div",{className:"absolute top-4 left-4 right-4",children:(0,t.jsx)("div",{className:"bg-white/95 backdrop-blur-sm rounded-lg p-3 shadow-lg",children:(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsx)("div",{className:"font-medium text-primary mb-1",children:0===i||1===i?"Dirigi\xe9ndote a:":"Entregando en:"}),(0,t.jsx)("div",{className:"text-muted-foreground",children:0===i||1===i?(null==j?void 0:j.address)||"Cargando...":(null==f?void 0:f.address)||"Cargando..."})]})})})]})};var ej=a(44597);let ev=e=>{var s;let{activeOrder:a,onBackToDashboard:i}=e,{user:o}=(0,l.A)(),[m,u]=(0,r.useState)(a),[h,g]=(0,r.useState)(null),[p,j]=(0,r.useState)(null),[v,N]=(0,r.useState)(!1),[y,b]=(0,r.useState)(0),[w,A]=(0,r.useState)({pickup:"15 min",delivery:"25 min",total:"40 min"}),[k,C]=(0,r.useState)(null),D=()=>{var e,s,a,t,r,i;let l=h?{address:(null==(s=h.location)||null==(e=s.address)?void 0:e.fullAddress)||"Ubicaci\xf3n del cocinero",lat:null==(t=h.location)||null==(a=t.coordinates)?void 0:a.latitude,lng:null==(i=h.location)||null==(r=i.coordinates)?void 0:r.longitude}:{address:"Cargando ubicaci\xf3n del cocinero..."},n={address:m.deliveryInfo.address,lat:void 0,lng:void 0};return[{id:"accepted",title:"Pedido Aceptado",status:"accepted"===m.status?"current":"completed",action:"Dirigirse al cocinero",nextStatus:"preparing"},{id:"pickup",title:"Recoger Pedido",status:"preparing"===m.status?"current":["accepted"].includes(m.status)?"pending":"completed",location:l,action:"Confirmar recogida",nextStatus:"delivering"},{id:"delivery",title:"Entregar al Cliente",status:"delivering"===m.status?"current":["accepted","preparing"].includes(m.status)?"pending":"completed",location:n,action:"Confirmar entrega",nextStatus:"delivered"},{id:"completed",title:"Entrega Completada",status:"delivered"===m.status?"completed":"pending"}]};(0,r.useEffect)(()=>{S();let e=n.OrdersService.subscribeToOrderUpdates(m.cookerId,e=>{let s=e.find(e=>e.id===m.id);s&&u(s)});return o&&C(ej.DeliveryTrackingService.startLocationTracking(m.id,o.uid,o.displayName||o.email||"Conductor",e=>{let s=T();ej.DeliveryTrackingService.updateDeliveryTracking({orderId:m.id,driverId:o.uid,driverName:o.displayName||o.email||"Conductor",currentLocation:{lat:e.lat,lng:e.lng,timestamp:new Date},estimatedPickupTime:w.pickup,estimatedDeliveryTime:w.delivery,totalEstimatedTime:w.total,currentStep:s})})),()=>{e(),null==k||k.stop()}},[m.id,m.cookerId]),(0,r.useEffect)(()=>{let e=D(),s=e.findIndex(e=>"current"===e.status);b(s>=0?s:e.length-1),o&&ej.DeliveryTrackingService.updateDeliveryStep(m.id,T())},[m.status]);let T=()=>{switch(m.status){case"accepted":default:return"heading_to_pickup";case"preparing":return"at_pickup";case"delivering":return"heading_to_delivery";case"delivered":return"delivered"}},S=async()=>{try{var e;let[s,a]=await Promise.all([n.CooksService.getCookById(m.cookerId),n.DishesService.getDishById((null==(e=m.dishes[0])?void 0:e.dishId)||"")]);g(s),j(a)}catch(e){console.error("Error loading order details:",e)}},I=async e=>{if(o){N(!0);try{await n.OrdersService.updateOrderStatus(m.id,e)?(u(s=>({...s,status:e})),c.oR.success({preparing:"Te diriges al cocinero",delivering:"Pedido recogido, dirigi\xe9ndote al cliente",delivered:"Entrega completada exitosamente"}[e]||"Estado actualizado"),"delivered"===e&&setTimeout(()=>{i()},2e3)):c.oR.error("Error al actualizar el estado del pedido")}catch(e){console.error("Error updating order status:",e),c.oR.error("Error al actualizar el estado del pedido")}finally{N(!1)}}},P=D(),M=P[y],Z="delivered"===m.status;return(0,t.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,t.jsx)("div",{className:"bg-primary text-primary-foreground shadow-sm",children:(0,t.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)(d.$,{variant:"ghost",size:"sm",onClick:i,className:"text-primary-foreground hover:bg-primary/20",children:[(0,t.jsx)(eu.A,{className:"h-4 w-4 mr-2"}),"Dashboard"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl font-bold",children:"Entrega Activa"}),(0,t.jsxs)("p",{className:"text-sm opacity-90",children:["Pedido #",m.id.slice(-8)]})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-lg font-bold",children:(0,ei.$g)(m.total)}),(0,t.jsxs)("div",{className:"text-sm opacity-90",children:["ETA: ",w.total]})]})]})})}),(0,t.jsx)("div",{className:"container mx-auto px-4 py-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(x.Zp,{className:"border-primary/20",children:[(0,t.jsx)(x.aR,{children:(0,t.jsxs)(x.ZB,{className:"flex items-center gap-2",children:[(null==M?void 0:M.status)==="current"&&(0,t.jsx)(q.A,{className:"h-5 w-5 text-primary"}),(null==M?void 0:M.status)==="completed"&&(0,t.jsx)(f.A,{className:"h-5 w-5 text-green-500"}),(null==M?void 0:M.title)||"Paso Actual"]})}),(0,t.jsxs)(x.Wu,{children:[(null==M?void 0:M.location)&&(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsxs)("div",{className:"flex items-start gap-2 mb-2",children:[(0,t.jsx)(F.A,{className:"h-4 w-4 text-muted-foreground mt-1"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:"Destino:"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:M.location.address})]})]})}),(null==M?void 0:M.action)&&M.nextStatus&&!Z&&(0,t.jsx)(d.$,{onClick:()=>I(M.nextStatus),disabled:v,className:"w-full",size:"lg",children:v?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Actualizando..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(L.A,{className:"h-4 w-4 mr-2"}),M.action]})}),Z&&(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(f.A,{className:"h-12 w-12 text-green-500 mx-auto mb-2"}),(0,t.jsx)("p",{className:"text-green-600 font-medium",children:"\xa1Entrega Completada!"})]})]})]}),(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsx)(x.ZB,{children:"Progreso de Entrega"})}),(0,t.jsx)(x.Wu,{children:(0,t.jsx)("div",{className:"space-y-4",children:P.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium ".concat("completed"===e.status?"bg-green-500 text-white":"current"===e.status?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"),children:"completed"===e.status?(0,t.jsx)(f.A,{className:"h-3 w-3"}):s+1}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"font-medium ".concat("current"===e.status?"text-primary":""),children:e.title}),e.location&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:e.location.address})]}),"current"===e.status&&(0,t.jsx)(E.E,{variant:"default",children:"Actual"})]},e.id))})})]}),(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsx)(x.ZB,{children:"Detalles del Pedido"})}),(0,t.jsxs)(x.Wu,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(z.A,{className:"h-5 w-5 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:(null==p?void 0:p.name)||"Cargando..."}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Cantidad: ",(null==(s=m.dishes[0])?void 0:s.quantity)||1]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)(R.eu,{className:"h-8 w-8",children:[(0,t.jsx)(R.BK,{src:null==h?void 0:h.avatar}),(0,t.jsx)(R.q5,{children:(0,t.jsx)(eh.A,{className:"h-4 w-4"})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:(null==h?void 0:h.displayName)||"Cargando..."}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Cocinero"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(et.A,{className:"h-5 w-5 text-muted-foreground"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:m.customerName}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,t.jsx)(ec.A,{className:"h-3 w-3"}),m.deliveryInfo.phone]})]})]}),m.deliveryInfo.instructions&&(0,t.jsxs)("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-yellow-800 mb-1",children:"Instrucciones especiales:"}),(0,t.jsx)("p",{className:"text-sm text-yellow-700",children:m.deliveryInfo.instructions})]})]})]})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(x.Zp,{className:"h-[600px]",children:[(0,t.jsx)(x.aR,{children:(0,t.jsxs)(x.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(B,{className:"h-5 w-5"}),(null==M?void 0:M.location)?"Navegaci\xf3n":"Ubicaci\xf3n"]})}),(0,t.jsx)(x.Wu,{className:"h-full p-0",children:(0,t.jsx)(ep,{order:m,cook:h,currentStep:y,onLocationUpdate:e=>{A(s=>({...s,...e})),o&&ej.DeliveryTrackingService.updateETA(m.id,e)}})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)(d.$,{variant:"outline",className:"h-12",children:[(0,t.jsx)(ec.A,{className:"h-4 w-4 mr-2"}),"Llamar Cliente"]}),(0,t.jsxs)(d.$,{variant:"outline",className:"h-12",children:[(0,t.jsx)(ec.A,{className:"h-4 w-4 mr-2"}),"Llamar Cocinero"]})]})]})]})})]})};var ef=a(81497);function eN(e){var s;let{order:a,cook:i,onStatusUpdate:l,onStartNavigation:n,onCallCustomer:o}=e,[m,u]=(0,r.useState)(0),[h,g]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(a.createdAt){let e=a.createdAt.toDate(),s=a.dishes.reduce((e,s)=>Math.max(e,"string"==typeof s.prepTime?parseInt(s.prepTime.replace(/\D/g,"")):s.prepTime||30),30);g(new Date(e.getTime()+60*s*1e3))}},[a]);let p=[{id:"accepted",title:"Pedido Aceptado",description:"Has aceptado este pedido. El cocinero ser\xe1 notificado y confirmar\xe1 la preparaci\xf3n.",status:"accepted"===a.status?"active":["preparing","ready","delivering","delivered"].includes(a.status)?"completed":"pending",estimatedTime:"1-2 min",icon:f.A,action:"accepted"===a.status?"Esperando confirmaci\xf3n...":void 0},{id:"preparing",title:"Preparaci\xf3n en Curso",description:"El cocinero est\xe1 preparando el pedido. Puedes monitorear el progreso.",status:"preparing"===a.status?"active":["ready","delivering","delivered"].includes(a.status)?"completed":"pending",estimatedTime:a.dishes.reduce((e,s)=>Math.max(e,"string"==typeof s.prepTime?parseInt(s.prepTime.replace(/\D/g,"")):s.prepTime||30),30)+" min",icon:er.A,action:"preparing"===a.status?"Listo aprox: ".concat(null==h?void 0:h.toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"})):void 0},{id:"ready",title:"Listo para Recoger",description:"El pedido est\xe1 listo. Ve al restaurante para recogerlo.",status:"ready"===a.status?"active":["delivering","delivered"].includes(a.status)?"completed":"pending",estimatedTime:"5-10 min",icon:z.A,action:"ready"===a.status?"Recoger Pedido":void 0,actionHandler:"ready"===a.status?()=>{l(a.id,"delivering"),c.oR.success("\xa1Pedido recogido! Ahora dir\xedgete al cliente.")}:void 0},{id:"delivering",title:"En Camino al Cliente",description:"Dir\xedgete a la direcci\xf3n del cliente para entregar el pedido.",status:"delivering"===a.status?"active":"delivered"===a.status?"completed":"pending",estimatedTime:"10-20 min",icon:j,action:"delivering"===a.status?"Navegar al Cliente":void 0,actionHandler:"delivering"===a.status?()=>{n(a.deliveryInfo.address)}:void 0},{id:"delivered",title:"Entrega Completada",description:"Confirma la entrega una vez que hayas entregado el pedido al cliente.",status:"delivered"===a.status?"completed":"pending",icon:f.A,action:"delivering"===a.status?"Confirmar Entrega":void 0,actionHandler:"delivering"===a.status?()=>{l(a.id,"delivered"),c.oR.success("\xa1Entrega completada! Ganancia agregada a tu cuenta.")}:void 0}],v=p.findIndex(e=>"active"===e.status),N=p.filter(e=>"completed"===e.status).length/p.length*100,{progress:y,timeRemaining:b}=(()=>{if("preparing"!==a.status||!a.createdAt||!h)return{progress:0,timeRemaining:""};let e=new Date,s=a.createdAt.toDate(),t=h.getTime()-s.getTime(),r=Math.min((e.getTime()-s.getTime())/t*100,100),i=Math.ceil(Math.max(0,h.getTime()-e.getTime())/6e4);return{progress:r,timeRemaining:i>0?"".concat(i," min restantes"):"Listo!"}})();return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(x.Zp,{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200",children:(0,t.jsx)(x.aR,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center",children:(0,t.jsx)(z.A,{className:"h-6 w-6 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(x.ZB,{className:"text-xl text-blue-900",children:["Pedido #",a.id.slice(-8)]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-blue-700",children:[(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)(er.A,{className:"h-4 w-4 mr-1"}),(null==i?void 0:i.displayName)||"Cocinero"]}),(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)(et.A,{className:"h-4 w-4 mr-1"}),a.customerName]}),(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)(U.A,{className:"h-4 w-4 mr-1"}),null==(s=a.createdAt)?void 0:s.toDate().toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"})]})]})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-blue-900",children:(0,ei.$g)(a.total)}),(0,t.jsxs)("div",{className:"text-sm text-blue-700",children:["Ganancia: ",(0,ei.$g)(a.deliveryFee||2500)]})]})]})})}),(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsxs)(x.ZB,{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{children:"Progreso de la Entrega"}),(0,t.jsxs)(E.E,{variant:"outline",className:"text-blue-600 border-blue-300",children:["Paso ",v+1," de ",p.length]})]})}),(0,t.jsxs)(x.Wu,{children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[(0,t.jsx)("span",{children:"Progreso General"}),(0,t.jsxs)("span",{children:[Math.round(N),"% completado"]})]}),(0,t.jsx)(S.k,{value:N,className:"h-3"})]}),"preparing"===a.status&&(0,t.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(q.A,{className:"h-4 w-4 text-orange-600 mr-2"}),(0,t.jsx)("span",{className:"font-medium text-orange-900",children:"Preparaci\xf3n en curso"})]}),(0,t.jsx)("span",{className:"text-sm font-bold text-orange-700",children:b})]}),(0,t.jsx)(S.k,{value:y,className:"h-2 mb-2"}),(0,t.jsx)("p",{className:"text-xs text-orange-700",children:"El cocinero est\xe1 preparando tu pedido. Te notificaremos cuando est\xe9 listo."})]})]})]}),(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsx)(x.ZB,{children:"Pasos a Seguir"})}),(0,t.jsx)(x.Wu,{children:(0,t.jsx)("div",{className:"space-y-4",children:p.map((e,s)=>{let a=e.icon,r="active"===e.status,i="completed"===e.status;return(0,t.jsxs)("div",{className:"flex items-start space-x-4 p-4 rounded-lg border transition-all ".concat(r?"bg-blue-50 border-blue-200 ring-2 ring-blue-100":i?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200"),children:[(0,t.jsx)("div",{className:"flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ".concat(r?"bg-blue-600 text-white":i?"bg-green-600 text-white":"bg-gray-400 text-white"),children:i?(0,t.jsx)(f.A,{className:"h-5 w-5"}):(0,t.jsx)(a,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h4",{className:"font-semibold ".concat(r?"text-blue-900":i?"text-green-900":"text-gray-700"),children:e.title}),e.estimatedTime&&(0,t.jsx)("span",{className:"text-xs px-2 py-1 rounded-full ".concat(r?"bg-blue-100 text-blue-700":i?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"),children:e.estimatedTime})]}),(0,t.jsx)("p",{className:"text-sm mt-1 ".concat(r?"text-blue-800":i?"text-green-800":"text-gray-600"),children:e.description}),e.action&&r&&(0,t.jsx)("div",{className:"mt-3",children:e.actionHandler?(0,t.jsxs)(d.$,{onClick:e.actionHandler,className:"bg-blue-600 hover:bg-blue-700",size:"sm",children:[(0,t.jsx)(O.A,{className:"h-4 w-4 mr-2"}),e.action]}):(0,t.jsxs)("div",{className:"flex items-center text-blue-600",children:[(0,t.jsx)(q.A,{className:"h-4 w-4 mr-2 animate-pulse"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:e.action})]})})]})]},e.id)})})})]}),(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsx)(x.ZB,{children:"Acciones R\xe1pidas"})}),(0,t.jsx)(x.Wu,{children:(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[(0,t.jsxs)(d.$,{variant:"outline",onClick:()=>{var e,s;return n((null==i||null==(s=i.location)||null==(e=s.address)?void 0:e.fullAddress)||"Direcci\xf3n del cocinero")},className:"flex items-center justify-center",disabled:!["ready","delivering"].includes(a.status),children:[(0,t.jsx)(L.A,{className:"h-4 w-4 mr-2"}),"Navegar al Cocinero"]}),(0,t.jsxs)(d.$,{variant:"outline",onClick:()=>n(a.deliveryInfo.address),className:"flex items-center justify-center",disabled:"delivering"!==a.status,children:[(0,t.jsx)(F.A,{className:"h-4 w-4 mr-2"}),"Navegar al Cliente"]}),(0,t.jsxs)(d.$,{variant:"outline",onClick:()=>o(a.deliveryInfo.phone),className:"flex items-center justify-center",children:[(0,t.jsx)(ec.A,{className:"h-4 w-4 mr-2"}),"Llamar Cliente"]})]})})]}),(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsx)(x.ZB,{children:"Detalles del Pedido"})}),(0,t.jsx)(x.Wu,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Platos:"}),(0,t.jsx)("div",{className:"space-y-2",children:a.dishes.map((e,s)=>(0,t.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,t.jsxs)("span",{children:[e.dishName," x ",e.quantity]}),(0,t.jsx)("span",{className:"font-medium",children:(0,ei.$g)(e.price*e.quantity)})]},s))})]}),(0,t.jsxs)("div",{className:"border-t pt-4",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Informaci\xf3n de Entrega:"}),(0,t.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,t.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,t.jsx)(F.A,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),(0,t.jsx)("span",{children:a.deliveryInfo.address})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(ec.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:a.deliveryInfo.phone})]}),a.deliveryInfo.instructions&&(0,t.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,t.jsx)(ef.A,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),(0,t.jsxs)("span",{className:"italic",children:['"',a.deliveryInfo.instructions,'"']})]})]})]})]})})]})]})}var ey=a(66579);class eb{static startIdleTracking(e,s){this.stopIdleTracking(e);let a=null,t=!0,r=async()=>{if(t)try{let s=await this.getCurrentLocation(),a=Date.now(),t=this.lastUpdateTimes.get(e)||0;a-t>this.UPDATE_INTERVAL&&(await this.updateDriverIdleLocation(e,s),this.lastUpdateTimes.set(e,a))}catch(e){console.error("Error updating idle driver location:",e)}};navigator.geolocation&&(a=navigator.geolocation.watchPosition(()=>r(),e=>console.error("Idle geolocation error:",e),{enableHighAccuracy:!1,timeout:15e3,maximumAge:6e4})),r();let i=()=>{t=!1,null!==a&&navigator.geolocation.clearWatch(a),this.activeTracking.delete(e),this.lastUpdateTimes.delete(e)};return this.activeTracking.set(e,{watchId:a||0,stop:i}),{stop:i}}static stopIdleTracking(e){let s=this.activeTracking.get(e);s&&s.stop()}static async updateDriverIdleLocation(e,s,a){try{let t=(0,A.doc)(ey.db,"drivers",e);return await (0,A.mZ)(t,{"currentLocation.coordinates":{latitude:s.lat,longitude:s.lng,timestamp:A.Dc.now()},"currentLocation.lastUpdated":A.Dc.now(),lastLocationUpdate:A.Dc.now(),...(null==a?void 0:a.speed)&&{"currentLocation.speed":a.speed},...(null==a?void 0:a.heading)&&{"currentLocation.heading":a.heading}}),!0}catch(e){return console.error("Error updating idle driver location:",e),!1}}static getCurrentLocation(){return new Promise((e,s)=>{if(!navigator.geolocation)return void s(Error("Geolocation not supported"));navigator.geolocation.getCurrentPosition(s=>{e({lat:s.coords.latitude,lng:s.coords.longitude})},e=>s(e),{enableHighAccuracy:!1,timeout:15e3,maximumAge:6e4})})}static subscribeToDriverStatus(e,s){let a=(0,A.doc)(ey.db,"drivers",e);return(0,A.aQ)(a,a=>{if(a.exists()){let t=a.data(),r=t.isOnline||!1,i=t.isAvailable||!1;s(r,i),r&&i?this.startIdleTracking(e,t.displayName||"Driver"):this.stopIdleTracking(e)}},e=>{console.error("Error subscribing to driver status:",e)})}static getActiveTrackings(){return Array.from(this.activeTracking.keys())}static stopAllIdleTracking(){this.activeTracking.forEach(e=>{e.stop()}),this.activeTracking.clear(),this.lastUpdateTimes.clear()}}eb.activeTracking=new Map,eb.UPDATE_INTERVAL=3e4,eb.lastUpdateTimes=new Map;class ew{static async geocodeAddress(e){try{let s=this.hashAddress(e);return{lat:-33.4489+s%100*.001,lng:-70.6693+s%100*.001}}catch(e){return console.error("Error geocoding address:",e),null}}static hashAddress(e){let s=0;for(let a=0;a<e.length;a++)s=(s<<5)-s+e.charCodeAt(a),s&=s;return Math.abs(s)}static calculateDistance(e,s,a,t){let r=(a-e)*Math.PI/180,i=(t-s)*Math.PI/180,l=Math.sin(r/2)*Math.sin(r/2)+Math.cos(e*Math.PI/180)*Math.cos(a*Math.PI/180)*Math.sin(i/2)*Math.sin(i/2);return 2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))*6371}static optimizeRouteOrder(e,s,a,t){if(e.length<=1)return e;let r=[],i=[...e],l=s,n=a;for(t.prioritizeHighValue&&i.sort((e,s)=>{let a={high:3,medium:2,low:1},t=a[s.priority]-a[e.priority];return 0!==t?t:s.orderValue-e.orderValue});i.length>0;){let e=0,s=1/0;i.forEach((a,t)=>{if(!a.lat||!a.lng)return;let r=this.calculateDistance(l,n,a.lat,a.lng)*({high:.7,medium:1,low:1.3})[a.priority];r<s&&(s=r,e=t)});let a=i[e];r.push(a),i.splice(e,1),a.lat&&a.lng&&(l=a.lat,n=a.lng)}return r}static async convertOrdersToRoutePoints(e){let s=[];for(let a of e){let e=await this.geocodeAddress(a.deliveryInfo.address),t=this.calculateOrderPriority(a);s.push({id:"order-".concat(a.id),address:a.deliveryInfo.address,lat:null==e?void 0:e.lat,lng:null==e?void 0:e.lng,orderId:a.id,customerName:a.customerName,estimatedDeliveryTime:this.estimateDeliveryTime(a),priority:t,orderValue:a.total})}return s}static calculateOrderPriority(e){let s=(Date.now()-e.createdAt.toDate().getTime())/6e4;return e.total>25e3||s>45?"high":e.total>15e3||s>20?"medium":"low"}static estimateDeliveryTime(e){return 15+2*e.dishes.reduce((e,s)=>e+s.quantity,0)}static async optimizeRoute(e,s){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},t={...this.DEFAULT_OPTIONS,...a},r=await this.convertOrdersToRoutePoints(e),i=this.optimizeRouteOrder(r,s.lat,s.lng,t),{totalDistance:l,totalTime:n}=this.calculateRouteMetrics(i,s),c=l/t.fuelEfficiency*t.fuelPrice,d=this.calculateRouteEfficiency(i,l,n);return{points:i,totalDistance:Math.round(10*l)/10,totalTime:Math.round(n),estimatedFuelCost:Math.round(c),efficiency:Math.round(d)}}static calculateRouteMetrics(e,s){if(0===e.length)return{totalDistance:0,totalTime:0};let a=0,t=0,r=s.lat,i=s.lng;for(let s of e)if(s.lat&&s.lng){let e=this.calculateDistance(r,i,s.lat,s.lng);a+=e,t+=e/30*60+s.estimatedDeliveryTime,r=s.lat,i=s.lng}return{totalDistance:a,totalTime:t}}static calculateRouteEfficiency(e,s,a){if(0===e.length)return 100;let t=s/e.length,r=e.findIndex(e=>"high"===e.priority)/e.length,i=100;return t>5?i-=20:t>3&&(i-=10),r>.3&&(i-=15),a>120?i-=25:a>90&&(i-=15),Math.max(0,i)}static generateNavigationUrl(e){let s=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(0===e.length)return"";let a="current+location",t=encodeURIComponent(e[e.length-1].address),r="https://www.google.com/maps/dir/".concat(a,"/").concat(t);if(s&&e.length>2){let s=e.slice(0,-1).map(e=>encodeURIComponent(e.address)).join("/");r="https://www.google.com/maps/dir/".concat(a,"/").concat(s,"/").concat(t)}return r}static getEstimatedArrivalTimes(e){let s=new Map,a=new Date,t=0;for(let r of e.points){t+=15;let e=new Date(a.getTime()+6e4*t);s.set(r.orderId,e),t+=r.estimatedDeliveryTime}return s}}ew.DEFAULT_OPTIONS={prioritizeHighValue:!0,considerTraffic:!0,maxDeliveryTime:120,fuelEfficiency:12,fuelPrice:1200};var eA=a(6824);function ek(){let e,s=(0,i.useRouter)(),{user:a,logout:o}=(0,l.A)(),[m,u]=(0,r.useState)(!0),[h,g]=(0,r.useState)(null),[j,N]=(0,r.useState)([]),[y,b]=(0,r.useState)(!1),[w,A]=(0,r.useState)(!1),[k,C]=(0,r.useState)([]),[D,el]=(0,r.useState)("dashboard"),[en,ec]=(0,r.useState)("available"),[ed,em]=(0,r.useState)(null),[eu,eh]=(0,r.useState)(!1),[eg,ep]=(0,r.useState)({prioritizeHighValue:!0,considerTraffic:!0,maxDeliveryTime:120}),[ej,ef]=(0,r.useState)({totalEarnings:0,todayEarnings:0,weekEarnings:0,monthEarnings:0,totalDeliveries:0,todayDeliveries:0,weekDeliveries:0,monthDeliveries:0,averageRating:5,completionRate:100,totalDistance:"0 km",onlineTime:"0h 0m",averageDeliveryTime:25,customerSatisfactionRate:98,onTimeDeliveryRate:95,fuelEfficiency:"12.5 km/L"}),[ey,ek]=(0,r.useState)(!1),[eC,eD]=(0,r.useState)(!1),[eT,eE]=(0,r.useState)("Ubicaci\xf3n no disponible"),[eS,eR]=(0,r.useState)(new Map),[eI,eL]=(0,r.useState)(new Map),[eP,eM]=(0,r.useState)(!1),[ez,eZ]=(0,r.useState)(null),[e$,eB]=(0,r.useState)(null),[eO,eW]=(0,r.useState)(!1),[eq,eU]=(0,r.useState)(null),[eF,eH]=(0,r.useState)(null);(0,r.useEffect)(()=>{a&&eV()},[a]),(0,r.useEffect)(()=>()=>{eq&&eq.stop()},[eq]);let eV=(0,r.useCallback)(async()=>{if(a){u(!0);try{var e,s,t,r;let i=await n.DriversService.getDriverById(a.uid);if(!i){console.log("DriverDashboard: No driver profile found, showing onboarding"),b(!0),u(!1);return}if(!(i.displayName&&i.phone&&i.vehicleType&&(null==(e=i.workingDays)?void 0:e.length)>0)){console.log("DriverDashboard: Driver profile incomplete, showing onboarding. Missing:",{displayName:!i.displayName,phone:!i.phone,vehicleType:!i.vehicleType,workingDays:!(null==(r=i.workingDays)?void 0:r.length)}),b(!0),u(!1);return}if(console.log("DriverDashboard: Driver profile is complete, proceeding with dashboard"),g(i),A(!0),!i){let e={displayName:a.displayName||"Conductor",email:a.email||"",avatar:a.photoURL||"",phone:"",vehicleType:"motorcycle",vehicleInfo:{make:"",model:"",year:new Date().getFullYear(),licensePlate:"",color:""},isOnline:!1,isAvailable:!1,rating:5,reviewCount:0,totalDeliveries:0,completionRate:100,earnings:{today:0,thisWeek:0,thisMonth:0,total:0},workingHours:{start:"08:00",end:"22:00"},workingDays:["monday","tuesday","wednesday","thursday","friday","saturday","sunday"]};if(!await n.DriversService.createDriverProfile(e,a.uid))return void console.error("Failed to create driver profile");if(!(i=await n.DriversService.getDriverById(a.uid)))return void console.error("Failed to load created driver profile")}g(i),ek((null==i?void 0:i.isOnline)||!1),(null==i||null==(t=i.currentLocation)||null==(s=t.address)?void 0:s.city)&&eE(i.currentLocation.address.city),await e_(),await eJ()}catch(e){console.error("Error loading driver data:",e),c.oR.error("Error al cargar datos del conductor")}finally{u(!1)}}},[a]);(0,r.useEffect)(()=>{let e,s;return a&&(e=n.DriversService.subscribeToDriverOrders(a.uid,e=>{N(e),updateStats(e);let s=e.find(e=>e.driverId===a.uid&&["accepted","preparing","ready","delivering"].includes(e.status));if(s&&(!e$||s.id!==e$.id)?(eB(s),"accepted"!==s.status||e$&&s.id===e$.id||eW(!0)):!s&&e$&&(eB(null),eW(!1)),e$&&s&&s.id===e$.id&&s.status!==e$.status){let e={accepted:{title:"Pedido Aceptado",description:"El cocinero confirmar\xe1 la disponibilidad pronto",duration:3e3},preparing:{title:"\uD83C\uDF73 \xa1Preparaci\xf3n iniciada!",description:"El cocinero est\xe1 preparando tu pedido",duration:4e3},ready:{title:"\uD83D\uDCE6 \xa1Pedido listo para recoger!",description:"Ve al restaurante para recoger el pedido",duration:5e3},delivering:{title:"\uD83D\uDE97 En camino al cliente",description:"Dir\xedgete a la direcci\xf3n de entrega",duration:3e3},delivered:{title:"✅ \xa1Entrega completada!",description:"Ganancia agregada a tu cuenta",duration:4e3}}[s.status];e&&(c.oR.success(e.title,{description:e.description,duration:e.duration}),["preparing","ready","delivering"].includes(s.status)&&eW(!0))}}),s=n.OrdersService.subscribeToDriverAvailableOrders(e=>{let s=e.filter(e=>!e.driverId);C(s),s.length>k.length&&c.oR.info("\xa1".concat(s.length-k.length," nuevos pedidos disponibles!"))})),()=>{e&&e(),s&&s()}},[a,h,k,e$,updateStats]);let eG=(0,r.useCallback)(()=>{b(!1),(null==a?void 0:a.uid)&&eV()},[null==a?void 0:a.uid,eV]),e_=async()=>{if(!a)return},eJ=async()=>{try{let[e,s]=await Promise.all([n.CooksService.getAllCooks(),n.DishesService.getAllDishes()]),a=new Map(e.map(e=>[e.id,e])),t=new Map(s.map(e=>[e.id,e]));eR(a),eL(t)}catch(e){console.error("Error loading reference data:",e)}},eK=async()=>{if(a&&h){eD(!0);try{let e=!ey;if(await n.DriversService.updateDriverProfile(a.uid,{isOnline:e,isAvailable:e}))if(ek(e),g(s=>s?{...s,isOnline:e,isAvailable:e}:null),e){let e=eb.startIdleTracking(a.uid,(null==h?void 0:h.displayName)||a.displayName||"Conductor");eU(e),c.oR.success("\xa1Est\xe1s en l\xednea! Los pedidos comenzar\xe1n a aparecer.")}else eq&&(eq.stop(),eU(null)),c.oR.success("Ahora est\xe1s fuera de l\xednea");else c.oR.error("Error al actualizar el estado")}catch(e){console.error("Error toggling online status:",e),c.oR.error("Error al cambiar el estado")}finally{eD(!1)}}},eQ=async(e,s)=>{try{let t={status:s};if("delivered"===s&&(t.actualDeliveryTime=new Date,t.isDelivered=!0),await n.OrdersService.updateOrder(e,t)){if(c.oR.success("Estado del pedido actualizado a ".concat(e2(s))),"delivered"===s&&(c.oR.success("\xa1Entrega completada! Las ganancias se han actualizado.",{duration:4e3}),ey&&a&&h&&!eq)){let e=eb.startIdleTracking(a.uid,h.displayName||a.displayName||"Conductor");eU(e)}}else c.oR.error("Error al actualizar el estado del pedido")}catch(e){console.error("Error updating order status:",e),c.oR.error("Error al actualizar el estado del pedido")}},eY=async e=>{if(a)try{await n.OrdersService.assignOrderToDriver(e,a.uid)?(eq&&(eq.stop(),eU(null)),eW(!0),el("dashboard"),c.oR.success("\xa1Pedido aceptado!",{description:"Sigue la gu\xeda paso a paso para completar la entrega.",duration:4e3})):c.oR.error("Error al aceptar el pedido ".concat(e))}catch(e){console.error("Error accepting order:",e),c.oR.error("Error al aceptar el pedido")}},eX=async e=>{if(a)try{if(!navigator.geolocation)return void c.oR.error("Geolocalizaci\xf3n no disponible");c.oR.info("Obteniendo ubicaci\xf3n..."),navigator.geolocation.getCurrentPosition(async s=>{let{latitude:a,longitude:t}=s.coords;await n.OrdersService.startDeliveryTracking(e,{latitude:a,longitude:t,accuracy:s.coords.accuracy,heading:s.coords.heading||void 0,speed:s.coords.speed||void 0})?(c.oR.success("\xa1Viaje iniciado! El cliente puede seguir tu ubicaci\xf3n."),e0(e)):c.oR.error("Error al iniciar el seguimiento")},e=>{console.error("Geolocation error:",e),c.oR.error("No se pudo obtener la ubicaci\xf3n. Verifica los permisos.")},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})}catch(e){console.error("Error starting delivery tracking:",e),c.oR.error("Error al iniciar el viaje")}},e0=e=>{eF&&navigator.geolocation.clearWatch(eF),eH(navigator.geolocation.watchPosition(async s=>{let{latitude:a,longitude:t}=s.coords;try{await n.OrdersService.updateDriverLocation(e,{latitude:a,longitude:t,accuracy:s.coords.accuracy,heading:s.coords.heading||void 0,speed:s.coords.speed||void 0})}catch(e){console.error("Error updating driver location:",e)}},e=>{console.error("Location tracking error:",e)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:5e3}))},e1=e=>{switch(e){case"pending":case"en_viaje":return"bg-blue-100 text-blue-800";case"accepted":return"bg-yellow-100 text-yellow-800";case"preparing":return"bg-orange-100 text-orange-800";case"ready":return"bg-purple-100 text-purple-800";case"delivering":return"bg-indigo-100 text-indigo-800";case"delivered":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},e2=e=>{switch(e){case"pending":return"Pendiente";case"accepted":return"Aceptado";case"preparing":return"Preparando";case"ready":return"Listo";case"delivering":return"Entregando";case"en_viaje":return"En Viaje";case"delivered":return"Entregado";case"cancelled":return"Cancelado";default:return"Desconocido"}},e4=async()=>{if(!a||0===k.length)return void c.oR.error("No hay \xf3rdenes disponibles para optimizar");eh(!0);try{let e=await ew.optimizeRoute(k,{lat:-33.4489,lng:-70.6693},eg);em(e),c.oR.success("Ruta optimizada para ".concat(e.points.length," entregas"))}catch(e){console.error("Error optimizing route:",e),c.oR.error("Error al optimizar la ruta")}finally{eh(!1)}},e5=async()=>{if(!ed||!a)return void c.oR.error("No hay ruta optimizada disponible");try{let e=ed.points.map(e=>n.OrdersService.assignOrderToDriver(e.orderId,a.uid)),s=(await Promise.all(e)).filter(Boolean).length;s>0?(c.oR.success("".concat(s," \xf3rdenes aceptadas y asignadas")),em(null)):c.oR.error("Error al aceptar las \xf3rdenes")}catch(e){console.error("Error accepting optimized orders:",e),c.oR.error("Error al aceptar las \xf3rdenes optimizadas")}};return m?(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Cargando dashboard..."})]})}):y?(0,t.jsx)(T,{onComplete:eG}):a?e$?(0,t.jsx)(ev,{activeOrder:e$,onBackToDashboard:()=>eB(null)}):(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)(v.A,{className:"h-8 w-8 text-orange-500"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"Dashboard del Conductor"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:eT})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsxs)(d.$,{onClick:eK,disabled:eC,variant:ey?"destructive":"default",className:"".concat(ey?"bg-green-600 hover:bg-green-700":"bg-gray-600 hover:bg-gray-700"),children:[eC?(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):(0,t.jsx)(L.A,{className:"h-4 w-4 mr-2"}),ey?"En L\xednea":"Fuera de L\xednea"]}),(0,t.jsx)(I.U,{}),(0,t.jsxs)(R.eu,{children:[(0,t.jsx)(R.BK,{src:a.photoURL||"",alt:a.displayName||"Usuario"}),(0,t.jsx)(R.q5,{children:(a.displayName||a.email||"U").charAt(0).toUpperCase()})]}),(0,t.jsxs)(d.$,{onClick:o,variant:"outline",className:"hover:text-destructive",children:[(0,t.jsx)(P.A,{className:"h-4 w-4 mr-2"}),"Cerrar Sesi\xf3n"]})]})]})})}),(0,t.jsx)("div",{className:"bg-white border-b",children:(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,t.jsx)("div",{className:"flex space-x-8",children:[{id:"dashboard",label:"Dashboard",icon:M},{id:"orders",label:"\xd3rdenes",icon:z.A},{id:"earnings",label:"Ganancias",icon:Z.A},{id:"performance",label:"Rendimiento",icon:$.A},{id:"navigation",label:"Navegaci\xf3n",icon:B}].map(e=>{let s=e.icon;return(0,t.jsxs)("button",{onClick:()=>el(e.id),className:"flex items-center px-1 py-4 border-b-2 font-medium text-sm ".concat(D===e.id?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[(0,t.jsx)(s,{className:"w-4 h-4 mr-2"}),e.label]},e.id)})})})}),(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:["dashboard"===D&&(0,t.jsxs)(t.Fragment,{children:[e$&&eO&&(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Gu\xeda de Entrega"}),(0,t.jsx)(d.$,{variant:"outline",size:"sm",onClick:()=>eW(!1),children:"Minimizar Gu\xeda"})]}),(0,t.jsx)(eN,{order:e$,cook:eS.get(e$.cookerId),onStatusUpdate:eQ,onStartNavigation:e=>{let s=encodeURIComponent(e);window.open("https://www.google.com/maps/search/?api=1&query=".concat(s),"_blank"),c.oR.success("Navegaci\xf3n iniciada en Google Maps")},onCallCustomer:e=>{e?window.location.href="tel:".concat(e):c.oR.error("N\xfamero de tel\xe9fono no disponible")}})]}),e$&&!eO&&(0,t.jsx)(x.Zp,{className:"mb-6 bg-blue-50 border-blue-200",children:(0,t.jsx)(x.Wu,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center",children:(0,t.jsx)(z.A,{className:"h-5 w-5 text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"font-semibold text-blue-900",children:["Tienes una entrega activa - Pedido #",e$.id.slice(-8)]}),(0,t.jsxs)("p",{className:"text-sm text-blue-700",children:["Estado: ",e2(e$.status)," • Cliente: ",e$.customerName]})]})]}),(0,t.jsxs)(d.$,{onClick:()=>eW(!0),className:"bg-blue-600 hover:bg-blue-700",children:[(0,t.jsx)(O.A,{className:"h-4 w-4 mr-2"}),"Ver Gu\xeda"]})]})})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,t.jsxs)(x.Zp,{children:[(0,t.jsxs)(x.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(x.ZB,{className:"text-sm font-medium",children:"Ganancias de Hoy"}),(0,t.jsx)(Z.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(x.Wu,{children:[(0,t.jsxs)("div",{className:"text-2xl font-bold",children:["$",ej.todayEarnings.toLocaleString("es-CL")]}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Total: $",ej.totalEarnings.toLocaleString("es-CL")]})]})]}),(0,t.jsxs)(x.Zp,{children:[(0,t.jsxs)(x.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(x.ZB,{className:"text-sm font-medium",children:"Entregas de Hoy"}),(0,t.jsx)(z.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(x.Wu,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:ej.todayDeliveries}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Total: ",ej.totalDeliveries]})]})]}),(0,t.jsxs)(x.Zp,{children:[(0,t.jsxs)(x.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(x.ZB,{className:"text-sm font-medium",children:"Calificaci\xf3n"}),(0,t.jsx)(W.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(x.Wu,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:ej.averageRating.toFixed(1)}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[ej.completionRate,"% completado"]})]})]}),(0,t.jsxs)(x.Zp,{children:[(0,t.jsxs)(x.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(x.ZB,{className:"text-sm font-medium",children:"Tiempo en L\xednea"}),(0,t.jsx)(q.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(x.Wu,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:ej.onlineTime}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Distancia: ",ej.totalDistance]})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,t.jsx)("div",{children:(0,t.jsx)(ex,{hasActiveDelivery:!!e$,isDriverOnline:ey,onOrderAccepted:e=>{eY(e)}})}),(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsxs)(x.ZB,{className:"flex items-center",children:[(0,t.jsx)(U.A,{className:"h-5 w-5 mr-2"}),"Mis Pedidos Activos"]})}),(0,t.jsx)(x.Wu,{children:0===j.filter(e=>e.driverId===(null==a?void 0:a.uid)&&["accepted","preparing","ready","delivering"].includes(e.status)).length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(z.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-500",children:"No tienes pedidos activos asignados."}),(0,t.jsx)("p",{className:"text-sm text-gray-400 mt-2",children:"Acepta un pedido disponible para empezar a entregar."})]}):(0,t.jsx)("div",{className:"space-y-4",children:j.filter(e=>e.driverId===(null==a?void 0:a.uid)&&["accepted","preparing","ready","delivering"].includes(e.status)).map(e=>{var a,r,i;let l=eS.get(e.cookerId),n=eI.get((null==(a=e.dishes[0])?void 0:a.dishId)||""),c=(e=>{switch(e){case"ready":return"Recoger";case"delivering":return"Iniciar Viaje";case"en_viaje":return"Entregar";default:return null}})(e.status),{progress:o,timeRemaining:m,totalPrepTime:x,isReady:u}=(e=>{var s;if(!e.createdAt)return{progress:0,timeRemaining:"Calculando...",totalPrepTime:30,isReady:!1};let a=e.dishes.map(e=>({prepTime:e.prepTime||"30 min",quantity:e.quantity})),t=(0,ei.Dm)(a),r=(null==(s=e.createdAt)?void 0:s.toDate())||new Date,i=(0,ei.uA)(r,t),l=(0,ei.$B)(r,t),n=i>=100||"ready"===e.status;return{progress:i,timeRemaining:l,totalPrepTime:t,isReady:n}})(e);return(0,t.jsxs)("div",{className:"border rounded-lg p-4 space-y-3 cursor-pointer hover:bg-gray-100 transition-colors ".concat(u?"ring-2 ring-green-200 bg-green-50":""),onClick:()=>{eZ(e),eM(!0)},children:[(0,t.jsxs)("div",{className:"flex justify-between items-start",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium",children:(null==n?void 0:n.name)||"Plato desconocido"}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["De: ",(null==l?void 0:l.displayName)||"Cocinero desconocido"]}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["Para: ",e.customerName]})]}),(0,t.jsx)(E.E,{className:e1(e.status),children:e2(e.status)})]}),["accepted","preparing"].includes(e.status)&&(0,t.jsxs)("div",{className:"bg-white p-3 rounded-lg border",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(q.A,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Progreso de preparaci\xf3n"})]}),(0,t.jsx)("span",{className:"text-sm font-mono font-bold",children:u?"\uD83D\uDFE2 LISTO":m})]}),(0,t.jsx)(S.k,{value:o,className:"h-2"}),(0,t.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground mt-1",children:[(0,t.jsxs)("span",{children:["Iniciado: ",null==(r=e.createdAt)?void 0:r.toDate().toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"})]}),(0,t.jsxs)("span",{children:["Estimado: ",(0,ei.bC)((null==(i=e.createdAt)?void 0:i.toDate())||new Date,x).toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"})]})]})]}),e.dishes.length>1&&(0,t.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,t.jsxs)("h4",{className:"font-medium text-sm mb-2 flex items-center gap-2",children:[(0,t.jsx)(z.A,{className:"h-4 w-4"}),"Platos (",e.dishes.length,")"]}),(0,t.jsx)("div",{className:"space-y-1",children:e.dishes.map((e,s)=>(0,t.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,t.jsxs)("span",{children:[e.dishName," x ",e.quantity]}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:e.prepTime||"30 min"})]},s))}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground mt-2 flex items-center gap-1",children:[(0,t.jsx)(q.A,{className:"h-3 w-3"}),"Tiempo basado en el plato que toma m\xe1s tiempo"]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)(F.A,{className:"h-4 w-4 mr-1"}),e.deliveryInfo.address]}),(0,t.jsxs)("span",{className:"font-medium",children:["$",e.total.toLocaleString("es-CL")]})]}),c&&(0,t.jsx)(d.$,{onClick:a=>{a.stopPropagation(),"ready"===e.status?eQ(e.id,"delivering"):"delivering"===e.status?eX(e.id):"en_viaje"===e.status&&s.push("/driver/delivery-verification")},className:"w-full",size:"sm",children:c})]},e.id)})})})]}),(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsxs)(x.ZB,{className:"flex items-center",children:[(0,t.jsx)(f.A,{className:"h-5 w-5 mr-2"}),"Pedidos Recientes"]})}),(0,t.jsx)(x.Wu,{children:0===j.filter(e=>"delivered"===e.status).length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(f.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-500",children:"No hay entregas recientes"}),(0,t.jsx)("p",{className:"text-sm text-gray-400 mt-2",children:"Tus entregas completadas aparecer\xe1n aqu\xed"})]}):(0,t.jsx)("div",{className:"space-y-4",children:j.filter(e=>"delivered"===e.status).slice(0,5).map(e=>{var s,a,r,i,l,n,c,d,o;let m=eS.get(e.cookerId),x=eI.get((null==(s=e.dishes[0])?void 0:s.dishId)||"");return(0,t.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium",children:(null==x?void 0:x.name)||"Plato desconocido"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:(null==m?void 0:m.displayName)||"Cocinero desconocido"})]}),(0,t.jsx)(E.E,{className:"bg-green-100 text-green-800",children:"Entregado"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsxs)("span",{className:"flex items-center text-gray-600",children:[(0,t.jsx)(U.A,{className:"h-4 w-4 mr-1"}),(null==(i=e.actualDeliveryTime)||null==(r=i.toDate)||null==(a=r.call(i))?void 0:a.toLocaleDateString("es-CL"))||(null==(c=e.createdAt)||null==(n=c.toDate)||null==(l=n.call(c))?void 0:l.toLocaleDateString("es-CL"))||"Fecha no disponible"]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("span",{className:"text-green-600 font-medium",children:["+$",(e.deliveryFee||2500).toLocaleString("es-CL")]}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"Ganancia por entrega"})]})]}),e.actualDeliveryTime&&(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:["Completado: ",(null==(o=e.actualDeliveryTime)||null==(d=o.toDate())?void 0:d.toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"}))||"N/A"]})]})]},e.id)})})})]})]})]}),"earnings"===D&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsxs)(x.ZB,{className:"flex items-center",children:[(0,t.jsx)(Z.A,{className:"h-5 w-5 mr-2 text-green-600"}),"Ganancias de Hoy"]})}),(0,t.jsxs)(x.Wu,{children:[(0,t.jsxs)("div",{className:"text-3xl font-bold text-green-600",children:["$",ej.todayEarnings.toLocaleString("es-CL")]}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:[ej.todayDeliveries," entregas realizadas"]})]})]}),(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsxs)(x.ZB,{className:"flex items-center",children:[(0,t.jsx)(H.A,{className:"h-5 w-5 mr-2 text-blue-600"}),"Esta Semana"]})}),(0,t.jsxs)(x.Wu,{children:[(0,t.jsxs)("div",{className:"text-3xl font-bold text-blue-600",children:["$",ej.weekEarnings.toLocaleString("es-CL")]}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:[ej.weekDeliveries," entregas esta semana"]})]})]}),(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsxs)(x.ZB,{className:"flex items-center",children:[(0,t.jsx)(V.A,{className:"h-5 w-5 mr-2 text-purple-600"}),"Este Mes"]})}),(0,t.jsxs)(x.Wu,{children:[(0,t.jsxs)("div",{className:"text-3xl font-bold text-purple-600",children:["$",ej.monthEarnings.toLocaleString("es-CL")]}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:[ej.monthDeliveries," entregas este mes"]})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsx)(x.ZB,{children:"Desglose de Ganancias"})}),(0,t.jsx)(x.Wu,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Tarifas base de entrega"}),(0,t.jsxs)("span",{className:"font-semibold",children:["$",(.8*ej.todayEarnings).toLocaleString("es-CL")]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Propinas"}),(0,t.jsxs)("span",{className:"font-semibold",children:["$",(.15*ej.todayEarnings).toLocaleString("es-CL")]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Bonificaciones"}),(0,t.jsxs)("span",{className:"font-semibold",children:["$",(.05*ej.todayEarnings).toLocaleString("es-CL")]})]}),(0,t.jsx)("div",{className:"border-t pt-2",children:(0,t.jsxs)("div",{className:"flex justify-between items-center font-semibold",children:[(0,t.jsx)("span",{children:"Total del d\xeda"}),(0,t.jsxs)("span",{className:"text-green-600",children:["$",ej.todayEarnings.toLocaleString("es-CL")]})]})})]})})]}),(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsx)(x.ZB,{children:"Estad\xedsticas de Ganancias"})}),(0,t.jsx)(x.Wu,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Ganancia promedio por entrega"}),(0,t.jsxs)("span",{className:"font-semibold",children:["$",ej.totalDeliveries>0?(ej.totalEarnings/ej.totalDeliveries).toLocaleString("es-CL"):"0"]})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Entregas por hora (promedio)"}),(0,t.jsx)("span",{className:"font-semibold",children:"2.3"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Ganancia por hora"}),(0,t.jsx)("span",{className:"font-semibold",children:"$5,750"})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Mejor d\xeda del mes"}),(0,t.jsx)("span",{className:"font-semibold text-green-600",children:"$18,500"})]})]})})]})]})]}),"performance"===D&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsxs)(x.ZB,{className:"flex items-center",children:[(0,t.jsx)(U.A,{className:"h-5 w-5 mr-2 text-blue-600"}),"Tiempo Promedio"]})}),(0,t.jsxs)(x.Wu,{children:[(0,t.jsxs)("div",{className:"text-2xl font-bold",children:[ej.averageDeliveryTime," min"]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Por entrega"})]})]}),(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsxs)(x.ZB,{className:"flex items-center",children:[(0,t.jsx)($.A,{className:"h-5 w-5 mr-2 text-green-600"}),"Entregas a Tiempo"]})}),(0,t.jsxs)(x.Wu,{children:[(0,t.jsxs)("div",{className:"text-2xl font-bold",children:[ej.onTimeDeliveryRate,"%"]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Puntualidad"})]})]}),(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsxs)(x.ZB,{className:"flex items-center",children:[(0,t.jsx)(G.A,{className:"h-5 w-5 mr-2 text-purple-600"}),"Satisfacci\xf3n Cliente"]})}),(0,t.jsxs)(x.Wu,{children:[(0,t.jsxs)("div",{className:"text-2xl font-bold",children:[ej.customerSatisfactionRate,"%"]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Calificaci\xf3n promedio"})]})]}),(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsxs)(x.ZB,{className:"flex items-center",children:[(0,t.jsx)(_,{className:"h-5 w-5 mr-2 text-orange-600"}),"Eficiencia"]})}),(0,t.jsxs)(x.Wu,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:ej.fuelEfficiency}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Consumo combustible"})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsxs)(x.ZB,{className:"flex items-center",children:[(0,t.jsx)(J.A,{className:"h-5 w-5 mr-2"}),"Logros y Metas"]})}),(0,t.jsx)(x.Wu,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(K,{className:"h-5 w-5 mr-2 text-green-600"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Conductor Confiable"})]}),(0,t.jsx)(E.E,{className:"bg-green-100 text-green-800",children:"Conseguido"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(W.A,{className:"h-5 w-5 mr-2 text-yellow-600"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"5 Estrellas"})]}),(0,t.jsx)(E.E,{className:"bg-yellow-100 text-yellow-800",children:"Conseguido"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(z.A,{className:"h-5 w-5 mr-2 text-blue-600"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"100 Entregas"})]}),(0,t.jsx)(E.E,{variant:"outline",children:"En Progreso"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,t.jsx)("span",{children:"Progreso hacia 100 entregas"}),(0,t.jsxs)("span",{children:[ej.totalDeliveries,"/100"]})]}),(0,t.jsx)(S.k,{value:ej.totalDeliveries/100*100,className:"h-2"})]})]})})]}),(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsxs)(x.ZB,{className:"flex items-center",children:[(0,t.jsx)(Q.A,{className:"h-5 w-5 mr-2"}),"M\xe9tricas de Rendimiento"]})}),(0,t.jsx)(x.Wu,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,t.jsx)("span",{children:"Puntualidad"}),(0,t.jsxs)("span",{children:[ej.onTimeDeliveryRate,"%"]})]}),(0,t.jsx)(S.k,{value:ej.onTimeDeliveryRate,className:"h-2"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,t.jsx)("span",{children:"Tasa de Aceptaci\xf3n"}),(0,t.jsxs)("span",{children:[ej.completionRate,"%"]})]}),(0,t.jsx)(S.k,{value:ej.completionRate,className:"h-2"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,t.jsx)("span",{children:"Satisfacci\xf3n del Cliente"}),(0,t.jsxs)("span",{children:[ej.customerSatisfactionRate,"%"]})]}),(0,t.jsx)(S.k,{value:ej.customerSatisfactionRate,className:"h-2"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,t.jsx)("span",{children:"Calificaci\xf3n General"}),(0,t.jsxs)("span",{children:[ej.averageRating.toFixed(1),"/5.0"]})]}),(0,t.jsx)(S.k,{value:ej.averageRating/5*100,className:"h-2"})]})]})})]})]})]}),"navigation"===D&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)(x.Zp,{className:"lg:col-span-2",children:[(0,t.jsx)(x.aR,{children:(0,t.jsxs)(x.ZB,{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(B,{className:"h-5 w-5 mr-2"}),"\xd3rdenes Disponibles (",k.length,")"]}),(0,t.jsx)(d.$,{onClick:e4,disabled:eu||0===k.length,className:"bg-orange-600 hover:bg-orange-700",children:eu?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Y.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Optimizando..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.A,{className:"h-4 w-4 mr-2"}),"Optimizar Ruta"]})})]})}),(0,t.jsx)(x.Wu,{children:0===k.length?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(z.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay \xf3rdenes disponibles"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Las \xf3rdenes listas para entrega aparecer\xe1n aqu\xed para ser optimizadas."})]}):(0,t.jsx)("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:k.map(e=>{let s=eS[e.cookerId];return(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 bg-orange-100 rounded-full flex items-center justify-center",children:(0,t.jsx)(z.A,{className:"h-4 w-4 text-orange-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{className:"font-medium text-sm",children:["#",e.id.slice(-8)]}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:[s?s.businessName:"Cocinero"," • ",e.customerName]})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("p",{className:"font-medium text-sm",children:["$",e.total.toLocaleString("es-CL")]}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:[e.deliveryInfo.address.slice(0,30),"..."]})]})]},e.id)})})})]}),(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsxs)(x.ZB,{className:"flex items-center",children:[(0,t.jsx)(X.A,{className:"h-5 w-5 mr-2"}),"Configuraci\xf3n"]})}),(0,t.jsx)(x.Wu,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"Priorizar Pedidos Costosos"}),(0,t.jsx)("input",{type:"checkbox",checked:eg.prioritizeHighValue,onChange:e=>ep({...eg,prioritizeHighValue:e.target.checked}),className:"rounded"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"Considerar Tr\xe1fico"}),(0,t.jsx)("input",{type:"checkbox",checked:eg.considerTraffic,onChange:e=>ep({...eg,considerTraffic:e.target.checked}),className:"rounded"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"text-sm font-medium block mb-2",children:["Tiempo M\xe1ximo (min): ",eg.maxDeliveryTime]}),(0,t.jsx)("input",{type:"range",min:"60",max:"180",value:eg.maxDeliveryTime,onChange:e=>ep({...eg,maxDeliveryTime:parseInt(e.target.value)}),className:"w-full"})]})]})})]})]}),ed&&(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsxs)(x.ZB,{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(ee,{className:"h-5 w-5 mr-2"}),"Ruta Optimizada"]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsxs)(d.$,{variant:"outline",onClick:()=>{if(!ed||0===ed.points.length)return void c.oR.error("Primero optimiza la ruta");let e=ew.generateNavigationUrl(ed.points,!0);e?(window.open(e,"_blank"),c.oR.success("Navegaci\xf3n iniciada en Google Maps")):c.oR.error("Error al generar la URL de navegaci\xf3n")},className:"text-blue-600 border-blue-600 hover:bg-blue-50",children:[(0,t.jsx)(es.A,{className:"h-4 w-4 mr-2"}),"Navegar"]}),(0,t.jsxs)(d.$,{onClick:e5,className:"bg-green-600 hover:bg-green-700",children:[(0,t.jsx)(f.A,{className:"h-4 w-4 mr-2"}),"Aceptar Todas"]})]})]})}),(0,t.jsxs)(x.Wu,{children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,t.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[(0,t.jsx)(B,{className:"h-6 w-6 text-blue-600 mx-auto mb-2"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Total Entregas"}),(0,t.jsx)("p",{className:"text-lg font-bold text-blue-600",children:ed.points.length})]}),(0,t.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,t.jsx)(L.A,{className:"h-6 w-6 text-green-600 mx-auto mb-2"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Distancia"}),(0,t.jsxs)("p",{className:"text-lg font-bold text-green-600",children:[ed.totalDistance," km"]})]}),(0,t.jsxs)("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[(0,t.jsx)(U.A,{className:"h-6 w-6 text-orange-600 mx-auto mb-2"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Tiempo Total"}),(0,t.jsxs)("p",{className:"text-lg font-bold text-orange-600",children:[Math.round(ed.totalTime)," min"]})]}),(0,t.jsxs)("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[(0,t.jsx)(_,{className:"h-6 w-6 text-purple-600 mx-auto mb-2"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Costo Combustible"}),(0,t.jsxs)("p",{className:"text-lg font-bold text-purple-600",children:["$",ed.estimatedFuelCost]})]})]}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Eficiencia de la Ruta"}),(0,t.jsxs)("span",{className:"text-sm font-bold",children:[ed.efficiency,"%"]})]}),(0,t.jsx)(S.k,{value:ed.efficiency,className:"h-2"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:ed.efficiency>=80?"\xa1Excelente optimizaci\xf3n!":ed.efficiency>=60?"Buena optimizaci\xf3n":"Ruta poco eficiente"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900",children:"Secuencia de Entregas:"}),ed.points.map((e,s)=>{let a=k.find(s=>s.id===e.orderId),r=a?eS[a.cookerId]:null;return(0,t.jsxs)("div",{className:"flex items-center space-x-4 p-3 bg-gray-50 rounded-lg",children:[(0,t.jsx)("div",{className:"flex-shrink-0 w-8 h-8 bg-orange-600 text-white rounded-full flex items-center justify-center text-sm font-bold",children:s+1}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h5",{className:"font-medium text-sm truncate",children:["Pedido #",e.orderId.slice(-8)]}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:[r?r.businessName:"Cocinero"," → ",e.customerName]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("p",{className:"text-sm font-medium",children:["$",e.orderValue.toLocaleString("es-CL")]}),(0,t.jsxs)(E.E,{className:"text-xs ".concat("high"===e.priority?"bg-red-100 text-red-800":"medium"===e.priority?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:["high"===e.priority?"Alta":"medium"===e.priority?"Media":"Baja"," Prioridad"]})]})]}),(0,t.jsxs)("div",{className:"flex items-center mt-2",children:[(0,t.jsx)(F.A,{className:"h-3 w-3 text-gray-400 mr-1"}),(0,t.jsx)("p",{className:"text-xs text-gray-600 truncate",children:e.address})]}),(0,t.jsxs)("div",{className:"flex items-center mt-1",children:[(0,t.jsx)(U.A,{className:"h-3 w-3 text-gray-400 mr-1"}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:["~",Math.round(e.estimatedDeliveryTime)," min de entrega"]})]})]}),(0,t.jsx)("div",{className:"flex-shrink-0",children:(0,t.jsx)(d.$,{variant:"outline",size:"sm",onClick:()=>{let s=encodeURIComponent(e.address);window.open("https://www.google.com/maps/search/?api=1&query=".concat(s),"_blank")},children:(0,t.jsx)(L.A,{className:"h-3 w-3"})})}),s<ed.points.length-1&&(0,t.jsx)("div",{className:"absolute left-4 mt-12 w-0.5 h-6 bg-gray-300"})]},e.id)})]}),ed.totalTime>120&&(0,t.jsx)("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(ea.A,{className:"h-4 w-4 text-yellow-600 mr-2"}),(0,t.jsx)("p",{className:"text-sm text-yellow-800",children:"Esta ruta tomar\xe1 m\xe1s de 2 horas. Considera dividir las entregas en m\xfaltiples viajes."})]})})]})]}),!ed&&k.length>0&&(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsx)(x.ZB,{className:"text-lg",children:"\xbfC\xf3mo usar la optimizaci\xf3n de rutas?"})}),(0,t.jsxs)(x.Wu,{children:[(0,t.jsxs)("div",{className:"space-y-3 text-sm text-gray-600",children:[(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)("div",{className:"w-6 h-6 bg-orange-600 text-white rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0",children:"1"}),(0,t.jsx)("span",{children:"Configura las preferencias de optimizaci\xf3n (prioridad, tr\xe1fico, tiempo m\xe1ximo)"})]}),(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)("div",{className:"w-6 h-6 bg-orange-600 text-white rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0",children:"2"}),(0,t.jsx)("span",{children:'Presiona "Optimizar Ruta" para calcular la mejor secuencia de entregas'})]}),(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)("div",{className:"w-6 h-6 bg-orange-600 text-white rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0",children:"3"}),(0,t.jsx)("span",{children:"Revisa la ruta propuesta, m\xe9tricas de eficiencia y secuencia de entregas"})]}),(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)("div",{className:"w-6 h-6 bg-orange-600 text-white rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0",children:"4"}),(0,t.jsx)("span",{children:"Acepta todas las \xf3rdenes de la ruta optimizada o navega individualmente"})]})]}),(0,t.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[(0,t.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"Beneficios de la optimizaci\xf3n:"}),(0,t.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,t.jsx)("li",{children:"• Reduce distancia total y tiempo de entrega"}),(0,t.jsx)("li",{children:"• Prioriza pedidos de alto valor y urgencia"}),(0,t.jsx)("li",{children:"• Minimiza costos de combustible"}),(0,t.jsx)("li",{children:"• Mejora eficiencia y satisfacci\xf3n del cliente"})]})]})]})]})]}),"orders"===D&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsxs)(x.ZB,{className:"flex items-center",children:[(0,t.jsx)(z.A,{className:"h-5 w-5 mr-2 text-blue-600"}),"Disponibles"]})}),(0,t.jsxs)(x.Wu,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:k.length}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"\xd3rdenes disponibles"})]})]}),(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsxs)(x.ZB,{className:"flex items-center",children:[(0,t.jsx)(U.A,{className:"h-5 w-5 mr-2 text-orange-600"}),"En Progreso"]})}),(0,t.jsxs)(x.Wu,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:j.filter(e=>["accepted","preparing","ready","delivering"].includes(e.status)).length}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"\xd3rdenes activas"})]})]}),(0,t.jsxs)(x.Zp,{children:[(0,t.jsx)(x.aR,{children:(0,t.jsxs)(x.ZB,{className:"flex items-center",children:[(0,t.jsx)(f.A,{className:"h-5 w-5 mr-2 text-green-600"}),"Completadas Hoy"]})}),(0,t.jsxs)(x.Wu,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:ej.todayDeliveries}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Entregas de hoy"})]})]})]}),(0,t.jsx)("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg w-fit",children:[{id:"available",label:"Disponibles",count:k.length},{id:"active",label:"Activas",count:j.filter(e=>["accepted","preparing","ready","delivering"].includes(e.status)&&e.driverId===(null==a?void 0:a.uid)).length},{id:"completed",label:"Completadas",count:j.filter(e=>"delivered"===e.status&&e.driverId===(null==a?void 0:a.uid)).length}].map(e=>(0,t.jsxs)("button",{onClick:()=>ec(e.id),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat(en===e.id?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"),children:[e.label," (",e.count,")"]},e.id))}),(0,t.jsx)("div",{className:"grid gap-4",children:(e=[],("available"===en?e=k:"active"===en?e=j.filter(e=>["accepted","preparing","ready","delivering"].includes(e.status)&&e.driverId===(null==a?void 0:a.uid)):"completed"===en&&(e=j.filter(e=>"delivered"===e.status&&e.driverId===(null==a?void 0:a.uid)).slice(0,10)),0===e.length)?(0,t.jsx)(x.Zp,{children:(0,t.jsxs)(x.Wu,{className:"flex flex-col items-center justify-center py-12",children:[(0,t.jsx)(z.A,{className:"h-12 w-12 text-gray-400 mb-4"}),(0,t.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:["available"===en&&"No hay \xf3rdenes disponibles","active"===en&&"No tienes \xf3rdenes activas","completed"===en&&"No has completado entregas hoy"]}),(0,t.jsxs)("p",{className:"text-gray-500 text-center max-w-sm",children:["available"===en&&"Las nuevas \xf3rdenes aparecer\xe1n aqu\xed cuando est\xe9n listas para entrega.","active"===en&&"Las \xf3rdenes que aceptes aparecer\xe1n aqu\xed.","completed"===en&&"Tus entregas completadas aparecer\xe1n aqu\xed."]})]})}):e.map(e=>{let s=eS[e.cookerId],a=e.dishes.reduce((e,s)=>e+s.quantity,0);return(0,t.jsx)(x.Zp,{className:"hover:shadow-md transition-shadow",children:(0,t.jsx)(x.Wu,{className:"p-6",children:(0,t.jsx)("div",{className:"flex items-start justify-between",children:(0,t.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center",children:(0,t.jsx)(z.A,{className:"h-5 w-5 text-orange-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"font-semibold text-gray-900",children:["Pedido #",e.id.slice(-8)]}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:s?s.businessName:"Cocinero desconocido"})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"text-lg font-bold text-gray-900",children:["$",e.total.toLocaleString("es-CL")]}),(0,t.jsx)(E.E,{className:e1(e.status),children:e2(e.status)})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(et.A,{className:"h-4 w-4 text-gray-400"}),(0,t.jsx)("span",{className:"text-gray-600",children:e.customerName})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(er.A,{className:"h-4 w-4 text-gray-400"}),(0,t.jsxs)("span",{className:"text-gray-600",children:[a," platos"]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(U.A,{className:"h-4 w-4 text-gray-400"}),(0,t.jsx)("span",{className:"text-gray-600",children:(0,eA.GP)(e.createdAt.toDate(),"HH:mm")})]})]}),(0,t.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,t.jsx)(F.A,{className:"h-4 w-4 text-gray-400 mt-0.5"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:e.deliveryInfo.address}),e.deliveryInfo.instructions&&(0,t.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Instrucciones: ",e.deliveryInfo.instructions]})]})]}),(0,t.jsxs)("div",{className:"flex space-x-2 pt-2",children:[(0,t.jsx)(d.$,{variant:"outline",size:"sm",onClick:()=>{eZ(e),eM(!0)},children:"Ver Detalles"}),"available"===en&&ey&&(0,t.jsx)(d.$,{size:"sm",onClick:()=>eY(e.id),className:"bg-green-600 hover:bg-green-700",children:"Aceptar Entrega"}),"active"===en&&"accepted"===e.status&&(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsx)(E.E,{variant:"outline",className:"text-yellow-600 border-yellow-300",children:"Esperando confirmaci\xf3n del cocinero"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"El cocinero debe confirmar que puede preparar el pedido"})]}),"active"===en&&"preparing"===e.status&&(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsxs)(E.E,{variant:"outline",className:"text-blue-600 border-blue-300",children:["Preparando (",e.estimatedReadyTime||"Calculando...",")"]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"El cocinero est\xe1 preparando el pedido"})]}),"active"===en&&"ready"===e.status&&(0,t.jsx)(d.$,{size:"sm",onClick:()=>eQ(e.id,"delivering"),className:"bg-blue-600 hover:bg-blue-700",children:"Recoger y Entregar"}),"active"===en&&"delivering"===e.status&&(0,t.jsx)(d.$,{size:"sm",onClick:()=>eQ(e.id,"delivered"),className:"bg-green-600 hover:bg-green-700",children:"Confirmar Entrega"}),e.deliveryInfo.address&&(0,t.jsxs)(d.$,{variant:"outline",size:"sm",onClick:()=>{let s=encodeURIComponent(e.deliveryInfo.address);window.open("https://www.google.com/maps/search/?api=1&query=".concat(s),"_blank")},children:[(0,t.jsx)(L.A,{className:"h-4 w-4 mr-1"}),"Navegar"]})]})]})})})},e.id)}))})]})]}),(0,t.jsx)(eo,{isOpen:eP,onClose:()=>eM(!1),order:ez,cooksMap:eS,dishesMap:eI,onAcceptOrder:eY,onUpdateOrderStatus:eQ,isDriverOnline:ey,isOrderAssignedToDriver:(null==ez?void 0:ez.driverId)===(null==a?void 0:a.uid)})]}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)("p",{className:"text-gray-600",children:"Por favor, inicia sesi\xf3n para continuar."})})})}},14186:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},33786:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},35742:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]])},38564:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]])},41397:(e,s,a)=>{"use strict";a.d(s,{k:()=>n});var t=a(95155),r=a(12115),i=a(55863),l=a(53999);let n=r.forwardRef((e,s)=>{let{className:a,value:r,...n}=e;return(0,t.jsx)(i.bL,{ref:s,className:(0,l.cn)("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",a),...n,children:(0,t.jsx)(i.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(r||0),"%)")}})})});n.displayName=i.bL.displayName},44597:(e,s,a)=>{"use strict";a.r(s),a.d(s,{DeliveryTrackingService:()=>i});var t=a(66579),r=a(35317);class i{static async updateDeliveryTracking(e){try{let s=(0,r.doc)(t.db,this.collection,e.orderId);return await (0,r.BN)(s,{...e,lastUpdated:r.Dc.now()},{merge:!0}),!0}catch(e){return console.error("Error updating delivery tracking:",e),!1}}static subscribeToDeliveryTracking(e,s){let a=(0,r.doc)(t.db,this.collection,e);return(0,r.aQ)(a,e=>{e.exists()?s({orderId:e.id,...e.data()}):s(null)},e=>{console.error("Error subscribing to delivery tracking:",e),s(null)})}static async updateDriverLocation(e,s){try{let a=(0,r.doc)(t.db,this.collection,e);return await (0,r.mZ)(a,{currentLocation:{...s,timestamp:r.Dc.now()},lastUpdated:r.Dc.now()}),!0}catch(e){return console.error("Error updating driver location:",e),!1}}static async updateETA(e,s){try{let a=(0,r.doc)(t.db,this.collection,e),i={lastUpdated:r.Dc.now()};return s.pickup&&(i.estimatedPickupTime=s.pickup),s.delivery&&(i.estimatedDeliveryTime=s.delivery),s.total&&(i.totalEstimatedTime=s.total),await (0,r.mZ)(a,i),!0}catch(e){return console.error("Error updating ETA:",e),!1}}static async updateDeliveryStep(e,s){try{let a=(0,r.doc)(t.db,this.collection,e);return await (0,r.mZ)(a,{currentStep:s,lastUpdated:r.Dc.now()}),!0}catch(e){return console.error("Error updating delivery step:",e),!1}}static async completeDelivery(e){try{let s=(0,r.doc)(t.db,this.collection,e);return await (0,r.mZ)(s,{currentStep:"delivered",lastUpdated:r.Dc.now()}),!0}catch(e){return console.error("Error completing delivery:",e),!1}}static getCurrentLocation(){return new Promise((e,s)=>{if(!navigator.geolocation)return void s(Error("Geolocation not supported"));navigator.geolocation.getCurrentPosition(s=>{e({lat:s.coords.latitude,lng:s.coords.longitude})},e=>s(e),{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e4})})}static calculateDistance(e,s,a,t){let r=(a-e)*Math.PI/180,i=(t-s)*Math.PI/180,l=Math.sin(r/2)*Math.sin(r/2)+Math.cos(e*Math.PI/180)*Math.cos(a*Math.PI/180)*Math.sin(i/2)*Math.sin(i/2);return 2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))*6371}static startLocationTracking(e,s,a,t){let r=null,i=0,l=async()=>{try{let s=await this.getCurrentLocation(),a=Date.now();a-i>1e4&&(await this.updateDriverLocation(e,s),i=a),null==t||t(s)}catch(e){console.error("Error updating location:",e)}};return navigator.geolocation&&(r=navigator.geolocation.watchPosition(()=>l(),e=>console.error("Geolocation error:",e),{enableHighAccuracy:!0,timeout:1e4,maximumAge:5e3})),l(),{stop:()=>{null!==r&&navigator.geolocation.clearWatch(r)}}}}i.collection="deliveryTracking"},50744:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("chef-hat",[["path",{d:"M17 21a1 1 0 0 0 1-1v-5.35c0-.457.316-.844.727-1.041a4 4 0 0 0-2.134-7.589 5 5 0 0 0-9.186 0 4 4 0 0 0-2.134 7.588c.411.198.727.585.727 1.041V20a1 1 0 0 0 1 1Z",key:"1qvrer"}],["path",{d:"M6 17h12",key:"1jwigz"}]])},53904:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},59422:(e,s,a)=>{Promise.resolve().then(a.bind(a,3927))},71539:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},75525:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},76037:(e,s,a)=>{"use strict";a.d(s,{w:()=>n});var t=a(95155),r=a(12115),i=a(87489),l=a(53999);let n=r.forwardRef((e,s)=>{let{className:a,orientation:r="horizontal",decorative:n=!0,...c}=e;return(0,t.jsx)(i.b,{ref:s,decorative:n,orientation:r,className:(0,l.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",a),...c})});n.displayName=i.b.displayName},79397:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},87489:(e,s,a)=>{"use strict";a.d(s,{b:()=>d});var t=a(12115),r=a(63655),i=a(95155),l="horizontal",n=["horizontal","vertical"],c=t.forwardRef((e,s)=>{var a;let{decorative:t,orientation:c=l,...d}=e,o=(a=c,n.includes(a))?c:l;return(0,i.jsx)(r.sG.div,{"data-orientation":o,...t?{role:"none"}:{"aria-orientation":"vertical"===o?o:void 0,role:"separator"},...d,ref:s})});c.displayName="Separator";var d=c}},e=>{e.O(0,[9135,3965,6331,2670,6671,1492,8250,8034,2378,3143,4872,9980,4923,6751,910,1895,8441,5964,7358],()=>e(e.s=59422)),_N_E=e.O()}]);
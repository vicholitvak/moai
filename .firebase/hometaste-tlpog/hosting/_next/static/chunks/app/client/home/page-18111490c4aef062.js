(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2846],{14132:(e,s,i)=>{"use strict";i.r(s),i.d(s,{default:()=>H});var a=i(95155),t=i(12115),r=i(35695),l=i(66766),n=i(25731),c=i(36515),o=i(46751),d=i(67503),m=i(14186),h=i(40646),u=i(50744),x=i(37108),p=i(29799),g=i(85339),f=i(23861),j=i(86151),N=i(47924),v=i(81586),y=i(95747),b=i(38564),w=i(33109),k=i(92138),A=i(51976),C=i(4516),E=i(97168),R=i(88482),S=i(88145),P=i(69663),T=i(41397),D=i(34964),B=i(53999),O=i(56671),L=i(74042),Z=i(16785),W=i(71539),$=i(69037),z=i(53311),I=i(27809),q=i(53904),M=i(47655);let V=t.forwardRef((e,s)=>{let{className:i,children:t,...r}=e;return(0,a.jsxs)(M.bL,{ref:s,className:(0,B.cn)("relative overflow-hidden",i),...r,children:[(0,a.jsx)(M.LM,{className:"h-full w-full rounded-[inherit]",children:t}),(0,a.jsx)(U,{}),(0,a.jsx)(M.OK,{})]})});V.displayName=M.bL.displayName;let U=t.forwardRef((e,s)=>{let{className:i,orientation:t="vertical",...r}=e;return(0,a.jsx)(M.VM,{ref:s,orientation:t,className:(0,B.cn)("flex touch-none select-none transition-colors","vertical"===t&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",i),...r,children:(0,a.jsx)(M.lr,{className:"relative flex-1 rounded-full bg-border"})})});U.displayName=M.VM.displayName;var _=i(81198),J=i(38274),F=i(60760);function X(e){let{maxItems:s=6,showCategories:i=!0,userId:l}=e,{user:d}=(0,n.A)(),{addToCart:h}=(0,c._)(),u=(0,r.useRouter)(),[x,p]=(0,t.useState)([]),[g,f]=(0,t.useState)(!0),[j,N]=(0,t.useState)("for_you"),[v,y]=(0,t.useState)(!1),[k,A]=(0,t.useState)({favoriteCategories:[],averageOrderValue:0,preferredPrepTime:"30",dietaryRestrictions:[],orderHistory:[]});(0,t.useEffect)(()=>{(d||l)&&(T(),L())},[d,l]);let T=async()=>{try{let e=l||(null==d?void 0:d.uid);if(!e)return;let s=(await o.OrdersService.getOrdersByCustomer(e)).filter(e=>"delivered"===e.status),i={},a=[],t=0;s.forEach(e=>{var s;t+=e.total,null==(s=e.dishes)||s.forEach(e=>{var s,t,r;a.push(e.dishId);let l=(null==(s=e.dishName)?void 0:s.includes("pizza"))?"Italiana":(null==(t=e.dishName)?void 0:t.includes("burger"))?"Americana":(null==(r=e.dishName)?void 0:r.includes("sushi"))?"Japonesa":"Variada";i[l]=(i[l]||0)+1})});let r=Object.entries(i).sort((e,s)=>{let[,i]=e,[,a]=s;return a-i}).slice(0,3).map(e=>{let[s]=e;return s}),n=s.length>0?t/s.length:0;A({favoriteCategories:r,averageOrderValue:n,preferredPrepTime:"30",dietaryRestrictions:[],orderHistory:a.slice(0,20)})}catch(e){console.error("Error loading user preferences:",e)}},L=async()=>{f(!0);try{let e=(await o.DishesService.getAllDishes()).filter(e=>e.isAvailable),i=(new Date().getHours(),[]),t=await M(e);i.push({id:"for_you",title:"Para Ti",description:"Seleccionados especialmente para tus gustos",icon:(0,a.jsx)(Z.A,{className:"h-5 w-5"}),color:"text-purple-600 dark:text-purple-400",dishes:t.slice(0,s)});let r=e.sort((e,s)=>{let i=10*e.rating+(e.reviewCount||0)+20*Math.random();return 10*s.rating+(s.reviewCount||0)+20*Math.random()-i}).slice(0,s);i.push({id:"trending",title:"Tendencias",description:"Lo m\xe1s popular en este momento",icon:(0,a.jsx)(w.A,{className:"h-5 w-5"}),color:"text-green-600 dark:text-green-400",dishes:r});let l=e.filter(e=>{var s;return 20>=parseInt((null==(s=e.prepTime)?void 0:s.replace(/\D/g,""))||"30")}).sort((e,s)=>s.rating-e.rating).slice(0,s);i.push({id:"quick",title:"R\xe1pido y F\xe1cil",description:"Listo en menos de 20 minutos",icon:(0,a.jsx)(W.A,{className:"h-5 w-5"}),color:"text-yellow-600 dark:text-yellow-400",dishes:l});let n=e.filter(e=>e.price>15e3&&e.rating>=4.5).sort((e,s)=>s.rating-e.rating).slice(0,s);n.length>0&&i.push({id:"premium",title:"Selecci\xf3n Premium",description:"Experiencias culinarias excepcionales",icon:(0,a.jsx)($.A,{className:"h-5 w-5"}),color:"text-amber-600 dark:text-amber-400",dishes:n});let c=e.filter(()=>.4>Math.random()).sort((e,s)=>s.rating-e.rating).slice(0,s);c.length>0&&i.push({id:"nearby",title:"Cerca de Ti",description:"Cocineros en tu \xe1rea",icon:(0,a.jsx)(C.A,{className:"h-5 w-5"}),color:"text-blue-600 dark:text-blue-400",dishes:c});let d=e.filter(e=>e.createdAt?(Date.now()-e.createdAt.toMillis())/864e5<=7:.2>Math.random()).sort((e,s)=>s.rating-e.rating).slice(0,s);d.length>0&&i.push({id:"new",title:"Nuevos y Emocionantes",description:"\xdaltimas creaciones de nuestros cocineros",icon:(0,a.jsx)(z.A,{className:"h-5 w-5"}),color:"text-pink-600 dark:text-pink-400",dishes:d}),p(i)}catch(e){console.error("Error loading recommendations:",e),O.oR.error("Error al cargar las recomendaciones")}finally{f(!1)}},M=async e=>{let i={availability:!0,sortBy:"rating"};if(k.favoriteCategories.length>0&&(i.category=k.favoriteCategories[0]),k.averageOrderValue>0){let e=.3*k.averageOrderValue;i.priceRange={min:Math.max(0,k.averageOrderValue-e),max:k.averageOrderValue+e}}k.dietaryRestrictions.length>0&&(i.dietary=k.dietaryRestrictions);try{let a=(await _.S.search(i)).dishes;if(a.length<s){let i=e.filter(e=>!a.find(s=>s.id===e.id)).filter(e=>e.rating>=4).sort((e,s)=>s.rating-e.rating);a=[...a,...i].slice(0,s)}return a}catch(i){return console.error("Error generating personalized recommendations:",i),e.filter(e=>e.rating>=4).sort((e,s)=>s.rating-e.rating).slice(0,s)}},X=async()=>{y(!0),await L(),y(!1),O.oR.success("Recomendaciones actualizadas")},K=async e=>{if(!d&&!l)return void O.oR.error("Debes iniciar sesi\xf3n para agregar al carrito");try{let s={dishId:e.id,name:e.name,price:e.price,image:e.image,cookerName:e.cookerName,cookerId:e.cookerId,cookerAvatar:e.cookerAvatar,quantity:1,prepTime:e.prepTime,category:e.category};h(s),O.oR.success("".concat(e.name," agregado al carrito"))}catch(e){console.error("Error adding to cart:",e),O.oR.error("Error al agregar al carrito")}},H=e=>{var s,i;let{dish:t}=e;return(0,a.jsx)(J.P.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:(0,a.jsxs)(R.Zp,{className:"group cursor-pointer hover:shadow-lg transition-all duration-300 hover:-translate-y-1",onClick:()=>u.push("/dishes/".concat(t.id)),children:[(0,a.jsxs)("div",{className:"aspect-[4/3] relative overflow-hidden rounded-t-lg",children:[(0,a.jsx)("img",{src:t.image,alt:t.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",onError:e=>{e.currentTarget.src="https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=400&h=300&fit=crop"}}),(0,a.jsx)("div",{className:"absolute top-2 right-2",children:(0,a.jsxs)(S.E,{className:"bg-white/90 text-gray-900 backdrop-blur-sm",children:[(0,a.jsx)(b.A,{className:"h-3 w-3 mr-1 fill-yellow-400 text-yellow-400"}),(null==(s=t.rating)?void 0:s.toFixed(1))||"Nuevo"]})}),t.reviewCount&&t.reviewCount>10&&(0,a.jsx)(S.E,{className:"absolute top-2 left-2 bg-green-500/90 text-white",children:"Popular"})]}),(0,a.jsxs)(R.Wu,{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,a.jsx)("h3",{className:"font-semibold text-base line-clamp-1 group-hover:text-primary transition-colors",children:t.name}),(0,a.jsx)("span",{className:"text-lg font-bold text-primary",children:(0,B.$g)(t.price)})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-3 line-clamp-2",children:t.description}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,a.jsxs)(P.eu,{className:"h-6 w-6",children:[(0,a.jsx)(P.BK,{src:t.cookerAvatar}),(0,a.jsx)(P.q5,{children:null==(i=t.cookerName)?void 0:i[0]})]}),(0,a.jsx)("span",{className:"text-sm text-muted-foreground",children:t.cookerName})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-muted-foreground mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(m.A,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:t.prepTime})]}),(0,a.jsx)("span",{className:"text-xs",children:t.category})]}),(0,a.jsxs)(E.$,{className:"w-full opacity-0 group-hover:opacity-100 transition-opacity duration-300",onClick:e=>{e.stopPropagation(),K(t)},children:[(0,a.jsx)(I.A,{className:"h-4 w-4 mr-2"}),"Agregar al Carrito"]})]})]})})};if(g)return(0,a.jsx)("div",{className:"space-y-6",children:[1,2,3].map(e=>(0,a.jsxs)(R.Zp,{children:[(0,a.jsxs)(R.aR,{children:[(0,a.jsx)("div",{className:"h-6 bg-muted rounded animate-pulse"}),(0,a.jsx)("div",{className:"h-4 bg-muted rounded w-2/3 animate-pulse"})]}),(0,a.jsx)(R.Wu,{children:(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[1,2,3,4,5,6].map(e=>(0,a.jsx)("div",{className:"aspect-[4/3] bg-muted rounded animate-pulse"},e))})})]},e))});if(!i&&x.length>0){let e=x.flatMap(e=>e.dishes).slice(0,s);return(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:(0,a.jsx)(F.N,{children:e.map(e=>(0,a.jsx)(H,{dish:e},e.id))})})}return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold",children:"Recomendaciones Inteligentes"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Descubre platos perfectos para ti basados en tus gustos"})]}),(0,a.jsxs)(E.$,{variant:"outline",size:"sm",onClick:X,disabled:v,children:[(0,a.jsx)(q.A,{className:"h-4 w-4 mr-2 ".concat(v?"animate-spin":"")}),"Actualizar"]})]}),(0,a.jsxs)(D.tU,{value:j,onValueChange:N,children:[(0,a.jsxs)(V,{className:"w-full whitespace-nowrap",children:[(0,a.jsx)(D.j7,{className:"inline-flex h-12 items-center justify-start w-max p-1 bg-muted rounded-lg",children:x.map(e=>(0,a.jsxs)(D.Xi,{value:e.id,className:"flex items-center gap-2 px-4 py-2",children:[(0,a.jsx)("span",{className:e.color,children:e.icon}),(0,a.jsx)("span",{children:e.title}),(0,a.jsx)(S.E,{variant:"secondary",className:"ml-1",children:e.dishes.length})]},e.id))}),(0,a.jsx)(U,{orientation:"horizontal"})]}),(0,a.jsx)(F.N,{mode:"wait",children:x.map(e=>(0,a.jsx)(D.av,{value:e.id,className:"space-y-4",children:(0,a.jsx)(J.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:(0,a.jsxs)(R.Zp,{children:[(0,a.jsxs)(R.aR,{children:[(0,a.jsxs)(R.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:e.color,children:e.icon}),e.title]}),(0,a.jsx)(R.BT,{children:e.description})]}),(0,a.jsx)(R.Wu,{children:e.dishes.length>0?(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:(0,a.jsx)(F.N,{children:e.dishes.map(e=>(0,a.jsx)(H,{dish:e},e.id))})}):(0,a.jsx)("div",{className:"text-center py-8",children:(0,a.jsx)("p",{className:"text-muted-foreground",children:"No hay platos disponibles en esta categor\xeda"})})})]})})},e.id))})]})]})}let K={pending:{label:"Pendiente",color:"yellow",icon:m.A},accepted:{label:"Aceptado",color:"blue",icon:h.A},preparing:{label:"Preparando",color:"orange",icon:u.A},ready:{label:"Listo",color:"green",icon:x.A},delivering:{label:"En camino",color:"purple",icon:p.A},delivered:{label:"Entregado",color:"green",icon:h.A},cancelled:{label:"Cancelado",color:"red",icon:g.A}},H=()=>{var e,s,i,p,g;let{user:Z}=(0,n.A)(),{itemCount:W}=(0,c._)(),$=(0,r.useRouter)(),[z,I]=(0,t.useState)([]),[q,M]=(0,t.useState)([]),[V,U]=(0,t.useState)([]),[_,J]=(0,t.useState)([]),[F,H]=(0,t.useState)([]),[G,Q]=(0,t.useState)([]),[Y,ee]=(0,t.useState)({totalOrders:0,totalSpent:0,favoriteCuisine:"",averageRating:0}),[es,ei]=(0,t.useState)(!0),[ea,et]=(0,t.useState)(0);(0,t.useEffect)(()=>{d.J.loadPersistedNotifications();let e=d.J.subscribe(()=>{et(d.J.getUnreadCountSync())});return()=>{e()}},[]);let er=(0,t.useCallback)(async()=>{if(Z)try{ei(!0);let e=await o.OrdersService.getOrdersByCustomer(Z.uid),s=e.filter(e=>["pending","accepted","preparing","ready","delivering"].includes(e.status)),i=e.filter(e=>"delivered"===e.status).slice(0,5);I(s),M(i);let a=e.reduce((e,s)=>{var i;return e+(null!=(i=s.total)?i:0)},0);ee({totalOrders:e.length,totalSpent:a,favoriteCuisine:"Italiana",averageRating:4.5});let t=await o.DishesService.getAllDishes(),r=t.filter(e=>e.isAvailable).sort((e,s)=>{var i,a,t,r,l,n;let c=null!=(t=e.rating)?t:0,o=null!=(r=s.rating)?r:0;if(c!==o)return o-c;let d=null!=(l=null==(i=e.createdAt)?void 0:i.toDate())?l:new Date(0);return(null!=(n=null==(a=s.createdAt)?void 0:a.toDate())?n:new Date(0)).getTime()-d.getTime()}).slice(0,6);H(r);let l=t.filter(e=>e.isAvailable&&!r.includes(e)).slice(0,6);U(l);let n=t.filter(e=>e.isAvailable&&!r.includes(e)&&!l.includes(e)).slice(0,4);J(n);let c=await o.CooksService.getAllCooks();Q(c.slice(0,4))}catch(e){console.error("Error fetching dashboard data:",e),O.oR.error("Error al cargar el dashboard")}finally{ei(!1)}},[Z]),el=(0,t.useCallback)(()=>{if(!Z)return;let e=o.OrdersService.subscribeToCustomerOrders(Z.uid,e=>{let s=e.filter(e=>["pending","accepted","preparing","ready","delivering"].includes(e.status));I(s),s.forEach(e=>{"accepted"===e.status&&d.J.notifyOrderStatusChange(e.id,e.status,"customer")})});return()=>e()},[Z]);return((0,t.useEffect)(()=>{if(!Z)return void $.push("/login");er(),el()},[Z,$,er,el]),es)?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-moai-50 via-background to-pacific-50",children:[(0,a.jsx)("div",{className:"sticky top-0 z-50 border-b bg-gradient-moai/10 backdrop-blur-md shadow-moai-card",children:(0,a.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)(P.eu,{className:"h-10 w-10",children:[(0,a.jsx)(P.BK,{src:null!=(s=null==Z?void 0:Z.photoURL)?s:""}),(0,a.jsx)(P.q5,{children:null!=(i=null==Z||null==(e=Z.displayName)?void 0:e[0])?i:"U"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-xl font-bold text-gradient-moai animate-fade-in",children:["\xa1Hola, ",null!=(p=null==Z?void 0:Z.displayName)?p:"Cliente","!"]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Bienvenido a tu dashboard"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(E.$,{variant:"ghost",size:"sm",onClick:()=>$.push("/notifications"),className:"relative",children:[(0,a.jsx)(f.A,{className:"h-5 w-5"}),ea>0&&(0,a.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:ea})]}),(0,a.jsxs)(E.$,{variant:"ghost",size:"sm",onClick:()=>$.push("/cart"),className:"relative",children:[(0,a.jsx)(j.A,{className:"h-5 w-5"}),W>0&&(0,a.jsx)("span",{className:"absolute -top-1 -right-1 bg-primary text-primary-foreground text-xs rounded-full h-5 w-5 flex items-center justify-center",children:W})]}),(0,a.jsxs)(E.$,{variant:"outline",size:"sm",onClick:()=>$.push("/dishes"),className:"btn-moai-outline hover-lift",children:[(0,a.jsx)(N.A,{className:"h-4 w-4 mr-2"}),"Explorar"]})]})]})})}),(0,a.jsxs)("div",{className:"container mx-auto px-4 py-6",children:[(0,a.jsxs)(R.Zp,{className:"mb-6 card-moai animate-fade-in hover-lift",children:[(0,a.jsxs)(R.aR,{children:[(0,a.jsx)(R.ZB,{className:"text-gradient-moai",children:"\xbfQu\xe9 se te antoja hoy?"}),(0,a.jsx)(R.BT,{className:"text-andes-600",children:"Descubre platos incre\xedbles cerca de ti"})]}),(0,a.jsx)(R.Wu,{children:(0,a.jsx)(L.n,{compact:!0,onResultsChange:e=>{if(e.dishes.length>0){var s;$.push("/search?q=".concat(encodeURIComponent((null==(s=e.dishes[0])?void 0:s.name)||"")))}}})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6 animate-slide-in",children:[(0,a.jsx)(R.Zp,{className:"card-moai hover-lift transition-all duration-300",children:(0,a.jsx)(R.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Pedidos"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-moai-600",children:Y.totalOrders})]}),(0,a.jsx)(j.A,{className:"h-8 w-8 text-moai-400 opacity-30 animate-pulse-soft"})]})})}),(0,a.jsx)(R.Zp,{className:"card-pacific hover-lift transition-all duration-300",children:(0,a.jsx)(R.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Gastado"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-pacific-600",children:(0,B.$g)(Y.totalSpent)})]}),(0,a.jsx)(v.A,{className:"h-8 w-8 text-pacific-400 opacity-30 animate-pulse-soft"})]})})}),(0,a.jsx)(R.Zp,{className:"card-moai hover-lift transition-all duration-300",children:(0,a.jsx)(R.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Cocina Favorita"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-quillay-600",children:Y.favoriteCuisine})]}),(0,a.jsx)(y.A,{className:"h-8 w-8 text-quillay-400 opacity-30 animate-pulse-soft"})]})})}),(0,a.jsx)(R.Zp,{className:"card-pacific hover-lift transition-all duration-300",children:(0,a.jsx)(R.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Rating Promedio"}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("p",{className:"text-2xl font-bold text-andes-600",children:Y.averageRating}),(0,a.jsx)(b.A,{className:"h-5 w-5 fill-moai-400 text-moai-400"})]})]}),(0,a.jsx)(w.A,{className:"h-8 w-8 text-andes-400 opacity-30 animate-pulse-soft"})]})})})]}),F.length>0&&(0,a.jsxs)(R.Zp,{className:"mb-6 card-moai animate-fade-in",children:[(0,a.jsxs)(R.aR,{children:[(0,a.jsxs)(R.ZB,{className:"flex items-center gap-2 text-gradient-moai",children:[(0,a.jsx)(b.A,{className:"h-5 w-5 fill-moai-400 text-moai-400 animate-bounce-gentle"}),"Platos Destacados"]}),(0,a.jsx)(R.BT,{className:"text-andes-600",children:"Los mejores platos seg\xfan nuestros clientes"})]}),(0,a.jsx)(R.Wu,{children:(0,a.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:F.map(e=>{var s;return(0,a.jsxs)(R.Zp,{className:"cursor-pointer hover:shadow-hover-lift transition-all hover:scale-105 card-moai animate-fade-in",onClick:()=>$.push("/dishes/".concat(e.id)),children:[(0,a.jsxs)("div",{className:"aspect-square relative",children:[(0,a.jsx)(l.default,{src:e.image,alt:e.name,fill:!0,className:"object-cover rounded-t-lg",onError:e=>{e.currentTarget.src="https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=300&h=300&fit=crop"}}),(0,a.jsxs)(S.E,{className:"absolute top-2 left-2 bg-gradient-moai border-none text-white shadow-lg",children:[(0,a.jsx)(b.A,{className:"h-3 w-3 mr-1"}),"Destacado"]}),e.rating>4.5&&(0,a.jsx)(S.E,{className:"absolute top-2 right-2 bg-gradient-pacific border-none text-white shadow-lg",children:"Mejor Valorado"})]}),(0,a.jsxs)(R.Wu,{className:"p-3",children:[(0,a.jsx)("h3",{className:"font-semibold text-sm mb-1 line-clamp-1",children:e.name}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground mb-1 line-clamp-1",children:["Por ",e.cookerName]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mb-2 line-clamp-1",children:e.category}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"font-bold text-sm",children:(0,B.$g)(e.price)}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(b.A,{className:"h-3 w-3 fill-yellow-400 text-yellow-400"}),(0,a.jsx)("span",{className:"text-xs",children:(null==(s=e.rating)?void 0:s.toFixed(1))||"Nuevo"})]})]})]})]},e.id)})})})]}),z.length>0&&(0,a.jsxs)(R.Zp,{className:"mb-6 card-pacific animate-slide-in",children:[(0,a.jsxs)(R.aR,{children:[(0,a.jsxs)(R.ZB,{className:"flex items-center gap-2 text-gradient-pacific",children:[(0,a.jsx)(x.A,{className:"h-5 w-5 animate-pulse-soft"}),"Pedidos Activos"]}),(0,a.jsx)(R.BT,{className:"text-andes-600",children:"Seguimiento en tiempo real de tus pedidos"})]}),(0,a.jsx)(R.Wu,{children:(0,a.jsx)("div",{className:"space-y-4",children:z.map(e=>{var s,i;let t=(null==(s=K[e.status])?void 0:s.icon)||m.A,r=K[e.status];return(0,a.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(t,{className:"h-5 w-5 text-".concat(null==r?void 0:r.color,"-500")}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-semibold",children:["Pedido #",e.id.slice(-6)]}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:[(null==(i=e.dishes)?void 0:i.length)||0," items • ",(0,B.$g)(e.total)]})]})]}),(0,a.jsx)(S.E,{variant:(null==r?void 0:r.color)==="green"?"default":"secondary",children:null==r?void 0:r.label})]}),(0,a.jsx)(T.k,{value:{pending:20,accepted:40,preparing:60,ready:80,delivering:90,delivered:100}[e.status]||0,className:"mb-2"}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Tiempo estimado: 30-45 min"}),(0,a.jsxs)(E.$,{variant:"ghost",size:"sm",onClick:()=>$.push("/orders/".concat(e.id)),children:["Ver detalles",(0,a.jsx)(k.A,{className:"h-4 w-4 ml-1"})]})]})]},e.id)})})})]}),(0,a.jsxs)(D.tU,{defaultValue:"recommendations",className:"space-y-4 animate-fade-in",children:[(0,a.jsxs)(D.j7,{className:"grid w-full grid-cols-3",children:[(0,a.jsx)(D.Xi,{value:"recommendations",children:"Recomendados"}),(0,a.jsx)(D.Xi,{value:"favorites",children:"Favoritos"}),(0,a.jsx)(D.Xi,{value:"cooks",children:"Cocineros Top"})]}),(0,a.jsx)(D.av,{value:"recommendations",className:"space-y-4",children:(0,a.jsxs)(R.Zp,{className:"card-moai",children:[(0,a.jsxs)(R.aR,{children:[(0,a.jsx)(R.ZB,{className:"text-gradient-moai",children:"Recomendados para ti"}),(0,a.jsx)(R.BT,{className:"text-andes-600",children:"Basado en tus pedidos anteriores"})]}),(0,a.jsx)(R.Wu,{children:(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:V.map(e=>(0,a.jsxs)(R.Zp,{className:"cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>$.push("/dishes/".concat(e.id)),children:[(0,a.jsxs)("div",{className:"aspect-video relative",children:[(0,a.jsx)(l.default,{src:e.image,alt:e.name,fill:!0,className:"object-cover rounded-t-lg"}),e.isAvailable&&(0,a.jsx)(S.E,{className:"absolute top-2 right-2",children:"Disponible"})]}),(0,a.jsxs)(R.Wu,{className:"p-4",children:[(0,a.jsx)("h3",{className:"font-semibold mb-1",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-2 line-clamp-2",children:e.description}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"font-bold text-lg",children:(0,B.$g)(e.price)}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(b.A,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),(0,a.jsx)("span",{className:"text-sm",children:e.rating})]})]})]})]},e.id))})})]})}),(0,a.jsx)(D.av,{value:"favorites",className:"space-y-4",children:(0,a.jsxs)(R.Zp,{className:"card-pacific",children:[(0,a.jsxs)(R.aR,{children:[(0,a.jsx)(R.ZB,{className:"text-gradient-pacific",children:"Tus Favoritos"}),(0,a.jsx)(R.BT,{className:"text-andes-600",children:"Platos que has marcado como favoritos"})]}),(0,a.jsx)(R.Wu,{children:_.length>0?(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:_.map(e=>(0,a.jsxs)("div",{className:"flex gap-4 p-4 border rounded-lg hover:bg-accent cursor-pointer",onClick:()=>$.push("/dishes/".concat(e.id)),children:[(0,a.jsx)(l.default,{src:e.image,alt:e.name,width:80,height:80,className:"w-20 h-20 rounded-lg object-cover"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-semibold",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:e.category}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"font-bold",children:(0,B.$g)(e.price)}),(0,a.jsx)(E.$,{size:"sm",variant:"ghost",children:(0,a.jsx)(A.A,{className:"h-4 w-4 fill-red-500 text-red-500"})})]})]})]},e.id))}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(A.A,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:"No tienes platos favoritos a\xfan"}),(0,a.jsx)(E.$,{onClick:()=>$.push("/dishes"),children:"Explorar Platos"})]})})]})}),(0,a.jsx)(D.av,{value:"cooks",className:"space-y-4",children:(0,a.jsxs)(R.Zp,{className:"card-moai",children:[(0,a.jsxs)(R.aR,{children:[(0,a.jsx)(R.ZB,{className:"text-gradient-moai",children:"Cocineros Destacados"}),(0,a.jsx)(R.BT,{className:"text-andes-600",children:"Los mejores cocineros de tu zona"})]}),(0,a.jsx)(R.Wu,{children:(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:G.map(e=>{var s;return(0,a.jsx)(R.Zp,{className:"cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>$.push("/cooks/".concat(e.id)),children:(0,a.jsx)(R.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsxs)(P.eu,{className:"h-16 w-16",children:[(0,a.jsx)(P.BK,{src:e.avatar}),(0,a.jsx)(P.q5,{children:(0,a.jsx)(u.A,{className:"h-6 w-6"})})]}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-semibold",children:e.displayName}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:null==(s=e.specialties)?void 0:s.join(", ")}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(b.A,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),(0,a.jsx)("span",{children:e.rating})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(C.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Cerca"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(x.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[e.totalOrders," pedidos"]})]})]})]})]})})},e.id)})})})]})})]}),q.length>0&&(0,a.jsxs)(R.Zp,{className:"mt-6 card-pacific animate-slide-in",children:[(0,a.jsxs)(R.aR,{children:[(0,a.jsx)(R.ZB,{className:"text-gradient-pacific",children:"Pedidos Recientes"}),(0,a.jsx)(R.BT,{className:"text-andes-600",children:"Tu historial de pedidos"})]}),(0,a.jsxs)(R.Wu,{children:[(0,a.jsx)("div",{className:"space-y-3",children:q.map(e=>{var s;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-accent cursor-pointer",onClick:()=>$.push("/orders/".concat(e.id)),children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(h.A,{className:"h-5 w-5 text-green-500"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-medium",children:["Pedido #",e.id.slice(-6)]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:new Date(null==(s=e.createdAt)?void 0:s.toDate()).toLocaleDateString()})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("p",{className:"font-semibold",children:(0,B.$g)(e.total)}),(0,a.jsx)(E.$,{variant:"ghost",size:"sm",children:"Repetir pedido"})]})]},e.id)})}),(0,a.jsx)(E.$,{variant:"outline",className:"w-full mt-4",onClick:()=>$.push("/orders"),children:"Ver todos los pedidos"})]})]}),(0,a.jsx)(X,{maxItems:6,showCategories:!0,userId:null==Z?void 0:Z.uid}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-6 animate-fade-in",children:[(0,a.jsxs)(E.$,{variant:"outline",className:"h-24 flex-col gap-2 card-moai hover-lift btn-moai-outline",onClick:()=>$.push("/dishes"),children:[(0,a.jsx)(y.A,{className:"h-6 w-6 text-moai-500"}),(0,a.jsx)("span",{children:"Explorar Platos"})]}),(0,a.jsxs)(E.$,{variant:"outline",className:"h-24 flex-col gap-2 card-pacific hover-lift btn-moai-outline",onClick:()=>$.push("/cart"),children:[(0,a.jsx)(j.A,{className:"h-6 w-6 text-pacific-500"}),(0,a.jsx)("span",{children:"Mi Carrito"})]}),(0,a.jsxs)(E.$,{variant:"outline",className:"h-24 flex-col gap-2 card-moai hover-lift btn-moai-outline",onClick:()=>$.push("/favorites"),children:[(0,a.jsx)(A.A,{className:"h-6 w-6 text-moai-500"}),(0,a.jsx)("span",{children:"Favoritos"})]}),(0,a.jsxs)(E.$,{variant:"outline",className:"h-24 flex-col gap-2 card-pacific hover-lift btn-moai-outline",onClick:()=>$.push("/profile"),children:[(0,a.jsxs)(P.eu,{className:"h-6 w-6",children:[(0,a.jsx)(P.BK,{src:null!=(g=null==Z?void 0:Z.photoURL)?g:""}),(0,a.jsx)(P.q5,{children:"U"})]}),(0,a.jsx)("span",{children:"Mi Perfil"})]})]})]})]})}},34964:(e,s,i)=>{"use strict";i.d(s,{Xi:()=>o,av:()=>d,j7:()=>c,tU:()=>n});var a=i(95155),t=i(12115),r=i(60704),l=i(53999);let n=r.bL,c=t.forwardRef((e,s)=>{let{className:i,...t}=e;return(0,a.jsx)(r.B8,{ref:s,className:(0,l.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",i),...t})});c.displayName=r.B8.displayName;let o=t.forwardRef((e,s)=>{let{className:i,...t}=e;return(0,a.jsx)(r.l9,{ref:s,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",i),...t})});o.displayName=r.l9.displayName;let d=t.forwardRef((e,s)=>{let{className:i,...t}=e;return(0,a.jsx)(r.UC,{ref:s,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",i),...t})});d.displayName=r.UC.displayName},40942:(e,s,i)=>{Promise.resolve().then(i.bind(i,14132))},41397:(e,s,i)=>{"use strict";i.d(s,{k:()=>n});var a=i(95155),t=i(12115),r=i(55863),l=i(53999);let n=t.forwardRef((e,s)=>{let{className:i,value:t,...n}=e;return(0,a.jsx)(r.bL,{ref:s,className:(0,l.cn)("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",i),...n,children:(0,a.jsx)(r.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(t||0),"%)")}})})});n.displayName=r.bL.displayName},67503:(e,s,i)=>{"use strict";i.d(s,{J:()=>t});var a=i(56671);class t{static initialize(){this.requestPermission(),this.setupServiceWorker(),this.loadPreferences()}static async requestPermission(){if("Notification"in window){let e=await Notification.requestPermission();this.pushEnabled="granted"===e}}static setupServiceWorker(){"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(e=>{console.log("Service Worker registered:",e)}).catch(e=>{console.error("Service Worker registration failed:",e)})}static loadPreferences(){let e=localStorage.getItem("notificationPreferences");if(e){let{soundEnabled:s}=JSON.parse(e);this.soundEnabled=s}}static create(e){let s={...e,id:this.generateId(),timestamp:new Date,read:!1};return this.notifications.unshift(s),this.notifyListeners(),this.showToast(s),this.playSound(s),this.showPushNotification(s),this.persistNotifications(),s.id}static notifyOrderReceived(e,s,i){return this.create({title:"\xa1Nuevo Pedido Recibido!",message:"".concat(s," ha realizado un pedido por $").concat(i.toLocaleString("es-CL")),type:"success",priority:"high",category:"order",action:{label:"Ver Pedido",onClick:()=>window.location.href="/cooker/dashboard?order=".concat(e)},metadata:{orderId:e,customerName:s,total:i}})}static notifyOrderStatusChange(e,s,i){return this.create({title:"Estado del Pedido Actualizado",message:{accepted:"Tu pedido ha sido aceptado y est\xe1 siendo preparado",preparing:"Tu pedido est\xe1 siendo preparado",ready:"\xa1Tu pedido est\xe1 listo para recoger!",delivering:"Tu pedido est\xe1 en camino",delivered:"\xa1Tu pedido ha sido entregado!"}[s]||"Estado: ".concat(s),type:"info",priority:"medium",category:"order",metadata:{orderId:e,status:s,role:i}})}static notifyPaymentSuccess(e,s){return this.create({title:"Pago Exitoso",message:"Tu pago de $".concat(s.toLocaleString("es-CL")," ha sido procesado correctamente"),type:"success",priority:"high",category:"payment",metadata:{orderId:e,amount:s}})}static notifyPaymentFailed(e,s){return this.create({title:"Error en el Pago",message:"No se pudo procesar tu pago: ".concat(s),type:"error",priority:"high",category:"payment",action:{label:"Reintentar",onClick:()=>window.location.href="/payment/retry?order=".concat(e)},metadata:{orderId:e,reason:s}})}static notifyDriverAssigned(e,s){return this.create({title:"Repartidor Asignado",message:"".concat(s," ha sido asignado a tu pedido"),type:"info",priority:"medium",category:"delivery",metadata:{orderId:e,driverName:s}})}static notifyDeliveryUpdate(e,s){return this.create({title:"Actualizaci\xf3n de Entrega",message:s,type:"info",priority:"medium",category:"delivery",metadata:{orderId:e}})}static notifyPromotion(e,s,i){return this.create({title:e,message:"".concat(s," - ").concat(i,"% de descuento"),type:"info",priority:"low",category:"promotion",action:{label:"Ver Oferta",onClick:()=>window.location.href="/promotions"},metadata:{discount:i}})}static markAsRead(e){let s=this.notifications.find(s=>s.id===e);s&&(s.read=!0,this.notifyListeners(),this.persistNotifications())}static markAllAsRead(){this.notifications.forEach(e=>e.read=!0),this.notifyListeners(),this.persistNotifications()}static delete(e){this.notifications=this.notifications.filter(s=>s.id!==e),this.notifyListeners(),this.persistNotifications()}static clearAll(){this.notifications=[],this.notifyListeners(),this.persistNotifications()}static getUnreadCount(){return this.notifications.filter(e=>!e.read).length}static getNotifications(e){let s=this.notifications;return(null==e?void 0:e.category)&&(s=s.filter(s=>s.category===e.category)),(null==e?void 0:e.read)!==void 0&&(s=s.filter(s=>s.read===e.read)),(null==e?void 0:e.priority)&&(s=s.filter(s=>s.priority===e.priority)),s}static subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}static notifyListeners(){this.listeners.forEach(e=>e([...this.notifications]))}static persistNotifications(){try{localStorage.setItem("notifications",JSON.stringify(this.notifications))}catch(e){console.error("Error persisting notifications:",e)}}static loadPersistedNotifications(){try{let e=localStorage.getItem("notifications");e&&(this.notifications=JSON.parse(e).map(e=>({...e,timestamp:new Date(e.timestamp)})),this.notifyListeners())}catch(e){console.error("Error loading persisted notifications:",e)}}static generateId(){return"notif_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}static showToast(e){let s={duration:e.duration||("high"===e.priority?5e3:3e3),action:e.action?{label:e.action.label,onClick:e.action.onClick}:void 0};switch(e.type){case"success":a.oR.success(e.title,{description:e.message,...s});break;case"error":a.oR.error(e.title,{description:e.message,...s});break;case"warning":a.oR.warning(e.title,{description:e.message,...s});break;default:a.oR.info(e.title,{description:e.message,...s})}}static playSound(e){if(this.soundEnabled&&"low"!==e.priority)try{let e=new Audio("/sounds/notification.mp3");e.volume=.3,e.play().catch(e=>{console.warn("Could not play notification sound:",e)})}catch(e){console.warn("Error playing notification sound:",e)}}static showPushNotification(e){this.pushEnabled&&"low"!==e.priority&&"Notification"in window&&"granted"===Notification.permission&&new Notification(e.title,{body:e.message,icon:"/icon-192x192.png",badge:"/icon-96x96.png",tag:e.id,requireInteraction:"high"===e.priority})}static setSoundEnabled(e){this.soundEnabled=e,localStorage.setItem("notificationPreferences",JSON.stringify({soundEnabled:e}))}static isSoundEnabled(){return this.soundEnabled}static setPushEnabled(e){this.pushEnabled=e,e&&this.requestPermission()}static isPushEnabled(){return this.pushEnabled}static cleanup(){let e=new Date;e.setDate(e.getDate()-7),this.notifications=this.notifications.filter(s=>s.timestamp>e||"high"===s.priority),this.notifyListeners(),this.persistNotifications()}static getMetrics(){let e=this.notifications.length;return{total:e,unread:this.getUnreadCount(),byCategory:this.notifications.reduce((e,s)=>(e[s.category]=(e[s.category]||0)+1,e),{})}}}t.notifications=[],t.listeners=new Set,t.soundEnabled=!0,t.pushEnabled=!1}},e=>{e.O(0,[9135,3965,6331,2670,6671,1492,8250,8034,3143,4201,9980,231,2154,6751,8275,2104,4042,8441,5964,7358],()=>e(e.s=40942)),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4520],{6654:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useMergedRef",{enumerable:!0,get:function(){return n}});let r=a(12115);function n(e,t){let a=(0,r.useRef)(null),n=(0,r.useRef)(null);return(0,r.useCallback)(r=>{if(null===r){let e=a.current;e&&(a.current=null,e());let t=n.current;t&&(n.current=null,t())}else e&&(a.current=o(e,r)),t&&(n.current=o(t,r))},[e,t])}function o(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let a=e(t);return"function"==typeof a?a:()=>e(null)}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},19946:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var r=a(12115);let n=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},o=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()};var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,r.forwardRef)((e,t)=>{let{color:a="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:c="",children:d,iconNode:u,...m}=e;return(0,r.createElement)("svg",{ref:t,...s,width:n,height:n,stroke:a,strokeWidth:l?24*Number(i)/Number(n):i,className:o("lucide",c),...!d&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(m)&&{"aria-hidden":"true"},...m},[...u.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(d)?d:[d]])}),l=(e,t)=>{let a=(0,r.forwardRef)((a,s)=>{let{className:l,...c}=a;return(0,r.createElement)(i,{ref:s,iconNode:t,className:o("lucide-".concat(n(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),l),...c})});return a.displayName=n(e),a}},25731:(e,t,a)=>{"use strict";a.d(t,{A:()=>d,AuthProvider:()=>c});var r=a(95155),n=a(12115),o=a(66579),s=a(45404),i=a(35317);let l=(0,n.createContext)({user:null,role:null,loading:!0,logout:async()=>{}}),c=e=>{let{children:t}=e,[a,c]=(0,n.useState)(null),[d,u]=(0,n.useState)(null),[m,h]=(0,n.useState)(!0);(0,n.useEffect)(()=>{let e=(0,s.hg)(o.j,async e=>{try{if(e){c(e);let t="admin@moai.com"===e.email||"admin"===e.uid||e.email&&e.email.includes("admin"),a=(0,i.doc)(o.db,"users",e.uid),r=await (0,i.getDoc)(a),n=0,s=t?2:5;for(;!r.exists()&&n<s;){let t=Math.min(500*Math.pow(2,n),8e3);console.log("AuthContext: Retrying user document fetch (".concat(n+1,"/").concat(s,") after ").concat(t,"ms for ").concat(e.email)),await new Promise(e=>setTimeout(e,t)),r=await (0,i.getDoc)(a),n++}if(r.exists()){let n=r.data().role;t&&"Admin"!==n&&(n="Admin",await (0,i.BN)(a,{role:"Admin"},{merge:!0})),u(n),console.log("AuthContext: User ".concat(e.email," has role: ").concat(n))}else if(t)await (0,i.BN)(a,{role:"Admin"},{merge:!0}),u("Admin"),console.log("AuthContext: Created Admin role for ".concat(e.email));else{console.warn("AuthContext: User ".concat(e.email," document not found after ").concat(n," retries. This may indicate a network issue or missing registration.")),setTimeout(()=>{u(null),console.log("AuthContext: Set role to null for ".concat(e.email," after extended wait"))},2e3);return}}else c(null),u(null)}catch(t){console.error("Auth state change error:",t),e?(c(e),u("admin@moai.com"===e.email||"admin"===e.uid||e.email&&e.email.includes("admin")?"Admin":null)):(c(null),u(null))}finally{h(!1)}});return()=>e()},[]);let f=async()=>{try{await (0,s.CI)(o.j);try{await fetch("/api/auth/logout",{method:"POST"})}catch(e){console.warn("API logout failed, but Firebase logout succeeded:",e)}}catch(e){console.error("Error signing out:",e)}};return(0,r.jsx)(l.Provider,{value:{user:a,role:d,loading:m,logout:f},children:t})},d=()=>(0,n.useContext)(l)},51154:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(19946).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},53999:(e,t,a)=>{"use strict";a.d(t,{$B:()=>m,$g:()=>s,Dm:()=>c,HM:()=>l,bC:()=>u,cn:()=>o,generateDeliveryCode:()=>i,uA:()=>d});var r=a(52596),n=a(39688);function o(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.QP)((0,r.$)(t))}function s(e){return"$".concat(Math.round(e).toLocaleString("es-CL"))}function i(){return Math.floor(1e3+9e3*Math.random()).toString()}function l(e){return e.replace(/(\d{2})(\d{2})/,"$1-$2")}function c(e){let t=0;return e.forEach(e=>{let a=function(e){var t,a;let r=e.toLowerCase();return r.includes("hour")?60*parseFloat((null==(t=r.match(/(\d+(?:\.\d+)?)/))?void 0:t[1])||"1"):r.includes("min")?parseInt((null==(a=r.match(/(\d+)/))?void 0:a[1])||"30"):30}(e.prepTime);a>t&&(t=a)}),t}function d(e,t){return Math.min(Math.max((new Date().getTime()-e.getTime())/6e4/t*100,0),100)}function u(e,t){let a=new Date(e);return a.setMinutes(a.getMinutes()+t),a}function m(e,t){let a=new Date,r=u(e,t).getTime()-a.getTime();if(r<=0)return"Listo";let n=Math.ceil(r/6e4);if(n<60)return"".concat(n," min");{let e=Math.floor(n/60);return"".concat(e,"h ").concat(n%60,"m")}}},63655:(e,t,a)=>{"use strict";a.d(t,{hO:()=>l,sG:()=>i});var r=a(12115),n=a(47650),o=a(99708),s=a(95155),i=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let a=(0,o.TL)(`Primitive.${t}`),n=r.forwardRef((e,r)=>{let{asChild:n,...o}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,s.jsx)(n?a:t,{...o,ref:r})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function l(e,t){e&&n.flushSync(()=>e.dispatchEvent(t))}},66579:(e,t,a)=>{"use strict";let r;a.d(t,{db:()=>l,j:()=>i,y:()=>r});var n=a(23915),o=a(45404),s=a(35317);r=(0,n.Dk)().length?(0,n.Dk)()[0]:(0,n.Wp)({apiKey:"AIzaSyBptLm3y63BDBH9Xgt_UY40ZjsgUvMOKGI",authDomain:"hometaste-tlpog.firebaseapp.com",projectId:"hometaste-tlpog",storageBucket:"hometaste-tlpog.firebasestorage.app",messagingSenderId:"72297856520",appId:"1:72297856520:web:c7d851e4c00c67ec419bbd"});let i=(0,o.xI)(r),l=(0,s.aU)(r)},78007:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>y});var r=a(95155),n=a(12115),o=a(35695),s=a(45404),i=a(66579),l=a(25731),c=a(97168),d=a(89852),u=a(82714),m=a(56671),h=a(51154),f=a(28883),v=a(32919),x=a(78749),p=a(92657),b=a(6874),g=a.n(b);let w=e=>{switch(e.code){case"auth/user-not-found":return"No se encontr\xf3 una cuenta con este correo.";case"auth/wrong-password":return"Contrase\xf1a incorrecta. Por favor, intenta de nuevo.";case"auth/invalid-email":return"Por favor, ingresa un correo electr\xf3nico v\xe1lido.";case"auth/user-disabled":return"Esta cuenta ha sido deshabilitada. Por favor, contacta soporte.";case"auth/too-many-requests":return"Demasiados intentos fallidos. Por favor, intenta m\xe1s tarde.";case"auth/network-request-failed":return"Error de red. Por favor, verifica tu conexi\xf3n e intenta de nuevo.";case"auth/popup-closed-by-user":return"El inicio de sesi\xf3n fue cancelado.";case"auth/popup-blocked":return"La ventana emergente fue bloqueada. Por favor, permite las ventanas emergentes e intenta de nuevo.";default:return"Ocurri\xf3 un error durante el inicio de sesi\xf3n. Por favor, intenta de nuevo."}};function j(){let[e,t]=(0,n.useState)(""),[a,b]=(0,n.useState)(""),[j,y]=(0,n.useState)(!1),[N,A]=(0,n.useState)(!1),[C,k]=(0,n.useState)(!1),[P,S]=(0,n.useState)(""),M=(0,o.useRouter)(),_=(0,o.useSearchParams)().get("returnUrl")||"/",E=null;try{let e=(0,l.A)();E=null==e?void 0:e.user}catch(e){console.error("Auth context error:",e)}if((0,n.useEffect)(()=>{E&&M.push(_)},[E,M,_]),E)return(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-atacama-orange mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-atacama-brown/70",children:"Redirigiendo..."})]})});let O=async t=>{t.preventDefault(),y(!0),S("");try{await (0,s.x9)(i.j,e,a),m.oR.success("\xa1Bienvenido de vuelta! Has iniciado sesi\xf3n exitosamente.")}catch(t){let e=t instanceof Error&&"code"in t?w(t):"Ocurri\xf3 un error inesperado. Por favor, intenta de nuevo.";S(e),m.oR.error(e)}finally{y(!1)}},R=async()=>{S(""),A(!0);try{let e=new s.HF;e.setCustomParameters({prompt:"select_account"}),await (0,s.df)(i.j,e),m.oR.success("\xa1Bienvenido de vuelta! Has iniciado sesi\xf3n con Google exitosamente.")}catch(t){let e=t instanceof Error&&"code"in t?w(t):"Ocurri\xf3 un error inesperado. Por favor, intenta de nuevo.";S(e),m.oR.error(e)}finally{A(!1)}};return(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center p-4",children:(0,r.jsx)("div",{className:"w-full max-w-md space-y-6",children:(0,r.jsxs)("div",{className:"rounded-lg bg-white/95 backdrop-blur-sm p-8 shadow-2xl border-2 border-atacama-beige/20",children:[(0,r.jsxs)("div",{className:"text-center space-y-2",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-atacama-brown",children:"Bienvenido de Vuelta"}),(0,r.jsx)("p",{className:"text-atacama-brown/70",children:"Inicia sesi\xf3n en tu cuenta para continuar tu viaje culinario."})]}),(0,r.jsxs)("div",{className:"space-y-6 mt-6",children:[(0,r.jsxs)(c.$,{variant:"outline",className:"w-full h-11 font-medium border-2 border-atacama-beige/30 hover:bg-atacama-beige/10 hover:border-atacama-orange/30 transition-colors",onClick:R,disabled:j||N,children:[N?(0,r.jsx)(h.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,r.jsx)("div",{className:"mr-2 w-4 h-4 bg-gradient-to-r from-atacama-orange via-atacama-brown to-atacama-beige rounded-sm flex items-center justify-center text-white text-xs font-bold",children:"G"}),"Continuar con Google"]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,r.jsx)("span",{className:"w-full border-t border-atacama-beige/40"})}),(0,r.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,r.jsx)("span",{className:"bg-white px-4 text-atacama-brown/70 font-medium",children:"O inicia sesi\xf3n con email"})})]}),(0,r.jsxs)("form",{onSubmit:O,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(u.J,{htmlFor:"email",className:"text-sm font-medium text-atacama-brown",children:"Direcci\xf3n de Email"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(f.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-atacama-brown/60"}),(0,r.jsx)(d.p,{id:"email",type:"email",value:e,onChange:e=>t(e.target.value),placeholder:"name@example.com",className:"pl-10 h-11 border-atacama-beige/40 focus-visible:ring-atacama-orange focus-visible:border-atacama-orange",autoComplete:"email",disabled:j||N,required:!0})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(u.J,{htmlFor:"password",className:"text-sm font-medium text-atacama-brown",children:"Contrase\xf1a"}),(0,r.jsx)("button",{type:"button",className:"text-sm text-atacama-orange hover:text-atacama-orange/80 font-medium transition-colors",onClick:()=>m.oR.info("\xa1La funci\xf3n de restablecimiento de contrase\xf1a est\xe1 en desarrollo!"),children:"\xbfOlvidaste tu contrase\xf1a?"})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(v.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-atacama-brown/60"}),(0,r.jsx)(d.p,{id:"password",type:C?"text":"password",value:a,onChange:e=>b(e.target.value),placeholder:"Ingresa tu contrase\xf1a",className:"pl-10 pr-10 h-11 border-atacama-beige/40 focus-visible:ring-atacama-orange focus-visible:border-atacama-orange",autoComplete:"current-password",disabled:j||N,required:!0}),(0,r.jsx)("button",{type:"button",onClick:()=>k(!C),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-atacama-brown/60 hover:text-atacama-brown transition-colors","aria-label":C?"Ocultar contrase\xf1a":"Mostrar contrase\xf1a",disabled:j||N,children:C?(0,r.jsx)(x.A,{className:"h-4 w-4"}):(0,r.jsx)(p.A,{className:"h-4 w-4"})})]})]}),P&&(0,r.jsx)("div",{className:"p-3 bg-destructive/10 border border-destructive/20 rounded-md",children:(0,r.jsx)("p",{className:"text-sm text-destructive text-center font-medium",children:P})}),(0,r.jsx)(c.$,{type:"submit",className:"w-full h-11 font-semibold bg-atacama-orange hover:bg-atacama-orange/90 text-white",disabled:j||N||!e||!a,children:j?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(h.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Iniciando sesi\xf3n..."]}):"Iniciar Sesi\xf3n"})]}),(0,r.jsxs)("p",{className:"text-center text-sm text-atacama-brown/70",children:["\xbfNo tienes una cuenta?"," ",(0,r.jsx)(g(),{href:"/signup",className:"text-atacama-orange hover:text-atacama-orange/80 font-medium transition-colors",children:"Reg\xedstrate"})]})]})]})})})}function y(){return(0,r.jsx)(n.Suspense,{fallback:(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-atacama-orange mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-atacama-brown/70",children:"Cargando..."})]})}),children:(0,r.jsx)(j,{})})}},82714:(e,t,a)=>{"use strict";a.d(t,{J:()=>s});var r=a(95155);a(12115);var n=a(40968),o=a(53999);function s(e){let{className:t,...a}=e;return(0,r.jsx)(n.b,{"data-slot":"label",className:(0,o.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...a})}},86507:(e,t,a)=>{Promise.resolve().then(a.bind(a,78007))},89852:(e,t,a)=>{"use strict";a.d(t,{p:()=>o});var r=a(95155);a(12115);var n=a(53999);function o(e){let{className:t,type:a,...o}=e;return(0,r.jsx)("input",{type:a,"data-slot":"input",className:(0,n.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...o})}},97168:(e,t,a)=>{"use strict";a.d(t,{$:()=>d});var r=a(95155),n=a(12115),o=a(99708),s=a(74466),i=a(38274),l=a(53999);let c=(0,s.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-xl text-sm font-semibold transition-all duration-300 transform hover:scale-105 active:scale-95 disabled:pointer-events-none disabled:opacity-50 disabled:hover:scale-100 disabled:active:scale-100 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:ring-2 focus-visible:ring-offset-2 relative overflow-hidden group",{variants:{variant:{default:"bg-gradient-to-r from-moai-500 to-moai-600 text-white shadow-lg hover:shadow-xl hover:shadow-moai-500/25 border-0 hover:from-moai-600 hover:to-moai-700",destructive:"bg-gradient-to-r from-red-500 to-red-600 text-white shadow-lg hover:shadow-xl hover:shadow-red-500/25 hover:from-red-600 hover:to-red-700",outline:"border-2 border-moai-200 bg-background/80 backdrop-blur-sm shadow-sm hover:bg-moai-50 hover:text-moai-700 hover:border-moai-300 hover:shadow-md",secondary:"bg-gradient-to-r from-pacific-500 to-pacific-600 text-white shadow-lg hover:shadow-xl hover:shadow-pacific-500/25 hover:from-pacific-600 hover:to-pacific-700",ghost:"hover:bg-moai-50/80 hover:text-moai-700 hover:backdrop-blur-sm",link:"text-moai-600 underline-offset-4 hover:underline hover:text-moai-700 p-0 h-auto shadow-none hover:shadow-none",glass:"bg-white/10 backdrop-blur-md border border-white/20 text-white shadow-lg hover:bg-white/20 hover:shadow-xl",premium:"bg-gradient-to-r from-amber-400 via-orange-500 to-red-500 text-white shadow-lg hover:shadow-xl hover:shadow-orange-500/30 hover:from-amber-500 hover:via-orange-600 hover:to-red-600"},size:{default:"h-11 px-6 py-2",sm:"h-9 rounded-lg gap-1.5 px-4 text-xs",lg:"h-12 rounded-xl px-8 text-base",xl:"h-14 rounded-xl px-10 text-lg",icon:"size-11"}},defaultVariants:{variant:"default",size:"default"}}),d=n.forwardRef((e,t)=>{let{className:a,variant:n,size:s,asChild:d=!1,loading:u=!1,icon:m,glow:h=!1,children:f,...v}=e,x=d?o.DX:"button";return(0,r.jsxs)(x,{className:(0,l.cn)(c({variant:n,size:s,className:a})),ref:t,disabled:u||v.disabled,...v,children:[(0,r.jsx)("div",{className:"absolute inset-0 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 bg-gradient-to-r from-transparent via-white/20 to-transparent"}),h&&(0,r.jsx)("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-moai-500/20 to-pacific-500/20 blur-xl group-hover:blur-2xl transition-all duration-300 opacity-0 group-hover:opacity-100"}),u&&(0,r.jsx)(i.P.div,{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),m&&!u&&(0,r.jsx)(i.P.div,{whileHover:{scale:1.1},transition:{type:"spring",stiffness:400,damping:10},children:m}),(0,r.jsx)("span",{className:"relative z-10 flex items-center gap-2",children:f})]})});d.displayName="Button"}},e=>{e.O(0,[9135,3965,6331,2670,6671,4265,8441,5964,7358],()=>e(e.s=86507)),_N_E=e.O()}]);
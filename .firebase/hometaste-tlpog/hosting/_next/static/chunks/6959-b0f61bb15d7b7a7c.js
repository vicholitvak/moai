"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6959],{86959:(e,t,i)=>{i.d(t,{h:()=>r});class r{static getTimeOfDay(){let e=new Date().getHours();return e>=6&&e<11?"desayuno":e>=11&&e<16?"almuerzo":e>=16&&e<23?"cena":"baj\xf3n"}static getTimeBasedCategories(e){return({desayuno:["Desayuno","Para Tomar","Saludable","Vegana"],almuerzo:["Italiana","Mexicana","Americana","China","Saludable"],cena:["Francesa","Italiana","Japonesa","Mediterr\xe1nea","India"],bajón:["Acompa\xf1amientos","Para Tomar","Americana","Mexicana"]})[e]||[]}static calculatePopularityScore(e){let t=20*e.rating;return Math.round(t+Math.min(2*e.reviewCount,40)+40*Math.random())}static calculateTrendingScore(e){return Math.round(100*Math.random()+20*(e.rating>=4.5)+30*!!this.isDishNew(e))}static isDishNew(e){return e.createdAt?(new Date().getTime()-e.createdAt.toDate().getTime())/864e5<=7:.1>Math.random()}static isPremiumDish(e){return e.price>15e3&&e.rating>=4.5}static isQuickBite(e){return("string"==typeof e.prepTime?parseInt(e.prepTime.replace(/\D/g,"")):e.prepTime)<=20}static filterByTimeOfDay(e,t){let i=this.getTimeBasedCategories(t);return e.filter(e=>!!i.includes(e.category)||(({desayuno:["desayuno","morning","caf\xe9","breakfast"],almuerzo:["almuerzo","lunch","completo","main"],cena:["cena","dinner","evening","elegant"],bajón:["snack","late","quick","comfort"]})[t]||[]).some(t=>{var i;return(null==(i=e.tags)?void 0:i.some(e=>e.toLowerCase().includes(t.toLowerCase())))||e.name.toLowerCase().includes(t.toLowerCase())||e.description.toLowerCase().includes(t.toLowerCase())}))}static generateRecommendations(e,t){let i=e.filter(e=>e.isAvailable),r=this.filterByTimeOfDay(i,t.timeOfDay),a=i.map(e=>({...e,popularityScore:this.calculatePopularityScore(e),trendingScore:this.calculateTrendingScore(e),isNew:this.isDishNew(e),isPremium:this.isPremiumDish(e),isQuickBite:this.isQuickBite(e)})),o=r.filter(e=>e.rating>=4).sort((e,t)=>{let i=100*e.rating+e.reviewCount;return 100*t.rating+t.reviewCount-i}).slice(0,6),s=a.sort((e,t)=>t.trendingScore-e.trendingScore).slice(0,8),n=a.sort((e,t)=>t.popularityScore-e.popularityScore).slice(0,8),c=i.filter(e=>.3>Math.random()).sort((e,t)=>t.rating-e.rating).slice(0,6),l=r.filter(e=>t.userPreferences?t.userPreferences.some(t=>{var i;return e.category.toLowerCase().includes(t.toLowerCase())||(null==(i=e.tags)?void 0:i.some(e=>e.toLowerCase().includes(t.toLowerCase())))}):e.rating>=4.2).sort((e,t)=>t.rating-e.rating).slice(0,6),u=a.filter(e=>e.isNew).sort((e,t)=>t.rating-e.rating).slice(0,6),d=a.filter(e=>e.isQuickBite).sort((e,t)=>("string"==typeof e.prepTime?parseInt(e.prepTime.replace(/\D/g,"")):e.prepTime)-("string"==typeof t.prepTime?parseInt(t.prepTime.replace(/\D/g,"")):t.prepTime)).slice(0,6),g=a.filter(e=>e.isPremium).sort((e,t)=>t.price-e.price).slice(0,6);return{featured:o.slice(0,6),trending:s.slice(0,8),popular:n.slice(0,8),nearYou:c.slice(0,6),forYou:l.slice(0,6),newAndExciting:u.slice(0,6),quickBites:d.slice(0,6),premiumPicks:g.slice(0,6)}}static getRecommendationSections(e){return[{key:"featured",title:"Destacados para Ti",subtitle:"Los mejores platos seleccionados",icon:"⭐",priority:1},{key:"trending",title:"Tendencia Ahora",subtitle:"Lo que est\xe1 pidiendo todo el mundo",icon:"\uD83D\uDD25",priority:2},{key:"popular",title:"M\xe1s Populares",subtitle:"Los favoritos de nuestros usuarios",icon:"❤️",priority:3},...{desayuno:[{key:"quickBites",title:"Desayuno R\xe1pido",subtitle:"Para empezar el d\xeda sin demora",icon:"⚡",priority:2}],almuerzo:[{key:"forYou",title:"Almuerzos",subtitle:"Comidas completas y nutritivas",icon:"\uD83C\uDF7D️",priority:2}],cena:[{key:"premiumPicks",title:"Cena Premium",subtitle:"Experiencias culinarias especiales",icon:"\uD83D\uDC51",priority:2},{key:"forYou",title:"Ideal para tu Cena",subtitle:"Sabores perfectos para cerrar el d\xeda",icon:"\uD83C\uDF19",priority:3}],bajón:[{key:"quickBites",title:"Baj\xf3n Nocturno",subtitle:"Antojos que llegan de madrugada",icon:"\uD83C\uDF19",priority:2},{key:"forYou",title:"Comfort Food",subtitle:"Para esas ganas de comer algo rico",icon:"\uD83E\uDD24",priority:3}]}[e]||[],{key:"nearYou",title:"Cerca de Ti",subtitle:"Entrega m\xe1s r\xe1pida",icon:"\uD83D\uDCCD",priority:5},{key:"newAndExciting",title:"Nuevo",subtitle:"Descubre sabores \xfanicos",icon:"✨",priority:6}].sort((e,t)=>e.priority-t.priority)}static getDishCounts(e){let t={All:e.length};return e.forEach(e=>{e.category&&(t[e.category]=(t[e.category]||0)+1)}),t}static async getDishRecommendations(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;try{let{collection:o,getDocs:s,query:n,orderBy:c,limit:l,where:u}=await Promise.resolve().then(i.bind(i,35317)),{db:d}=await Promise.resolve().then(i.bind(i,66579)),{doc:g,getDoc:m}=await Promise.resolve().then(i.bind(i,35317)),p=await m(g(d,"users",e)),y=p.exists()?p.data():null,h=n(o(d,"dishes"),u("isAvailable","==",!0),c("rating","desc"),l(2*t)),f=(await s(h)).docs.map(e=>({id:e.id,...e.data()})),v=[];for(let e of f.slice(0,t)){var r,a;let t=20*(e.rating||0),i="similar",o=["Recomendado para ti"];(null==y||null==(r=y.favoriteCategories)?void 0:r.includes(e.category))&&(t+=30,i="category",o=["Te gusta la cocina ".concat(e.category.toLowerCase())]),(null==y||null==(a=y.favoriteCooks)?void 0:a.includes(e.cookerId))&&(t+=25,i="cook",o=["De uno de tus cocineros favoritos"]);let s=this.getTimeOfDay();this.getTimeBasedCategories(s).includes(e.category)&&(t+=15,o.push("Perfecto para ".concat(s))),e.reviewCount>20&&e.rating>=4.5&&(i="trending",o=["Muy popular esta semana"],t+=20),v.push({dishId:e.id,score:Math.min(t,100),matchType:i,reasons:o,confidence:t>80?.9:t>60?.8:.7})}return v.sort((e,t)=>t.score-e.score).slice(0,t)}catch(e){return console.error("Error getting dish recommendations:",e),[]}}static async getCookRecommendations(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;try{let{collection:s,getDocs:n,query:c,orderBy:l,limit:u,where:d}=await Promise.resolve().then(i.bind(i,35317)),{db:g}=await Promise.resolve().then(i.bind(i,66579)),{doc:m,getDoc:p}=await Promise.resolve().then(i.bind(i,35317)),y=await p(m(g,"users",e)),h=y.exists()?y.data():null,f=c(s(g,"cooks"),d("isActive","==",!0),l("rating","desc"),u(2*t)),v=(await n(f)).docs.map(e=>({id:e.id,...e.data()})),k=[];for(let e of v.slice(0,t)){var r,a,o;let t=18*(e.rating||0),i="similar",s=["Recomendado para ti"];if((null==h||null==(r=h.favoriteCooks)?void 0:r.includes(e.id))&&(t+=35,i="cook",s=["Uno de tus cocineros favoritos"]),(null==h?void 0:h.favoriteCategories)&&e.specialties){let r=e.specialties.filter(e=>h.favoriteCategories.includes(e));r.length>0&&(t+=25,i="category",s=["Especialista en ".concat(r[0].toLowerCase())])}e.rating>=4.7&&e.reviewCount>=20&&(t+=20,i="trending",s=["Cocinero muy valorado"]),(null==(a=e.settings)?void 0:a.selfDelivery)&&(null==h||null==(o=h.preferences)?void 0:o.selfDelivery)&&(t+=10,s.push("Entrega directa disponible")),k.push({cookId:e.id,score:Math.min(t,100),matchType:i,reasons:s,confidence:t>80?.9:t>70?.8:.75})}return k.sort((e,t)=>t.score-e.score).slice(0,t)}catch(e){return console.error("Error getting cook recommendations:",e),[]}}static async getRecommendationInsights(e){try{let{collection:t,getDocs:r,query:a,where:o,orderBy:s,limit:n}=await Promise.resolve().then(i.bind(i,35317)),{db:c}=await Promise.resolve().then(i.bind(i,66579)),l=a(t(c,"orders"),o("userId","==",e),o("status","==","delivered"),s("createdAt","desc"),n(50)),u=(await r(l)).docs.map(e=>e.data());if(0===u.length)return{topCategories:[],topIngredients:[],averageOrderValue:0,preferredCooks:[],totalOrders:0,averageRating:0};let d={},g={},m=0,p=0,y=0;for(let e of u){if(m+=e.total||0,e.items)for(let t of e.items)t.category&&(d[t.category]=(d[t.category]||0)+1),t.cookerId&&(g[t.cookerId]=(g[t.cookerId]||0)+1);e.rating&&(y+=e.rating,p++)}let h=Object.entries(d).sort((e,t)=>t[1]-e[1]).slice(0,5).map(e=>{let[t]=e;return t}),f=Object.entries(g).sort((e,t)=>t[1]-e[1]).slice(0,3).map(e=>{let[t]=e;return t});return{topCategories:h,topIngredients:[],averageOrderValue:u.length>0?Math.round(m/u.length):0,preferredCooks:f,totalOrders:u.length,averageRating:p>0?y/p:0}}catch(e){return console.error("Error getting recommendation insights:",e),{topCategories:[],topIngredients:[],averageOrderValue:0,preferredCooks:[],totalOrders:0,averageRating:0}}}}}}]);
(()=>{var a={};a.id=9946,a.ids=[8413,9946],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},8086:a=>{"use strict";a.exports=require("module")},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},16141:a=>{"use strict";a.exports=require("node:zlib")},18413:(a,b,c)=>{"use strict";c.r(b),c.d(b,{DeliveryTrackingService:()=>f});var d=c(56525),e=c(75535);class f{static{this.collection="deliveryTracking"}static async updateDeliveryTracking(a){try{let b=(0,e.doc)(d.db,this.collection,a.orderId);return await (0,e.BN)(b,{...a,lastUpdated:e.Dc.now()},{merge:!0}),!0}catch(a){return console.error("Error updating delivery tracking:",a),!1}}static subscribeToDeliveryTracking(a,b){let c=(0,e.doc)(d.db,this.collection,a);return(0,e.aQ)(c,a=>{a.exists()?b({orderId:a.id,...a.data()}):b(null)},a=>{console.error("Error subscribing to delivery tracking:",a),b(null)})}static async updateDriverLocation(a,b){try{let c=(0,e.doc)(d.db,this.collection,a);return await (0,e.mZ)(c,{currentLocation:{...b,timestamp:e.Dc.now()},lastUpdated:e.Dc.now()}),!0}catch(a){return console.error("Error updating driver location:",a),!1}}static async updateETA(a,b){try{let c=(0,e.doc)(d.db,this.collection,a),f={lastUpdated:e.Dc.now()};return b.pickup&&(f.estimatedPickupTime=b.pickup),b.delivery&&(f.estimatedDeliveryTime=b.delivery),b.total&&(f.totalEstimatedTime=b.total),await (0,e.mZ)(c,f),!0}catch(a){return console.error("Error updating ETA:",a),!1}}static async updateDeliveryStep(a,b){try{let c=(0,e.doc)(d.db,this.collection,a);return await (0,e.mZ)(c,{currentStep:b,lastUpdated:e.Dc.now()}),!0}catch(a){return console.error("Error updating delivery step:",a),!1}}static async completeDelivery(a){try{let b=(0,e.doc)(d.db,this.collection,a);return await (0,e.mZ)(b,{currentStep:"delivered",lastUpdated:e.Dc.now()}),!0}catch(a){return console.error("Error completing delivery:",a),!1}}static getCurrentLocation(){return new Promise((a,b)=>{if(!navigator.geolocation)return void b(Error("Geolocation not supported"));navigator.geolocation.getCurrentPosition(b=>{a({lat:b.coords.latitude,lng:b.coords.longitude})},a=>b(a),{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e4})})}static calculateDistance(a,b,c,d){let e=(c-a)*Math.PI/180,f=(d-b)*Math.PI/180,g=Math.sin(e/2)*Math.sin(e/2)+Math.cos(a*Math.PI/180)*Math.cos(c*Math.PI/180)*Math.sin(f/2)*Math.sin(f/2);return 2*Math.atan2(Math.sqrt(g),Math.sqrt(1-g))*6371}static startLocationTracking(a,b,c,d){let e=null,f=0,g=async()=>{try{let b=await this.getCurrentLocation(),c=Date.now();c-f>1e4&&(await this.updateDriverLocation(a,b),f=c),d?.(b)}catch(a){console.error("Error updating location:",a)}};return navigator.geolocation&&(e=navigator.geolocation.watchPosition(()=>g(),a=>console.error("Geolocation error:",a),{enableHighAccuracy:!0,timeout:1e4,maximumAge:5e3})),g(),{stop:()=>{null!==e&&navigator.geolocation.clearWatch(e)}}}}},19063:a=>{"use strict";a.exports=require("require-in-the-middle")},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19771:a=>{"use strict";a.exports=require("process")},21820:a=>{"use strict";a.exports=require("os")},25334:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(62688).A)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},26713:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/is-bot")},27910:a=>{"use strict";a.exports=require("stream")},28354:a=>{"use strict";a.exports=require("util")},28947:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(62688).A)("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},29021:a=>{"use strict";a.exports=require("fs")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},31421:a=>{"use strict";a.exports=require("node:child_process")},33873:a=>{"use strict";a.exports=require("path")},34631:a=>{"use strict";a.exports=require("tls")},36686:a=>{"use strict";a.exports=require("diagnostics_channel")},37067:a=>{"use strict";a.exports=require("node:http")},37366:a=>{"use strict";a.exports=require("dns")},37826:(a,b,c)=>{"use strict";c.d(b,{Cf:()=>l,Es:()=>n,L3:()=>o,c7:()=>m,lG:()=>h,rr:()=>p,zM:()=>i});var d=c(60687);c(43210);var e=c(26134),f=c(11860),g=c(96241);function h({...a}){return(0,d.jsx)(e.bL,{"data-slot":"dialog",...a})}function i({...a}){return(0,d.jsx)(e.l9,{"data-slot":"dialog-trigger",...a})}function j({...a}){return(0,d.jsx)(e.ZL,{"data-slot":"dialog-portal",...a})}function k({className:a,...b}){return(0,d.jsx)(e.hJ,{"data-slot":"dialog-overlay",className:(0,g.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80",a),...b})}function l({className:a,children:b,showCloseButton:c=!0,...h}){return(0,d.jsxs)(j,{"data-slot":"dialog-portal",children:[(0,d.jsx)(k,{}),(0,d.jsxs)(e.UC,{"data-slot":"dialog-content",className:(0,g.cn)("bg-white data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",a),...h,children:[b,c&&(0,d.jsxs)(e.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,d.jsx)(f.A,{}),(0,d.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function m({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"dialog-header",className:(0,g.cn)("flex flex-col gap-2 text-center sm:text-left",a),...b})}function n({className:a,...b}){return(0,d.jsx)("div",{"data-slot":"dialog-footer",className:(0,g.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),...b})}function o({className:a,...b}){return(0,d.jsx)(e.hE,{"data-slot":"dialog-title",className:(0,g.cn)("text-lg leading-none font-semibold",a),...b})}function p({className:a,...b}){return(0,d.jsx)(e.VY,{"data-slot":"dialog-description",className:(0,g.cn)("text-muted-foreground text-sm",a),...b})}},39390:(a,b,c)=>{"use strict";c.d(b,{J:()=>g});var d=c(60687);c(43210);var e=c(78148),f=c(96241);function g({className:a,...b}){return(0,d.jsx)(e.b,{"data-slot":"label",className:(0,f.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",a),...b})}},40981:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>az});var d=c(60687),e=c(43210),f=c(16189),g=c(21295),h=c(87675),i=c(52581),j=c(24934),k=c(68988),l=c(39390),m=c(55192),n=c(63974),o=c(62688);let p=(0,o.A)("bike",[["circle",{cx:"18.5",cy:"17.5",r:"3.5",key:"15x4ox"}],["circle",{cx:"5.5",cy:"17.5",r:"3.5",key:"1noe27"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["path",{d:"M12 17.5V14l-3-3 4-3 2 3h2",key:"1npguv"}]]);var q=c(45583);let r=(0,o.A)("car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);var s=c(88059),t=c(5336),u=c(14952),v=c(99891),w=c(85778),x=c(47033),y=c(75535);let z=[{id:1,title:"Informaci\xf3n Personal",description:"Datos b\xe1sicos de contacto"},{id:2,title:"Veh\xedculo",description:"Informaci\xf3n de tu veh\xedculo"},{id:3,title:"Pago",description:"Informaci\xf3n bancaria"}],A=[{id:"bike",name:"Bici",icon:p,mapIcon:"\uD83D\uDEB4‍♂️",color:"bg-green-100 border-green-300 text-green-800",description:"Ideal para \xe1reas urbanas",benefits:["Ecol\xf3gico","F\xe1cil estacionamiento","Sin gastos de combustible"]},{id:"motorcycle",name:"Moto",icon:q.A,mapIcon:"\uD83C\uDFCD️",color:"bg-blue-100 border-blue-300 text-blue-800",description:"R\xe1pida y eficiente",benefits:["Entrega r\xe1pida","Econ\xf3mica","Maniobrable"]},{id:"car",name:"Auto",icon:r,mapIcon:"\uD83D\uDE97",color:"bg-purple-100 border-purple-300 text-purple-800",description:"Para pedidos grandes",benefits:["Mayor capacidad","Protecci\xf3n clim\xe1tica","C\xf3modo"]}],B=["Banco de Chile","BancoEstado","Santander","BCI","Scotiabank","Banco Falabella","Banco Ripley","Ita\xfa","BBVA","Banco Security"];function C({onComplete:a}){let{user:b}=(0,g.A)(),[c,f]=(0,e.useState)(1),[o,p]=(0,e.useState)(!1),[q,r]=(0,e.useState)({displayName:b?.displayName||"",phone:"",vehicleType:"motorcycle",vehicleInfo:{make:"",model:"",year:new Date().getFullYear(),licensePlate:"",color:""},documents:{driverLicense:"",vehicleRegistration:"",insuranceProof:""},bankInfo:{accountHolderName:b?.displayName||"",bankName:"",accountNumber:"",routingNumber:""}}),C=(a,b)=>{r(c=>({...c,[a]:b}))},D=(a,b,c)=>{r(d=>({...d,[a]:{...d[a]||{},[b]:c}}))},E=a=>{switch(a){case 1:return!!(q.displayName&&q.phone);case 2:return!!q.vehicleType;case 3:return!!(q.bankInfo.accountHolderName&&q.bankInfo.bankName&&q.bankInfo.accountNumber);default:return!0}},F=async()=>{if(b){p(!0);try{let c=y.Dc.now(),d={displayName:q.displayName,email:b.email||"",avatar:b.photoURL||"",phone:q.phone,vehicleType:q.vehicleType,vehicleInfo:{make:G.name,model:G.name,year:new Date().getFullYear(),licensePlate:"N/A",color:"N/A"},currentLocation:{coordinates:{latitude:0,longitude:0,timestamp:c},address:{street:"",city:"",state:"",zipCode:"",country:"Chile",fullAddress:""},isActive:!1,lastUpdated:c},isOnline:!1,isAvailable:!1,rating:5,reviewCount:0,totalDeliveries:0,completionRate:100,earnings:{today:0,thisWeek:0,thisMonth:0,total:0},workingHours:{start:"08:00",end:"20:00"},workingDays:["monday","tuesday","wednesday","thursday","friday"],lastLocationUpdate:c};if(!await h.DriversService.createDriverProfile(d,b.uid))throw Error("Failed to create driver profile");i.oR.success("\xa1Perfil de conductor creado exitosamente! Bienvenido a tu dashboard."),a()}catch(a){console.error("Error creating driver profile:",a),i.oR.error("Error al crear el perfil. Int\xe9ntalo de nuevo.")}finally{p(!1)}}},G=A.find(a=>a.id===q.vehicleType);return(0,d.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 flex items-center justify-center p-4",children:(0,d.jsxs)("div",{className:"w-full max-w-4xl",children:[(0,d.jsxs)("div",{className:"bg-white rounded-t-xl p-6 border-b",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"\xa1\xdanete como Conductor! \uD83D\uDE97"}),(0,d.jsx)("p",{className:"text-gray-600",children:"Comienza a ganar dinero entregando pedidos"})]}),(0,d.jsx)("div",{className:"flex items-center gap-2",children:(0,d.jsx)(s.A,{className:"h-8 w-8 text-blue-500"})})]}),(0,d.jsx)("div",{className:"flex items-center justify-between overflow-x-auto px-2",children:z.map((a,b)=>(0,d.jsxs)("div",{className:"flex items-center min-w-0 flex-shrink-0",children:[(0,d.jsx)("div",{className:`flex items-center justify-center w-8 h-8 sm:w-10 sm:h-10 rounded-full border-2 ${c>=a.id?"bg-blue-500 border-blue-500 text-white":"border-gray-300 text-gray-400"}`,children:c>a.id?(0,d.jsx)(t.A,{className:"h-4 w-4 sm:h-5 sm:w-5"}):(0,d.jsx)("span",{className:"text-xs sm:text-sm font-medium",children:a.id})}),(0,d.jsxs)("div",{className:"ml-2 sm:ml-3 min-w-0",children:[(0,d.jsx)("p",{className:`text-xs sm:text-sm font-medium truncate ${c>=a.id?"text-blue-600":"text-gray-400"}`,children:a.title}),(0,d.jsx)("p",{className:"text-xs text-gray-500 truncate hidden sm:block",children:a.description})]}),b<z.length-1&&(0,d.jsx)(u.A,{className:"h-4 w-4 sm:h-5 sm:w-5 text-gray-300 mx-2 sm:mx-4 flex-shrink-0"})]},a.id))})]}),(0,d.jsxs)("div",{className:"bg-white rounded-b-xl p-8",children:[1===c&&(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"text-center mb-8",children:[(0,d.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Informaci\xf3n Personal"}),(0,d.jsx)("p",{className:"text-gray-600",children:"Cu\xe9ntanos qui\xe9n eres para comenzar"})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)(l.J,{htmlFor:"displayName",children:"Nombre completo *"}),(0,d.jsx)(k.p,{id:"displayName",value:q.displayName,onChange:a=>C("displayName",a.target.value),placeholder:"Tu nombre como aparecer\xe1 para los clientes"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)(l.J,{htmlFor:"phone",children:"N\xfamero de tel\xe9fono *"}),(0,d.jsx)(k.p,{id:"phone",value:q.phone,onChange:a=>C("phone",a.target.value),placeholder:"+56 9 1234 5678"})]})]}),(0,d.jsx)(m.Zp,{className:"bg-blue-50 border-blue-200",children:(0,d.jsx)(m.Wu,{className:"p-4",children:(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)(v.A,{className:"h-5 w-5 text-blue-600"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm font-medium text-blue-800",children:"Tu informaci\xf3n est\xe1 segura"}),(0,d.jsx)("p",{className:"text-xs text-blue-600",children:"Solo se compartir\xe1 lo necesario para las entregas"})]})]})})})]}),2===c&&(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"text-center mb-8",children:[(0,d.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Tu Veh\xedculo"}),(0,d.jsx)("p",{className:"text-gray-600",children:"Selecciona tu m\xe9todo de entrega"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)(l.J,{className:"text-2xl font-bold mb-8 block text-center text-gray-800",children:"\xa1Elige tu veh\xedculo de entrega!"}),(0,d.jsx)("div",{className:"grid grid-cols-3 gap-2 sm:gap-4 md:gap-8 max-w-6xl mx-auto px-2 sm:px-4",children:A.map(a=>(0,d.jsx)("div",{className:`group cursor-pointer transition-all duration-300 transform hover:scale-105 ${q.vehicleType===a.id?"scale-105":"hover:shadow-2xl"}`,onClick:()=>C("vehicleType",a.id),children:(0,d.jsxs)(m.Zp,{className:`relative overflow-hidden border-4 transition-all duration-300 ${q.vehicleType===a.id?"ring-4 ring-moai-orange ring-opacity-50 border-moai-orange bg-gradient-to-br from-orange-50 to-orange-100 shadow-2xl":"border-gray-200 hover:border-gray-300 bg-white hover:shadow-xl"}`,children:[q.vehicleType===a.id&&(0,d.jsx)("div",{className:"absolute top-4 right-4 z-10",children:(0,d.jsx)("div",{className:"bg-moai-orange text-white rounded-full p-2",children:(0,d.jsx)(t.A,{className:"h-6 w-6"})})}),(0,d.jsxs)(m.Wu,{className:"p-3 sm:p-6 md:p-8 text-center relative",children:[(0,d.jsx)("div",{className:"text-4xl sm:text-6xl md:text-8xl mb-2 sm:mb-4 transform group-hover:scale-110 transition-transform duration-300",children:a.mapIcon}),(0,d.jsx)(a.icon,{className:`h-6 w-6 sm:h-8 sm:w-8 md:h-12 md:w-12 mx-auto mb-2 sm:mb-4 transition-colors duration-300 ${q.vehicleType===a.id?"text-moai-orange":"text-gray-500 group-hover:text-gray-700"}`}),(0,d.jsx)("h3",{className:`font-bold text-sm sm:text-lg md:text-2xl mb-1 sm:mb-3 transition-colors duration-300 ${q.vehicleType===a.id?"text-moai-orange":"text-gray-800"}`,children:a.name}),a.description&&(0,d.jsx)("p",{className:`text-xs sm:text-sm md:text-base mb-2 sm:mb-4 font-medium transition-colors duration-300 ${q.vehicleType===a.id?"text-orange-700":"text-gray-600"}`,children:a.description}),a.benefits&&a.benefits.length>0&&(0,d.jsx)("div",{className:"space-y-1 sm:space-y-2 hidden sm:block",children:a.benefits.map((b,c)=>(0,d.jsxs)("div",{className:`flex items-center justify-center text-xs sm:text-sm font-medium transition-colors duration-300 ${q.vehicleType===a.id?"text-orange-600":"text-gray-500"}`,children:[(0,d.jsx)(t.A,{className:`h-3 w-3 sm:h-4 sm:w-4 mr-1 sm:mr-2 transition-colors duration-300 ${q.vehicleType===a.id?"text-green-600":"text-green-500"}`}),b]},c))}),(0,d.jsx)("div",{className:`mt-2 sm:mt-6 py-2 sm:py-3 px-1 sm:px-4 md:px-6 rounded-full font-bold text-xs sm:text-sm md:text-base transition-all duration-300 whitespace-nowrap overflow-hidden ${q.vehicleType===a.id?"bg-moai-orange text-white shadow-lg":"bg-gray-100 text-gray-600 group-hover:bg-gray-200"}`,children:(0,d.jsx)("span",{className:"block truncate",children:q.vehicleType===a.id?"\xa1Seleccionado!":"Seleccionar"})})]})]})},a.id))})]})]}),3===c&&(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"text-center mb-8",children:[(0,d.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Informaci\xf3n de Pago"}),(0,d.jsx)("p",{className:"text-gray-600",children:"Para depositar tus ganancias"})]}),(0,d.jsx)(m.Zp,{className:"bg-green-50 border-green-200",children:(0,d.jsx)(m.Wu,{className:"p-4",children:(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)(w.A,{className:"h-5 w-5 text-green-600"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"text-sm font-medium text-green-800",children:"Pagos semanales"}),(0,d.jsx)("p",{className:"text-xs text-green-600",children:"Recibe tus ganancias cada viernes"})]})]})})}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)(l.J,{htmlFor:"accountHolderName",children:"Nombre del titular *"}),(0,d.jsx)(k.p,{id:"accountHolderName",value:q.bankInfo.accountHolderName,onChange:a=>D("bankInfo","accountHolderName",a.target.value),placeholder:"Nombre completo como aparece en la cuenta"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)(l.J,{htmlFor:"bankName",children:"Banco *"}),(0,d.jsxs)(n.l6,{onValueChange:a=>D("bankInfo","bankName",a),children:[(0,d.jsx)(n.bq,{className:"bg-white",children:(0,d.jsx)(n.yv,{placeholder:"Selecciona tu banco"})}),(0,d.jsx)(n.gC,{className:"bg-white border shadow-lg",children:B.map(a=>(0,d.jsx)(n.eb,{value:a,className:"bg-white hover:bg-gray-50 text-gray-900",children:a},a))})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)(l.J,{htmlFor:"accountNumber",children:"N\xfamero de cuenta *"}),(0,d.jsx)(k.p,{id:"accountNumber",value:q.bankInfo.accountNumber,onChange:a=>D("bankInfo","accountNumber",a.target.value),placeholder:"N\xfamero de cuenta corriente"})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)(l.J,{htmlFor:"routingNumber",children:"RUT *"}),(0,d.jsx)(k.p,{id:"routingNumber",value:q.bankInfo.routingNumber,onChange:a=>D("bankInfo","routingNumber",a.target.value),placeholder:"12.345.678-9"})]})]})]}),(0,d.jsxs)("div",{className:"flex justify-between mt-8 pt-6 border-t",children:[(0,d.jsxs)(j.$,{variant:"outline",onClick:()=>{f(a=>Math.max(a-1,1)),window.scrollTo({top:0,behavior:"smooth"})},disabled:1===c,children:[(0,d.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Anterior"]}),c<z.length?(0,d.jsxs)(j.$,{onClick:()=>{E(c)?(f(a=>Math.min(a+1,z.length)),window.scrollTo({top:0,behavior:"smooth"})):i.oR.error("Por favor completa todos los campos requeridos")},disabled:!E(c),children:["Siguiente",(0,d.jsx)(u.A,{className:"h-4 w-4 ml-2"})]}):(0,d.jsx)(j.$,{onClick:F,disabled:o||!E(c),className:"bg-blue-500 hover:bg-blue-600",children:o?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creando perfil..."]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(t.A,{className:"h-4 w-4 mr-2"}),"\xa1Completar registro!"]})})]})]})]})})}var D=c(59821),E=c(86287),F=c(70373),G=c(94258),H=c(92200),I=c(40083);let J=(0,o.A)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);var K=c(19080),L=c(23928),M=c(28947);let N=(0,o.A)("route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);var O=c(47953),P=c(64398),Q=c(18469),R=c(48730),S=c(97992),T=c(40228),U=c(25541),V=c(41312);let W=(0,o.A)("fuel",[["line",{x1:"3",x2:"15",y1:"22",y2:"22",key:"xegly4"}],["line",{x1:"4",x2:"14",y1:"9",y2:"9",key:"xcnuvu"}],["path",{d:"M14 22V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v18",key:"16j0yd"}],["path",{d:"M14 13h2a2 2 0 0 1 2 2v2a2 2 0 0 0 2 2a2 2 0 0 0 2-2V9.83a2 2 0 0 0-.59-1.42L18 5",key:"7cu91f"}]]);var X=c(86561);let Y=(0,o.A)("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var Z=c(58559),$=c(78122),_=c(84027);let aa=(0,o.A)("map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);var ab=c(25334),ac=c(43649),ad=c(58869),ae=c(94577),af=c(96241),ag=c(37826),ah=c(78377),ai=c(48340),aj=c(96882);let ak=({isOpen:a,onClose:b,order:c,cooksMap:e,dishesMap:f,onAcceptOrder:g,onUpdateOrderStatus:h,isDriverOnline:i,isOrderAssignedToDriver:k})=>{if(!c)return null;let l=e.get(c.cookerId),m=c.deliveryInfo.phone,n=!k&&i&&["pending","accepted"].includes(c.status),o=k&&["ready","delivering"].includes(c.status);return(0,d.jsx)(ag.lG,{open:a,onOpenChange:b,children:(0,d.jsxs)(ag.Cf,{className:"sm:max-w-[425px] md:max-w-[600px] lg:max-w-[700px] max-h-[90vh] overflow-y-auto",children:[(0,d.jsxs)(ag.c7,{children:[(0,d.jsxs)(ag.L3,{className:"text-2xl font-bold text-orange-600",children:["Detalles del Pedido #",c.id.substring(0,8)]}),(0,d.jsx)(ag.rr,{children:"Informaci\xf3n detallada sobre el pedido y acciones disponibles."})]}),(0,d.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[(0,d.jsx)("span",{className:"text-lg font-semibold",children:"Estado:"}),(0,d.jsx)("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${(a=>{switch(a){case"pending":return"text-blue-600 bg-blue-100";case"accepted":return"text-yellow-600 bg-yellow-100";case"preparing":return"text-orange-600 bg-orange-100";case"ready":return"text-purple-600 bg-purple-100";case"delivering":return"text-indigo-600 bg-indigo-100";case"delivered":return"text-green-600 bg-green-100";case"cancelled":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}})(c.status)}`,children:(a=>{switch(a){case"pending":return"Pendiente";case"accepted":return"Aceptado";case"preparing":return"Preparando";case"ready":return"Listo para recoger";case"delivering":return"En camino";case"delivered":return"Entregado";case"cancelled":return"Cancelado";default:return"Desconocido"}})(c.status)})]}),(0,d.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,d.jsx)(S.A,{className:"text-gray-500"}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("p",{className:"font-semibold",children:["Cliente: ",c.customerName]}),(0,d.jsx)("p",{className:"text-sm text-gray-600",children:c.deliveryInfo.address})]})]}),(0,d.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,d.jsx)(ai.A,{className:"text-gray-500"}),(0,d.jsx)("p",{className:"text-sm text-gray-600",children:c.deliveryInfo.phone}),(0,d.jsx)(j.$,{variant:"outline",size:"sm",onClick:()=>{m&&window.open(`tel:${m}`)},children:"Llamar Cliente"})]}),c.deliveryInfo.instructions&&(0,d.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,d.jsx)(aj.A,{className:"text-gray-500 mt-1"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"font-semibold",children:"Instrucciones de Entrega:"}),(0,d.jsx)("p",{className:"text-sm text-gray-600",children:c.deliveryInfo.instructions})]})]}),(0,d.jsx)(ah.w,{}),(0,d.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,d.jsx)(ae.A,{className:"text-gray-500"}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("p",{className:"font-semibold",children:["Cocinero: ",l?.displayName||"Desconocido"]}),(0,d.jsxs)("p",{className:"text-sm text-gray-600",children:["Direcci\xf3n de Recogida: ",l?.location?.address?.fullAddress||"No disponible"]})]})]}),(0,d.jsx)(ah.w,{}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Platos:"}),(0,d.jsx)("div",{className:"space-y-2",children:c.dishes.map((a,b)=>{let c=f.get(a.dishId);return(0,d.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-700",children:[(0,d.jsxs)("span",{children:[a.quantity,"x ",c?.name||a.dishName]}),(0,d.jsxs)("span",{children:["$",(a.quantity*a.price).toLocaleString("es-CL")]})]},b)})})]}),(0,d.jsx)(ah.w,{}),(0,d.jsxs)("div",{className:"space-y-1",children:[(0,d.jsxs)("div",{className:"flex justify-between text-sm text-gray-700",children:[(0,d.jsx)("span",{children:"Subtotal:"}),(0,d.jsxs)("span",{children:["$",c.subtotal.toLocaleString("es-CL")]})]}),(0,d.jsxs)("div",{className:"flex justify-between text-sm text-gray-700",children:[(0,d.jsx)("span",{children:"Costo de Env\xedo:"}),(0,d.jsxs)("span",{children:["$",c.deliveryFee.toLocaleString("es-CL")]})]}),(0,d.jsxs)("div",{className:"flex justify-between text-sm text-gray-700",children:[(0,d.jsx)("span",{children:"Tarifa de Servicio:"}),(0,d.jsxs)("span",{children:["$",c.serviceFee.toLocaleString("es-CL")]})]}),(0,d.jsxs)("div",{className:"flex justify-between text-lg font-bold text-orange-700 mt-2",children:[(0,d.jsx)("span",{children:"Total:"}),(0,d.jsxs)("span",{children:["$",c.total.toLocaleString("es-CL")]})]})]}),(0,d.jsx)(ah.w,{}),(0,d.jsxs)("div",{className:"space-y-1 text-sm text-gray-600",children:[(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)(R.A,{className:"h-4 w-4"}),(0,d.jsxs)("span",{children:["Pedido Realizado: ",c.orderTime?.toDate()?.toLocaleString("es-CL")||"N/A"]})]}),c.estimatedDeliveryTime&&(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)(R.A,{className:"h-4 w-4"}),(0,d.jsxs)("span",{children:["Estimado de Entrega: ",c.estimatedDeliveryTime?.toDate()?.toLocaleString("es-CL")||"N/A"]})]}),c.actualDeliveryTime&&(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)(R.A,{className:"h-4 w-4"}),(0,d.jsxs)("span",{children:["Entregado: ",c.actualDeliveryTime?.toDate()?.toLocaleString("es-CL")||"N/A"]})]})]})]}),(0,d.jsxs)("div",{className:"flex flex-col gap-2 mt-4",children:[n&&(0,d.jsx)(j.$,{onClick:()=>g&&g(c.id),className:"w-full bg-green-500 hover:bg-green-600",children:"Aceptar Pedido"}),o&&(0,d.jsx)(j.$,{onClick:()=>{if(!h)return;let a=null;switch(c.status){case"ready":a="delivering";break;case"delivering":a="delivered"}a&&h(c.id,a)},className:"w-full",children:(()=>{switch(c.status){case"ready":return"Marcar como Recogido (En camino)";case"delivering":return"Marcar como Entregado";default:return null}})()}),(0,d.jsx)(j.$,{variant:"outline",onClick:b,className:"w-full",children:"Cerrar"})]})]})})};var al=c(93613);let am=({onOrderAccepted:a,hasActiveDelivery:b=!1,isDriverOnline:c=!1})=>{let{user:f}=(0,g.A)(),[k,l]=(0,e.useState)([]),[n,o]=(0,e.useState)(null);(0,e.useEffect)(()=>{if(!f)return;let a=h.OrdersService.subscribeToAvailableOrders(a=>{l(a.filter(a=>!a.driverId))});return()=>a()},[f]);let p=async b=>{if(f){o(b);try{await h.OrdersService.assignOrderToDriver(b,f.uid)?(i.oR.success("Pedido aceptado exitosamente"),a?.(b)):i.oR.error("Error al aceptar el pedido")}catch(a){console.error("Error accepting order:",a),i.oR.error("Error al aceptar el pedido")}finally{o(null)}}};return c?b?(0,d.jsx)(m.Zp,{children:(0,d.jsxs)(m.Wu,{className:"p-8 text-center",children:[(0,d.jsx)(H.A,{className:"h-16 w-16 text-orange-500 mx-auto mb-4"}),(0,d.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Entrega en progreso"}),(0,d.jsx)("p",{className:"text-muted-foreground",children:"Completa tu entrega actual antes de aceptar nuevos pedidos"})]})}):0===k.length?(0,d.jsx)(m.Zp,{children:(0,d.jsxs)(m.Wu,{className:"p-8 text-center",children:[(0,d.jsx)(K.A,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),(0,d.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No hay entregas disponibles"}),(0,d.jsx)("p",{className:"text-muted-foreground",children:"Los nuevos pedidos aparecer\xe1n aqu\xed autom\xe1ticamente"})]})}):(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("h2",{className:"text-xl font-semibold",children:"Entregas Disponibles"}),(0,d.jsxs)(D.E,{variant:"outline",className:"bg-blue-50 text-blue-700",children:[k.length," disponibles"]})]}),k.map(a=>{let{progress:e,timeRemaining:f,totalPrepTime:g}=(a=>{if(!a.createdAt)return{progress:0,timeRemaining:"Calculando...",totalPrepTime:30};let b=a.dishes.map(a=>({prepTime:a.prepTime||"30 min",quantity:a.quantity})),c=(0,af.Dm)(b),d=a.createdAt?.toDate()||new Date;return{progress:(0,af.uA)(d,c),timeRemaining:(0,af.$B)(d,c),totalPrepTime:c}})(a),h=e>=100||"ready"===a.status;return(0,d.jsxs)(m.Zp,{className:`transition-all duration-200 ${h?"ring-2 ring-green-200 bg-green-50":""}`,children:[(0,d.jsx)(m.aR,{children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)(m.ZB,{className:"text-lg",children:["Pedido #",a.id.slice(-8)]}),(0,d.jsxs)(m.BT,{className:"flex items-center gap-2 mt-1",children:[(0,d.jsx)(ad.A,{className:"h-4 w-4"}),a.customerName,(0,d.jsx)("span",{className:"text-muted-foreground",children:"•"}),a.createdAt?.toDate().toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"})]})]}),(0,d.jsxs)("div",{className:"text-right",children:[(0,d.jsx)(D.E,{className:(a=>{switch(a){case"accepted":return"bg-green-100 text-green-800";case"preparing":return"bg-blue-100 text-blue-800";case"ready":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}})(a.status),children:(0,d.jsxs)("div",{className:"flex items-center gap-1",children:[(a=>{switch(a){case"accepted":return(0,d.jsx)(t.A,{className:"h-4 w-4"});case"preparing":return(0,d.jsx)(ae.A,{className:"h-4 w-4"});case"ready":return(0,d.jsx)(K.A,{className:"h-4 w-4"});default:return(0,d.jsx)(R.A,{className:"h-4 w-4"})}})(a.status),(a=>{switch(a){case"accepted":return"Aceptado";case"preparing":return"Preparando";case"ready":return"Listo para entrega";default:return a}})(a.status)]})}),(0,d.jsx)("div",{className:"text-lg font-bold mt-1",children:(0,af.$g)(a.total)})]})]})}),(0,d.jsxs)(m.Wu,{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"bg-white p-4 rounded-lg border",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(Q.A,{className:"h-4 w-4 text-muted-foreground"}),(0,d.jsx)("span",{className:"text-sm font-medium",children:"Progreso de preparaci\xf3n"})]}),(0,d.jsx)("span",{className:"text-sm font-mono font-bold",children:h?"\uD83D\uDFE2 LISTO":f})]}),(0,d.jsx)(E.k,{value:e,className:"h-2"}),(0,d.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground mt-1",children:[(0,d.jsxs)("span",{children:["Iniciado: ",a.createdAt?.toDate().toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"})]}),(0,d.jsxs)("span",{children:["Estimado: ",(0,af.bC)(a.createdAt?.toDate()||new Date,g).toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"})]})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("h4",{className:"font-medium mb-2 flex items-center gap-2",children:[(0,d.jsx)(ae.A,{className:"h-4 w-4"}),"Platos (",a.dishes.length,")"]}),(0,d.jsx)("div",{className:"bg-muted p-3 rounded-lg space-y-1",children:a.dishes.map((a,b)=>(0,d.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,d.jsxs)("span",{children:[a.dishName," x ",a.quantity]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("span",{className:"text-xs text-muted-foreground",children:a.prepTime||"30 min"}),(0,d.jsx)("span",{className:"font-medium",children:(0,af.$g)(a.price*a.quantity)})]})]},b))})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[(0,d.jsxs)("div",{className:"flex items-start gap-2",children:[(0,d.jsx)(S.A,{className:"h-4 w-4 text-muted-foreground mt-1"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-sm font-medium block",children:"Direcci\xf3n:"}),(0,d.jsx)("span",{className:"text-sm text-muted-foreground",children:a.deliveryInfo.address})]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(ai.A,{className:"h-4 w-4 text-muted-foreground"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-sm font-medium block",children:"Tel\xe9fono:"}),(0,d.jsx)("span",{className:"text-sm text-muted-foreground",children:a.deliveryInfo.phone})]})]})]}),a.deliveryInfo.instructions&&(0,d.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 p-3 rounded-lg",children:(0,d.jsxs)("div",{className:"flex items-start gap-2",children:[(0,d.jsx)(al.A,{className:"h-4 w-4 text-yellow-600 mt-0.5"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"text-sm font-medium text-yellow-800",children:"Instrucciones especiales:"}),(0,d.jsx)("p",{className:"text-sm text-yellow-700 mt-1",children:a.deliveryInfo.instructions})]})]})}),(0,d.jsx)(j.$,{onClick:()=>p(a.id),disabled:n===a.id||b||!c,className:`w-full ${h?"bg-green-600 hover:bg-green-700":"bg-blue-600 hover:bg-blue-700"}`,size:"lg",children:n===a.id?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Aceptando..."]}):b?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(al.A,{className:"h-5 w-5 mr-2"}),"Entrega en progreso"]}):c?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(H.A,{className:"h-5 w-5 mr-2"}),h?"Recoger Pedido":"Aceptar Entrega"]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(al.A,{className:"h-5 w-5 mr-2"}),"Act\xedvate en l\xednea"]})})]})]},a.id)})]}):(0,d.jsx)(m.Zp,{children:(0,d.jsxs)(m.Wu,{className:"p-8 text-center",children:[(0,d.jsx)(K.A,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),(0,d.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Est\xe1s fuera de l\xednea"}),(0,d.jsx)("p",{className:"text-muted-foreground",children:"Activa tu estado en l\xednea para ver pedidos disponibles"})]})})};var an=c(28559),ao=c(46234),ap=c(41862);let aq=({order:a,cook:b,currentStep:c,onLocationUpdate:f})=>{let g=(0,e.useRef)(null),[h,i]=(0,e.useState)(null),[k,l]=(0,e.useState)(null),[m,n]=(0,e.useState)(null),[o,p]=(0,e.useState)(null),[q,r]=(0,e.useState)(null),[s,t]=(0,e.useState)(null),[u,v]=(0,e.useState)(!0),[w,x]=(0,e.useState)(null);(0,e.useEffect)(()=>{(async()=>{try{if(window.google||await y(),g.current){let a=new google.maps.Map(g.current,{zoom:13,center:{lat:-33.4489,lng:-70.6693},mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1}),b=new google.maps.DirectionsService,c=new google.maps.DirectionsRenderer({suppressMarkers:!1,polylineOptions:{strokeColor:"#FF6600",strokeWeight:4}});c.setMap(a),i(a),l(b),n(c)}}catch(a){console.error("Error initializing map:",a),x("Error al cargar el mapa")}finally{v(!1)}})()},[]),(0,e.useEffect)(()=>{let c=async()=>{try{let c=await z();if(p(c),b?.location?.coordinates){let a={lat:b.location.coordinates.latitude,lng:b.location.coordinates.longitude,address:b.location.address?.fullAddress||"Ubicaci\xf3n del cocinero"};r(a)}else{let a=await A(b?.location?.address?.fullAddress||"Santiago, Chile");r(a)}let d=await A(a.deliveryInfo.address);t(d)}catch(c){console.error("Error loading locations:",c),p({lat:-33.4489,lng:-70.6693,address:"Santiago Centro"}),r({lat:-33.4489,lng:-70.6693,address:b?.displayName||"Cocinero"}),t({lat:-33.4489,lng:-70.6693,address:a.deliveryInfo.address})}};h&&b&&c()},[h,b,a]),(0,e.useEffect)(()=>{h&&k&&m&&o&&q&&s&&B()},[h,k,m,o,q,s,c]);let y=()=>new Promise((a,b)=>{if(window.google)return void a();let c=document.createElement("script");c.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCIni3lox4wQG0lX9Sy9zv3Q_iMjV5AvTs&libraries=geometry",c.async=!0,c.defer=!0,c.onload=()=>a(),c.onerror=()=>b(Error("Failed to load Google Maps API")),document.head.appendChild(c)}),z=()=>new Promise((a,b)=>{if(!navigator.geolocation)return void b(Error("Geolocation not supported"));navigator.geolocation.getCurrentPosition(b=>{a({lat:b.coords.latitude,lng:b.coords.longitude,address:"Tu ubicaci\xf3n actual"})},b=>{console.warn("Geolocation error:",b),a({lat:-33.4489,lng:-70.6693,address:"Santiago Centro (ubicaci\xf3n aproximada)"})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})}),A=async a=>{if(!window.google)throw Error("Google Maps not loaded");let b=new google.maps.Geocoder;return new Promise((c,d)=>{b.geocode({address:`${a}, Santiago, Chile`},(b,d)=>{if("OK"===d&&b&&b[0]){let a=b[0].geometry.location;c({lat:a.lat(),lng:a.lng(),address:b[0].formatted_address})}else console.warn("Geocoding failed for:",a),c({lat:-33.4489,lng:-70.6693,address:a})})})},B=()=>{let a,b;if(!k||!m||!o||!q||!s)return;let d=[];0===c||1===c?(a=o,b=q):2===c?(a=q,b=s):(a=o,b=s,d=[{location:{lat:q.lat,lng:q.lng},stopover:!0}]);let e={origin:{lat:a.lat,lng:a.lng},destination:{lat:b.lat,lng:b.lng},waypoints:d,travelMode:google.maps.TravelMode.DRIVING,unitSystem:google.maps.UnitSystem.METRIC,avoidHighways:!1,avoidTolls:!1};k.route(e,(a,b)=>{if("OK"===b&&a){m.setDirections(a);let b=a.routes[0];if(b&&b.legs.length>0){let a=0,c="",e="";b.legs.forEach((b,f)=>{a+=b.duration?.value||0,0===f&&(c=b.duration?.text||""),0===d.length?e=b.duration?.text||"":1===f&&(e=b.duration?.text||"")});let g=Math.ceil(a/60),h=`${g} min`;f?.({pickup:c,delivery:e,total:h})}C()}else console.error("Directions request failed:",b),x("Error al calcular la ruta")})},C=()=>{h&&o&&q&&s&&new google.maps.Marker({position:{lat:o.lat,lng:o.lng},map:h,title:"Tu ubicaci\xf3n",icon:{path:google.maps.SymbolPath.CIRCLE,scale:8,fillColor:"#4285F4",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:2}})},D=()=>{let a;if(!q&&!s)return;a=0===c||1===c?q:s;let b=`https://www.google.com/maps/dir/?api=1&destination=${a.lat},${a.lng}&travelmode=driving`;window.open(b,"_blank")};return u?(0,d.jsx)("div",{className:"h-full flex items-center justify-center bg-muted/20",children:(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)(ap.A,{className:"h-8 w-8 animate-spin text-primary mx-auto mb-2"}),(0,d.jsx)("p",{className:"text-sm text-muted-foreground",children:"Cargando mapa..."})]})}):w?(0,d.jsx)("div",{className:"h-full flex items-center justify-center bg-muted/20",children:(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)(S.A,{className:"h-8 w-8 text-muted-foreground mx-auto mb-2"}),(0,d.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:w}),(0,d.jsxs)(j.$,{variant:"outline",onClick:D,children:[(0,d.jsx)(H.A,{className:"h-4 w-4 mr-2"}),"Abrir en Google Maps"]})]})}):(0,d.jsxs)("div",{className:"h-full relative",children:[(0,d.jsx)("div",{ref:g,className:"h-full w-full"}),(0,d.jsx)("div",{className:"absolute bottom-4 right-4",children:(0,d.jsxs)(j.$,{onClick:D,size:"sm",className:"shadow-lg",children:[(0,d.jsx)(H.A,{className:"h-4 w-4 mr-2"}),"Navegar"]})}),(0,d.jsx)("div",{className:"absolute top-4 left-4 right-4",children:(0,d.jsx)("div",{className:"bg-white/95 backdrop-blur-sm rounded-lg p-3 shadow-lg",children:(0,d.jsxs)("div",{className:"text-sm",children:[(0,d.jsx)("div",{className:"font-medium text-primary mb-1",children:0===c||1===c?"Dirigi\xe9ndote a:":"Entregando en:"}),(0,d.jsx)("div",{className:"text-muted-foreground",children:0===c||1===c?q?.address||"Cargando...":s?.address||"Cargando..."})]})})})]})};var ar=c(18413);let as=({activeOrder:a,onBackToDashboard:b})=>{let{user:c}=(0,g.A)(),[f,k]=(0,e.useState)(a),[l,n]=(0,e.useState)(null),[o,p]=(0,e.useState)(null),[q,r]=(0,e.useState)(!1),[s,u]=(0,e.useState)(0),[v,w]=(0,e.useState)({pickup:"15 min",delivery:"25 min",total:"40 min"}),[x,y]=(0,e.useState)(null),z=()=>{let a=l?{address:l.location?.address?.fullAddress||"Ubicaci\xf3n del cocinero",lat:l.location?.coordinates?.latitude,lng:l.location?.coordinates?.longitude}:{address:"Cargando ubicaci\xf3n del cocinero..."},b={address:f.deliveryInfo.address,lat:void 0,lng:void 0};return[{id:"accepted",title:"Pedido Aceptado",status:"accepted"===f.status?"current":"completed",action:"Dirigirse al cocinero",nextStatus:"preparing"},{id:"pickup",title:"Recoger Pedido",status:"preparing"===f.status?"current":["accepted"].includes(f.status)?"pending":"completed",location:a,action:"Confirmar recogida",nextStatus:"delivering"},{id:"delivery",title:"Entregar al Cliente",status:"delivering"===f.status?"current":["accepted","preparing"].includes(f.status)?"pending":"completed",location:b,action:"Confirmar entrega",nextStatus:"delivered"},{id:"completed",title:"Entrega Completada",status:"delivered"===f.status?"completed":"pending"}]};(0,e.useEffect)(()=>{B();let a=h.OrdersService.subscribeToOrderUpdates(f.cookerId,a=>{let b=a.find(a=>a.id===f.id);b&&k(b)});return c&&y(ar.DeliveryTrackingService.startLocationTracking(f.id,c.uid,c.displayName||c.email||"Conductor",a=>{let b=A();ar.DeliveryTrackingService.updateDeliveryTracking({orderId:f.id,driverId:c.uid,driverName:c.displayName||c.email||"Conductor",currentLocation:{lat:a.lat,lng:a.lng,timestamp:new Date},estimatedPickupTime:v.pickup,estimatedDeliveryTime:v.delivery,totalEstimatedTime:v.total,currentStep:b})})),()=>{a(),x?.stop()}},[f.id,f.cookerId]),(0,e.useEffect)(()=>{let a=z(),b=a.findIndex(a=>"current"===a.status);u(b>=0?b:a.length-1),c&&ar.DeliveryTrackingService.updateDeliveryStep(f.id,A())},[f.status]);let A=()=>{switch(f.status){case"accepted":default:return"heading_to_pickup";case"preparing":return"at_pickup";case"delivering":return"heading_to_delivery";case"delivered":return"delivered"}},B=async()=>{try{let[a,b]=await Promise.all([h.CooksService.getCookById(f.cookerId),h.DishesService.getDishById(f.dishes[0]?.dishId||"")]);n(a),p(b)}catch(a){console.error("Error loading order details:",a)}},C=async a=>{if(c){r(!0);try{await h.OrdersService.updateOrderStatus(f.id,a)?(k(b=>({...b,status:a})),i.oR.success({preparing:"Te diriges al cocinero",delivering:"Pedido recogido, dirigi\xe9ndote al cliente",delivered:"Entrega completada exitosamente"}[a]||"Estado actualizado"),"delivered"===a&&setTimeout(()=>{b()},2e3)):i.oR.error("Error al actualizar el estado del pedido")}catch(a){console.error("Error updating order status:",a),i.oR.error("Error al actualizar el estado del pedido")}finally{r(!1)}}},E=z(),G=E[s],I="delivered"===f.status;return(0,d.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,d.jsx)("div",{className:"bg-primary text-primary-foreground shadow-sm",children:(0,d.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsxs)(j.$,{variant:"ghost",size:"sm",onClick:b,className:"text-primary-foreground hover:bg-primary/20",children:[(0,d.jsx)(an.A,{className:"h-4 w-4 mr-2"}),"Dashboard"]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h1",{className:"text-xl font-bold",children:"Entrega Activa"}),(0,d.jsxs)("p",{className:"text-sm opacity-90",children:["Pedido #",f.id.slice(-8)]})]})]}),(0,d.jsxs)("div",{className:"text-right",children:[(0,d.jsx)("div",{className:"text-lg font-bold",children:(0,af.$g)(f.total)}),(0,d.jsxs)("div",{className:"text-sm opacity-90",children:["ETA: ",v.total]})]})]})})}),(0,d.jsx)("div",{className:"container mx-auto px-4 py-6",children:(0,d.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)(m.Zp,{className:"border-primary/20",children:[(0,d.jsx)(m.aR,{children:(0,d.jsxs)(m.ZB,{className:"flex items-center gap-2",children:[G?.status==="current"&&(0,d.jsx)(Q.A,{className:"h-5 w-5 text-primary"}),G?.status==="completed"&&(0,d.jsx)(t.A,{className:"h-5 w-5 text-green-500"}),G?.title||"Paso Actual"]})}),(0,d.jsxs)(m.Wu,{children:[G?.location&&(0,d.jsx)("div",{className:"mb-4",children:(0,d.jsxs)("div",{className:"flex items-start gap-2 mb-2",children:[(0,d.jsx)(S.A,{className:"h-4 w-4 text-muted-foreground mt-1"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"font-medium",children:"Destino:"}),(0,d.jsx)("p",{className:"text-sm text-muted-foreground",children:G.location.address})]})]})}),G?.action&&G.nextStatus&&!I&&(0,d.jsx)(j.$,{onClick:()=>C(G.nextStatus),disabled:q,className:"w-full",size:"lg",children:q?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Actualizando..."]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(H.A,{className:"h-4 w-4 mr-2"}),G.action]})}),I&&(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)(t.A,{className:"h-12 w-12 text-green-500 mx-auto mb-2"}),(0,d.jsx)("p",{className:"text-green-600 font-medium",children:"\xa1Entrega Completada!"})]})]})]}),(0,d.jsxs)(m.Zp,{children:[(0,d.jsx)(m.aR,{children:(0,d.jsx)(m.ZB,{children:"Progreso de Entrega"})}),(0,d.jsx)(m.Wu,{children:(0,d.jsx)("div",{className:"space-y-4",children:E.map((a,b)=>(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)("div",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium ${"completed"===a.status?"bg-green-500 text-white":"current"===a.status?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"}`,children:"completed"===a.status?(0,d.jsx)(t.A,{className:"h-3 w-3"}):b+1}),(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsx)("p",{className:`font-medium ${"current"===a.status?"text-primary":""}`,children:a.title}),a.location&&(0,d.jsx)("p",{className:"text-xs text-muted-foreground",children:a.location.address})]}),"current"===a.status&&(0,d.jsx)(D.E,{variant:"default",children:"Actual"})]},a.id))})})]}),(0,d.jsxs)(m.Zp,{children:[(0,d.jsx)(m.aR,{children:(0,d.jsx)(m.ZB,{children:"Detalles del Pedido"})}),(0,d.jsxs)(m.Wu,{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)(K.A,{className:"h-5 w-5 text-muted-foreground"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"font-medium",children:o?.name||"Cargando..."}),(0,d.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Cantidad: ",f.dishes[0]?.quantity||1]})]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsxs)(F.eu,{className:"h-8 w-8",children:[(0,d.jsx)(F.BK,{src:l?.avatar}),(0,d.jsx)(F.q5,{children:(0,d.jsx)(ao.A,{className:"h-4 w-4"})})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"font-medium",children:l?.displayName||"Cargando..."}),(0,d.jsx)("p",{className:"text-sm text-muted-foreground",children:"Cocinero"})]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)(ad.A,{className:"h-5 w-5 text-muted-foreground"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("p",{className:"font-medium",children:f.customerName}),(0,d.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,d.jsx)(ai.A,{className:"h-3 w-3"}),f.deliveryInfo.phone]})]})]}),f.deliveryInfo.instructions&&(0,d.jsxs)("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[(0,d.jsx)("p",{className:"text-sm font-medium text-yellow-800 mb-1",children:"Instrucciones especiales:"}),(0,d.jsx)("p",{className:"text-sm text-yellow-700",children:f.deliveryInfo.instructions})]})]})]})]}),(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)(m.Zp,{className:"h-[600px]",children:[(0,d.jsx)(m.aR,{children:(0,d.jsxs)(m.ZB,{className:"flex items-center gap-2",children:[(0,d.jsx)(N,{className:"h-5 w-5"}),G?.location?"Navegaci\xf3n":"Ubicaci\xf3n"]})}),(0,d.jsx)(m.Wu,{className:"h-full p-0",children:(0,d.jsx)(aq,{order:f,cook:l,currentStep:s,onLocationUpdate:a=>{w(b=>({...b,...a})),c&&ar.DeliveryTrackingService.updateETA(f.id,a)}})})]}),(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,d.jsxs)(j.$,{variant:"outline",className:"h-12",children:[(0,d.jsx)(ai.A,{className:"h-4 w-4 mr-2"}),"Llamar Cliente"]}),(0,d.jsxs)(j.$,{variant:"outline",className:"h-12",children:[(0,d.jsx)(ai.A,{className:"h-4 w-4 mr-2"}),"Llamar Cocinero"]})]})]})]})})]})};var at=c(58887);function au({order:a,cook:b,onStatusUpdate:c,onStartNavigation:f,onCallCustomer:g}){let[h,k]=(0,e.useState)(0),[l,n]=(0,e.useState)(null),o=[{id:"accepted",title:"Pedido Aceptado",description:"Has aceptado este pedido. El cocinero ser\xe1 notificado y confirmar\xe1 la preparaci\xf3n.",status:"accepted"===a.status?"active":["preparing","ready","delivering","delivered"].includes(a.status)?"completed":"pending",estimatedTime:"1-2 min",icon:t.A,action:"accepted"===a.status?"Esperando confirmaci\xf3n...":void 0},{id:"preparing",title:"Preparaci\xf3n en Curso",description:"El cocinero est\xe1 preparando el pedido. Puedes monitorear el progreso.",status:"preparing"===a.status?"active":["ready","delivering","delivered"].includes(a.status)?"completed":"pending",estimatedTime:a.dishes.reduce((a,b)=>Math.max(a,"string"==typeof b.prepTime?parseInt(b.prepTime.replace(/\D/g,"")):b.prepTime||30),30)+" min",icon:ae.A,action:"preparing"===a.status?`Listo aprox: ${l?.toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"})}`:void 0},{id:"ready",title:"Listo para Recoger",description:"El pedido est\xe1 listo. Ve al restaurante para recogerlo.",status:"ready"===a.status?"active":["delivering","delivered"].includes(a.status)?"completed":"pending",estimatedTime:"5-10 min",icon:K.A,action:"ready"===a.status?"Recoger Pedido":void 0,actionHandler:"ready"===a.status?()=>{c(a.id,"delivering"),i.oR.success("\xa1Pedido recogido! Ahora dir\xedgete al cliente.")}:void 0},{id:"delivering",title:"En Camino al Cliente",description:"Dir\xedgete a la direcci\xf3n del cliente para entregar el pedido.",status:"delivering"===a.status?"active":"delivered"===a.status?"completed":"pending",estimatedTime:"10-20 min",icon:r,action:"delivering"===a.status?"Navegar al Cliente":void 0,actionHandler:"delivering"===a.status?()=>{f(a.deliveryInfo.address)}:void 0},{id:"delivered",title:"Entrega Completada",description:"Confirma la entrega una vez que hayas entregado el pedido al cliente.",status:"delivered"===a.status?"completed":"pending",icon:t.A,action:"delivering"===a.status?"Confirmar Entrega":void 0,actionHandler:"delivering"===a.status?()=>{c(a.id,"delivered"),i.oR.success("\xa1Entrega completada! Ganancia agregada a tu cuenta.")}:void 0}],p=o.findIndex(a=>"active"===a.status),q=o.filter(a=>"completed"===a.status).length/o.length*100,{progress:s,timeRemaining:u}=(()=>{if("preparing"!==a.status||!a.createdAt||!l)return{progress:0,timeRemaining:""};let b=new Date,c=a.createdAt.toDate(),d=l.getTime()-c.getTime(),e=Math.min((b.getTime()-c.getTime())/d*100,100),f=Math.ceil(Math.max(0,l.getTime()-b.getTime())/6e4);return{progress:e,timeRemaining:f>0?`${f} min restantes`:"Listo!"}})();return(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsx)(m.Zp,{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200",children:(0,d.jsx)(m.aR,{children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,d.jsx)("div",{className:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center",children:(0,d.jsx)(K.A,{className:"h-6 w-6 text-white"})}),(0,d.jsxs)("div",{children:[(0,d.jsxs)(m.ZB,{className:"text-xl text-blue-900",children:["Pedido #",a.id.slice(-8)]}),(0,d.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-blue-700",children:[(0,d.jsxs)("span",{className:"flex items-center",children:[(0,d.jsx)(ae.A,{className:"h-4 w-4 mr-1"}),b?.displayName||"Cocinero"]}),(0,d.jsxs)("span",{className:"flex items-center",children:[(0,d.jsx)(ad.A,{className:"h-4 w-4 mr-1"}),a.customerName]}),(0,d.jsxs)("span",{className:"flex items-center",children:[(0,d.jsx)(R.A,{className:"h-4 w-4 mr-1"}),a.createdAt?.toDate().toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"})]})]})]})]}),(0,d.jsxs)("div",{className:"text-right",children:[(0,d.jsx)("div",{className:"text-2xl font-bold text-blue-900",children:(0,af.$g)(a.total)}),(0,d.jsxs)("div",{className:"text-sm text-blue-700",children:["Ganancia: ",(0,af.$g)(a.deliveryFee||2500)]})]})]})})}),(0,d.jsxs)(m.Zp,{children:[(0,d.jsx)(m.aR,{children:(0,d.jsxs)(m.ZB,{className:"flex items-center justify-between",children:[(0,d.jsx)("span",{children:"Progreso de la Entrega"}),(0,d.jsxs)(D.E,{variant:"outline",className:"text-blue-600 border-blue-300",children:["Paso ",p+1," de ",o.length]})]})}),(0,d.jsxs)(m.Wu,{children:[(0,d.jsxs)("div",{className:"mb-4",children:[(0,d.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[(0,d.jsx)("span",{children:"Progreso General"}),(0,d.jsxs)("span",{children:[Math.round(q),"% completado"]})]}),(0,d.jsx)(E.k,{value:q,className:"h-3"})]}),"preparing"===a.status&&(0,d.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(Q.A,{className:"h-4 w-4 text-orange-600 mr-2"}),(0,d.jsx)("span",{className:"font-medium text-orange-900",children:"Preparaci\xf3n en curso"})]}),(0,d.jsx)("span",{className:"text-sm font-bold text-orange-700",children:u})]}),(0,d.jsx)(E.k,{value:s,className:"h-2 mb-2"}),(0,d.jsx)("p",{className:"text-xs text-orange-700",children:"El cocinero est\xe1 preparando tu pedido. Te notificaremos cuando est\xe9 listo."})]})]})]}),(0,d.jsxs)(m.Zp,{children:[(0,d.jsx)(m.aR,{children:(0,d.jsx)(m.ZB,{children:"Pasos a Seguir"})}),(0,d.jsx)(m.Wu,{children:(0,d.jsx)("div",{className:"space-y-4",children:o.map((a,b)=>{let c=a.icon,e="active"===a.status,f="completed"===a.status;return(0,d.jsxs)("div",{className:`flex items-start space-x-4 p-4 rounded-lg border transition-all ${e?"bg-blue-50 border-blue-200 ring-2 ring-blue-100":f?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200"}`,children:[(0,d.jsx)("div",{className:`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ${e?"bg-blue-600 text-white":f?"bg-green-600 text-white":"bg-gray-400 text-white"}`,children:f?(0,d.jsx)(t.A,{className:"h-5 w-5"}):(0,d.jsx)(c,{className:"h-5 w-5"})}),(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("h4",{className:`font-semibold ${e?"text-blue-900":f?"text-green-900":"text-gray-700"}`,children:a.title}),a.estimatedTime&&(0,d.jsx)("span",{className:`text-xs px-2 py-1 rounded-full ${e?"bg-blue-100 text-blue-700":f?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:a.estimatedTime})]}),(0,d.jsx)("p",{className:`text-sm mt-1 ${e?"text-blue-800":f?"text-green-800":"text-gray-600"}`,children:a.description}),a.action&&e&&(0,d.jsx)("div",{className:"mt-3",children:a.actionHandler?(0,d.jsxs)(j.$,{onClick:a.actionHandler,className:"bg-blue-600 hover:bg-blue-700",size:"sm",children:[(0,d.jsx)(O.A,{className:"h-4 w-4 mr-2"}),a.action]}):(0,d.jsxs)("div",{className:"flex items-center text-blue-600",children:[(0,d.jsx)(Q.A,{className:"h-4 w-4 mr-2 animate-pulse"}),(0,d.jsx)("span",{className:"text-sm font-medium",children:a.action})]})})]})]},a.id)})})})]}),(0,d.jsxs)(m.Zp,{children:[(0,d.jsx)(m.aR,{children:(0,d.jsx)(m.ZB,{children:"Acciones R\xe1pidas"})}),(0,d.jsx)(m.Wu,{children:(0,d.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[(0,d.jsxs)(j.$,{variant:"outline",onClick:()=>f(b?.location?.address?.fullAddress||"Direcci\xf3n del cocinero"),className:"flex items-center justify-center",disabled:!["ready","delivering"].includes(a.status),children:[(0,d.jsx)(H.A,{className:"h-4 w-4 mr-2"}),"Navegar al Cocinero"]}),(0,d.jsxs)(j.$,{variant:"outline",onClick:()=>f(a.deliveryInfo.address),className:"flex items-center justify-center",disabled:"delivering"!==a.status,children:[(0,d.jsx)(S.A,{className:"h-4 w-4 mr-2"}),"Navegar al Cliente"]}),(0,d.jsxs)(j.$,{variant:"outline",onClick:()=>g(a.deliveryInfo.phone),className:"flex items-center justify-center",children:[(0,d.jsx)(ai.A,{className:"h-4 w-4 mr-2"}),"Llamar Cliente"]})]})})]}),(0,d.jsxs)(m.Zp,{children:[(0,d.jsx)(m.aR,{children:(0,d.jsx)(m.ZB,{children:"Detalles del Pedido"})}),(0,d.jsx)(m.Wu,{children:(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Platos:"}),(0,d.jsx)("div",{className:"space-y-2",children:a.dishes.map((a,b)=>(0,d.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,d.jsxs)("span",{children:[a.dishName," x ",a.quantity]}),(0,d.jsx)("span",{className:"font-medium",children:(0,af.$g)(a.price*a.quantity)})]},b))})]}),(0,d.jsxs)("div",{className:"border-t pt-4",children:[(0,d.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Informaci\xf3n de Entrega:"}),(0,d.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,d.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,d.jsx)(S.A,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),(0,d.jsx)("span",{children:a.deliveryInfo.address})]}),(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)(ai.A,{className:"h-4 w-4"}),(0,d.jsx)("span",{children:a.deliveryInfo.phone})]}),a.deliveryInfo.instructions&&(0,d.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,d.jsx)(at.A,{className:"h-4 w-4 mt-0.5 flex-shrink-0"}),(0,d.jsxs)("span",{className:"italic",children:['"',a.deliveryInfo.instructions,'"']})]})]})]})]})})]})]})}var av=c(56525);class aw{static{this.activeTracking=new Map}static{this.UPDATE_INTERVAL=3e4}static{this.lastUpdateTimes=new Map}static startIdleTracking(a,b){this.stopIdleTracking(a);let c=null,d=!0,e=async()=>{if(d)try{let b=await this.getCurrentLocation(),c=Date.now(),d=this.lastUpdateTimes.get(a)||0;c-d>this.UPDATE_INTERVAL&&(await this.updateDriverIdleLocation(a,b),this.lastUpdateTimes.set(a,c))}catch(a){console.error("Error updating idle driver location:",a)}};navigator.geolocation&&(c=navigator.geolocation.watchPosition(()=>e(),a=>console.error("Idle geolocation error:",a),{enableHighAccuracy:!1,timeout:15e3,maximumAge:6e4})),e();let f=()=>{d=!1,null!==c&&navigator.geolocation.clearWatch(c),this.activeTracking.delete(a),this.lastUpdateTimes.delete(a)};return this.activeTracking.set(a,{watchId:c||0,stop:f}),{stop:f}}static stopIdleTracking(a){let b=this.activeTracking.get(a);b&&b.stop()}static async updateDriverIdleLocation(a,b,c){try{let d=(0,y.doc)(av.db,"drivers",a);return await (0,y.mZ)(d,{"currentLocation.coordinates":{latitude:b.lat,longitude:b.lng,timestamp:y.Dc.now()},"currentLocation.lastUpdated":y.Dc.now(),lastLocationUpdate:y.Dc.now(),...c?.speed&&{"currentLocation.speed":c.speed},...c?.heading&&{"currentLocation.heading":c.heading}}),!0}catch(a){return console.error("Error updating idle driver location:",a),!1}}static getCurrentLocation(){return new Promise((a,b)=>{if(!navigator.geolocation)return void b(Error("Geolocation not supported"));navigator.geolocation.getCurrentPosition(b=>{a({lat:b.coords.latitude,lng:b.coords.longitude})},a=>b(a),{enableHighAccuracy:!1,timeout:15e3,maximumAge:6e4})})}static subscribeToDriverStatus(a,b){let c=(0,y.doc)(av.db,"drivers",a);return(0,y.aQ)(c,c=>{if(c.exists()){let d=c.data(),e=d.isOnline||!1,f=d.isAvailable||!1;b(e,f),e&&f?this.startIdleTracking(a,d.displayName||"Driver"):this.stopIdleTracking(a)}},a=>{console.error("Error subscribing to driver status:",a)})}static getActiveTrackings(){return Array.from(this.activeTracking.keys())}static stopAllIdleTracking(){this.activeTracking.forEach(a=>{a.stop()}),this.activeTracking.clear(),this.lastUpdateTimes.clear()}}class ax{static{this.DEFAULT_OPTIONS={prioritizeHighValue:!0,considerTraffic:!0,maxDeliveryTime:120,fuelEfficiency:12,fuelPrice:1200}}static async geocodeAddress(a){try{let b=this.hashAddress(a);return{lat:-33.4489+b%100*.001,lng:-70.6693+b%100*.001}}catch(a){return console.error("Error geocoding address:",a),null}}static hashAddress(a){let b=0;for(let c=0;c<a.length;c++)b=(b<<5)-b+a.charCodeAt(c),b&=b;return Math.abs(b)}static calculateDistance(a,b,c,d){let e=(c-a)*Math.PI/180,f=(d-b)*Math.PI/180,g=Math.sin(e/2)*Math.sin(e/2)+Math.cos(a*Math.PI/180)*Math.cos(c*Math.PI/180)*Math.sin(f/2)*Math.sin(f/2);return 2*Math.atan2(Math.sqrt(g),Math.sqrt(1-g))*6371}static optimizeRouteOrder(a,b,c,d){if(a.length<=1)return a;let e=[],f=[...a],g=b,h=c;for(d.prioritizeHighValue&&f.sort((a,b)=>{let c={high:3,medium:2,low:1},d=c[b.priority]-c[a.priority];return 0!==d?d:b.orderValue-a.orderValue});f.length>0;){let a=0,b=1/0;f.forEach((c,d)=>{if(!c.lat||!c.lng)return;let e=this.calculateDistance(g,h,c.lat,c.lng)*({high:.7,medium:1,low:1.3})[c.priority];e<b&&(b=e,a=d)});let c=f[a];e.push(c),f.splice(a,1),c.lat&&c.lng&&(g=c.lat,h=c.lng)}return e}static async convertOrdersToRoutePoints(a){let b=[];for(let c of a){let a=await this.geocodeAddress(c.deliveryInfo.address),d=this.calculateOrderPriority(c);b.push({id:`order-${c.id}`,address:c.deliveryInfo.address,lat:a?.lat,lng:a?.lng,orderId:c.id,customerName:c.customerName,estimatedDeliveryTime:this.estimateDeliveryTime(c),priority:d,orderValue:c.total})}return b}static calculateOrderPriority(a){let b=(Date.now()-a.createdAt.toDate().getTime())/6e4;return a.total>25e3||b>45?"high":a.total>15e3||b>20?"medium":"low"}static estimateDeliveryTime(a){return 15+2*a.dishes.reduce((a,b)=>a+b.quantity,0)}static async optimizeRoute(a,b,c={}){let d={...this.DEFAULT_OPTIONS,...c},e=await this.convertOrdersToRoutePoints(a),f=this.optimizeRouteOrder(e,b.lat,b.lng,d),{totalDistance:g,totalTime:h}=this.calculateRouteMetrics(f,b),i=g/d.fuelEfficiency*d.fuelPrice,j=this.calculateRouteEfficiency(f,g,h);return{points:f,totalDistance:Math.round(10*g)/10,totalTime:Math.round(h),estimatedFuelCost:Math.round(i),efficiency:Math.round(j)}}static calculateRouteMetrics(a,b){if(0===a.length)return{totalDistance:0,totalTime:0};let c=0,d=0,e=b.lat,f=b.lng;for(let b of a)if(b.lat&&b.lng){let a=this.calculateDistance(e,f,b.lat,b.lng);c+=a,d+=a/30*60+b.estimatedDeliveryTime,e=b.lat,f=b.lng}return{totalDistance:c,totalTime:d}}static calculateRouteEfficiency(a,b,c){if(0===a.length)return 100;let d=b/a.length,e=a.findIndex(a=>"high"===a.priority)/a.length,f=100;return d>5?f-=20:d>3&&(f-=10),e>.3&&(f-=15),c>120?f-=25:c>90&&(f-=15),Math.max(0,f)}static generateNavigationUrl(a,b=!0){if(0===a.length)return"";let c="current+location",d=encodeURIComponent(a[a.length-1].address),e=`https://www.google.com/maps/dir/${c}/${d}`;if(b&&a.length>2){let b=a.slice(0,-1).map(a=>encodeURIComponent(a.address)).join("/");e=`https://www.google.com/maps/dir/${c}/${b}/${d}`}return e}static getEstimatedArrivalTimes(a){let b=new Map,c=new Date,d=0;for(let e of a.points){d+=15;let a=new Date(c.getTime()+6e4*d);b.set(e.orderId,a),d+=e.estimatedDeliveryTime}return b}}var ay=c(72542);function az(){let a,b=(0,f.useRouter)(),{user:c,logout:k}=(0,g.A)(),[l,n]=(0,e.useState)(!0),[o,p]=(0,e.useState)(null),[r,u]=(0,e.useState)([]),[v,w]=(0,e.useState)(!1),[x,y]=(0,e.useState)(!1),[z,A]=(0,e.useState)([]),[B,ag]=(0,e.useState)("dashboard"),[ah,ai]=(0,e.useState)("available"),[aj,al]=(0,e.useState)(null),[an,ao]=(0,e.useState)(!1),[ap,aq]=(0,e.useState)({prioritizeHighValue:!0,considerTraffic:!0,maxDeliveryTime:120}),[ar,at]=(0,e.useState)({totalEarnings:0,todayEarnings:0,weekEarnings:0,monthEarnings:0,totalDeliveries:0,todayDeliveries:0,weekDeliveries:0,monthDeliveries:0,averageRating:5,completionRate:100,totalDistance:"0 km",onlineTime:"0h 0m",averageDeliveryTime:25,customerSatisfactionRate:98,onTimeDeliveryRate:95,fuelEfficiency:"12.5 km/L"}),[av,az]=(0,e.useState)(!1),[aA,aB]=(0,e.useState)(!1),[aC,aD]=(0,e.useState)("Ubicaci\xf3n no disponible"),[aE,aF]=(0,e.useState)(new Map),[aG,aH]=(0,e.useState)(new Map),[aI,aJ]=(0,e.useState)(!1),[aK,aL]=(0,e.useState)(null),[aM,aN]=(0,e.useState)(null),[aO,aP]=(0,e.useState)(!1),[aQ,aR]=(0,e.useState)(null),[aS,aT]=(0,e.useState)(null),aU=(0,e.useCallback)(async()=>{if(c){n(!0);try{let a=await h.DriversService.getDriverById(c.uid);if(!a){console.log("DriverDashboard: No driver profile found, showing onboarding"),w(!0),n(!1);return}if(!(a.displayName&&a.phone&&a.vehicleType&&a.workingDays?.length>0)){console.log("DriverDashboard: Driver profile incomplete, showing onboarding. Missing:",{displayName:!a.displayName,phone:!a.phone,vehicleType:!a.vehicleType,workingDays:!a.workingDays?.length}),w(!0),n(!1);return}if(console.log("DriverDashboard: Driver profile is complete, proceeding with dashboard"),p(a),y(!0),!a){let b={displayName:c.displayName||"Conductor",email:c.email||"",avatar:c.photoURL||"",phone:"",vehicleType:"motorcycle",vehicleInfo:{make:"",model:"",year:new Date().getFullYear(),licensePlate:"",color:""},isOnline:!1,isAvailable:!1,rating:5,reviewCount:0,totalDeliveries:0,completionRate:100,earnings:{today:0,thisWeek:0,thisMonth:0,total:0},workingHours:{start:"08:00",end:"22:00"},workingDays:["monday","tuesday","wednesday","thursday","friday","saturday","sunday"]};if(!await h.DriversService.createDriverProfile(b,c.uid))return void console.error("Failed to create driver profile");if(!(a=await h.DriversService.getDriverById(c.uid)))return void console.error("Failed to load created driver profile")}p(a),az(a?.isOnline||!1),a?.currentLocation?.address?.city&&aD(a.currentLocation.address.city),await aW(),await aX()}catch(a){console.error("Error loading driver data:",a),i.oR.error("Error al cargar datos del conductor")}finally{n(!1)}}},[c]),aV=(0,e.useCallback)(()=>{w(!1),c?.uid&&aU()},[c?.uid,aU]),aW=async()=>{if(!c)return},aX=async()=>{try{let[a,b]=await Promise.all([h.CooksService.getAllCooks(),h.DishesService.getAllDishes()]),c=new Map(a.map(a=>[a.id,a])),d=new Map(b.map(a=>[a.id,a]));aF(c),aH(d)}catch(a){console.error("Error loading reference data:",a)}},aY=async()=>{if(c&&o){aB(!0);try{let a=!av;if(await h.DriversService.updateDriverProfile(c.uid,{isOnline:a,isAvailable:a}))if(az(a),p(b=>b?{...b,isOnline:a,isAvailable:a}:null),a){let a=aw.startIdleTracking(c.uid,o?.displayName||c.displayName||"Conductor");aR(a),i.oR.success("\xa1Est\xe1s en l\xednea! Los pedidos comenzar\xe1n a aparecer.")}else aQ&&(aQ.stop(),aR(null)),i.oR.success("Ahora est\xe1s fuera de l\xednea");else i.oR.error("Error al actualizar el estado")}catch(a){console.error("Error toggling online status:",a),i.oR.error("Error al cambiar el estado")}finally{aB(!1)}}},aZ=async(a,b)=>{try{let d={status:b};if("delivered"===b&&(d.actualDeliveryTime=new Date,d.isDelivered=!0),await h.OrdersService.updateOrder(a,d)){if(i.oR.success(`Estado del pedido actualizado a ${a2(b)}`),"delivered"===b&&(i.oR.success("\xa1Entrega completada! Las ganancias se han actualizado.",{duration:4e3}),av&&c&&o&&!aQ)){let a=aw.startIdleTracking(c.uid,o.displayName||c.displayName||"Conductor");aR(a)}}else i.oR.error("Error al actualizar el estado del pedido")}catch(a){console.error("Error updating order status:",a),i.oR.error("Error al actualizar el estado del pedido")}},a$=async a=>{if(c)try{await h.OrdersService.assignOrderToDriver(a,c.uid)?(aQ&&(aQ.stop(),aR(null)),aP(!0),ag("dashboard"),i.oR.success("\xa1Pedido aceptado!",{description:"Sigue la gu\xeda paso a paso para completar la entrega.",duration:4e3})):i.oR.error(`Error al aceptar el pedido ${a}`)}catch(a){console.error("Error accepting order:",a),i.oR.error("Error al aceptar el pedido")}},a_=async a=>{if(c)try{if(!navigator.geolocation)return void i.oR.error("Geolocalizaci\xf3n no disponible");i.oR.info("Obteniendo ubicaci\xf3n..."),navigator.geolocation.getCurrentPosition(async b=>{let{latitude:c,longitude:d}=b.coords;await h.OrdersService.startDeliveryTracking(a,{latitude:c,longitude:d,accuracy:b.coords.accuracy,heading:b.coords.heading||void 0,speed:b.coords.speed||void 0})?(i.oR.success("\xa1Viaje iniciado! El cliente puede seguir tu ubicaci\xf3n."),a0(a)):i.oR.error("Error al iniciar el seguimiento")},a=>{console.error("Geolocation error:",a),i.oR.error("No se pudo obtener la ubicaci\xf3n. Verifica los permisos.")},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})}catch(a){console.error("Error starting delivery tracking:",a),i.oR.error("Error al iniciar el viaje")}},a0=a=>{aS&&navigator.geolocation.clearWatch(aS),aT(navigator.geolocation.watchPosition(async b=>{let{latitude:c,longitude:d}=b.coords;try{await h.OrdersService.updateDriverLocation(a,{latitude:c,longitude:d,accuracy:b.coords.accuracy,heading:b.coords.heading||void 0,speed:b.coords.speed||void 0})}catch(a){console.error("Error updating driver location:",a)}},a=>{console.error("Location tracking error:",a)},{enableHighAccuracy:!0,timeout:15e3,maximumAge:5e3}))},a1=a=>{switch(a){case"pending":case"en_viaje":return"bg-blue-100 text-blue-800";case"accepted":return"bg-yellow-100 text-yellow-800";case"preparing":return"bg-orange-100 text-orange-800";case"ready":return"bg-purple-100 text-purple-800";case"delivering":return"bg-indigo-100 text-indigo-800";case"delivered":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},a2=a=>{switch(a){case"pending":return"Pendiente";case"accepted":return"Aceptado";case"preparing":return"Preparando";case"ready":return"Listo";case"delivering":return"Entregando";case"en_viaje":return"En Viaje";case"delivered":return"Entregado";case"cancelled":return"Cancelado";default:return"Desconocido"}},a3=async()=>{if(!c||0===z.length)return void i.oR.error("No hay \xf3rdenes disponibles para optimizar");ao(!0);try{let a=await ax.optimizeRoute(z,{lat:-33.4489,lng:-70.6693},ap);al(a),i.oR.success(`Ruta optimizada para ${a.points.length} entregas`)}catch(a){console.error("Error optimizing route:",a),i.oR.error("Error al optimizar la ruta")}finally{ao(!1)}},a4=async()=>{if(!aj||!c)return void i.oR.error("No hay ruta optimizada disponible");try{let a=aj.points.map(a=>h.OrdersService.assignOrderToDriver(a.orderId,c.uid)),b=(await Promise.all(a)).filter(Boolean).length;b>0?(i.oR.success(`${b} \xf3rdenes aceptadas y asignadas`),al(null)):i.oR.error("Error al aceptar las \xf3rdenes")}catch(a){console.error("Error accepting optimized orders:",a),i.oR.error("Error al aceptar las \xf3rdenes optimizadas")}};return l?(0,d.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto mb-4"}),(0,d.jsx)("p",{className:"text-gray-600",children:"Cargando dashboard..."})]})}):v?(0,d.jsx)(C,{onComplete:aV}):c?aM?(0,d.jsx)(as,{activeOrder:aM,onBackToDashboard:()=>aN(null)}):(0,d.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,d.jsx)("div",{className:"bg-white shadow-sm border-b",children:(0,d.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,d.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,d.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,d.jsx)(s.A,{className:"h-8 w-8 text-orange-500"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"Dashboard del Conductor"}),(0,d.jsx)("p",{className:"text-sm text-gray-500",children:aC})]})]}),(0,d.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,d.jsxs)(j.$,{onClick:aY,disabled:aA,variant:av?"destructive":"default",className:`${av?"bg-green-600 hover:bg-green-700":"bg-gray-600 hover:bg-gray-700"}`,children:[aA?(0,d.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):(0,d.jsx)(H.A,{className:"h-4 w-4 mr-2"}),av?"En L\xednea":"Fuera de L\xednea"]}),(0,d.jsx)(G.U,{}),(0,d.jsxs)(F.eu,{children:[(0,d.jsx)(F.BK,{src:c.photoURL||"",alt:c.displayName||"Usuario"}),(0,d.jsx)(F.q5,{children:(c.displayName||c.email||"U").charAt(0).toUpperCase()})]}),(0,d.jsxs)(j.$,{onClick:k,variant:"outline",className:"hover:text-destructive",children:[(0,d.jsx)(I.A,{className:"h-4 w-4 mr-2"}),"Cerrar Sesi\xf3n"]})]})]})})}),(0,d.jsx)("div",{className:"bg-white border-b",children:(0,d.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,d.jsx)("div",{className:"flex space-x-8",children:[{id:"dashboard",label:"Dashboard",icon:J},{id:"orders",label:"\xd3rdenes",icon:K.A},{id:"earnings",label:"Ganancias",icon:L.A},{id:"performance",label:"Rendimiento",icon:M.A},{id:"navigation",label:"Navegaci\xf3n",icon:N}].map(a=>{let b=a.icon;return(0,d.jsxs)("button",{onClick:()=>ag(a.id),className:`flex items-center px-1 py-4 border-b-2 font-medium text-sm ${B===a.id?"border-orange-500 text-orange-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[(0,d.jsx)(b,{className:"w-4 h-4 mr-2"}),a.label]},a.id)})})})}),(0,d.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:["dashboard"===B&&(0,d.jsxs)(d.Fragment,{children:[aM&&aO&&(0,d.jsxs)("div",{className:"mb-8",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,d.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Gu\xeda de Entrega"}),(0,d.jsx)(j.$,{variant:"outline",size:"sm",onClick:()=>aP(!1),children:"Minimizar Gu\xeda"})]}),(0,d.jsx)(au,{order:aM,cook:aE.get(aM.cookerId),onStatusUpdate:aZ,onStartNavigation:a=>{let b=encodeURIComponent(a),c=`https://www.google.com/maps/search/?api=1&query=${b}`;window.open(c,"_blank"),i.oR.success("Navegaci\xf3n iniciada en Google Maps")},onCallCustomer:a=>{a?window.location.href=`tel:${a}`:i.oR.error("N\xfamero de tel\xe9fono no disponible")}})]}),aM&&!aO&&(0,d.jsx)(m.Zp,{className:"mb-6 bg-blue-50 border-blue-200",children:(0,d.jsx)(m.Wu,{className:"p-4",children:(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,d.jsx)("div",{className:"w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center",children:(0,d.jsx)(K.A,{className:"h-5 w-5 text-white"})}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("h3",{className:"font-semibold text-blue-900",children:["Tienes una entrega activa - Pedido #",aM.id.slice(-8)]}),(0,d.jsxs)("p",{className:"text-sm text-blue-700",children:["Estado: ",a2(aM.status)," • Cliente: ",aM.customerName]})]})]}),(0,d.jsxs)(j.$,{onClick:()=>aP(!0),className:"bg-blue-600 hover:bg-blue-700",children:[(0,d.jsx)(O.A,{className:"h-4 w-4 mr-2"}),"Ver Gu\xeda"]})]})})}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,d.jsxs)(m.Zp,{children:[(0,d.jsxs)(m.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,d.jsx)(m.ZB,{className:"text-sm font-medium",children:"Ganancias de Hoy"}),(0,d.jsx)(L.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,d.jsxs)(m.Wu,{children:[(0,d.jsxs)("div",{className:"text-2xl font-bold",children:["$",ar.todayEarnings.toLocaleString("es-CL")]}),(0,d.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Total: $",ar.totalEarnings.toLocaleString("es-CL")]})]})]}),(0,d.jsxs)(m.Zp,{children:[(0,d.jsxs)(m.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,d.jsx)(m.ZB,{className:"text-sm font-medium",children:"Entregas de Hoy"}),(0,d.jsx)(K.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,d.jsxs)(m.Wu,{children:[(0,d.jsx)("div",{className:"text-2xl font-bold",children:ar.todayDeliveries}),(0,d.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Total: ",ar.totalDeliveries]})]})]}),(0,d.jsxs)(m.Zp,{children:[(0,d.jsxs)(m.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,d.jsx)(m.ZB,{className:"text-sm font-medium",children:"Calificaci\xf3n"}),(0,d.jsx)(P.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,d.jsxs)(m.Wu,{children:[(0,d.jsx)("div",{className:"text-2xl font-bold",children:ar.averageRating.toFixed(1)}),(0,d.jsxs)("p",{className:"text-xs text-muted-foreground",children:[ar.completionRate,"% completado"]})]})]}),(0,d.jsxs)(m.Zp,{children:[(0,d.jsxs)(m.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,d.jsx)(m.ZB,{className:"text-sm font-medium",children:"Tiempo en L\xednea"}),(0,d.jsx)(Q.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,d.jsxs)(m.Wu,{children:[(0,d.jsx)("div",{className:"text-2xl font-bold",children:ar.onlineTime}),(0,d.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Distancia: ",ar.totalDistance]})]})]})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,d.jsx)("div",{children:(0,d.jsx)(am,{hasActiveDelivery:!!aM,isDriverOnline:av,onOrderAccepted:a=>{a$(a)}})}),(0,d.jsxs)(m.Zp,{children:[(0,d.jsx)(m.aR,{children:(0,d.jsxs)(m.ZB,{className:"flex items-center",children:[(0,d.jsx)(R.A,{className:"h-5 w-5 mr-2"}),"Mis Pedidos Activos"]})}),(0,d.jsx)(m.Wu,{children:0===r.filter(a=>a.driverId===c?.uid&&["accepted","preparing","ready","delivering"].includes(a.status)).length?(0,d.jsxs)("div",{className:"text-center py-8",children:[(0,d.jsx)(K.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,d.jsx)("p",{className:"text-gray-500",children:"No tienes pedidos activos asignados."}),(0,d.jsx)("p",{className:"text-sm text-gray-400 mt-2",children:"Acepta un pedido disponible para empezar a entregar."})]}):(0,d.jsx)("div",{className:"space-y-4",children:r.filter(a=>a.driverId===c?.uid&&["accepted","preparing","ready","delivering"].includes(a.status)).map(a=>{let c=aE.get(a.cookerId),e=aG.get(a.dishes[0]?.dishId||""),f=(a=>{switch(a){case"ready":return"Recoger";case"delivering":return"Iniciar Viaje";case"en_viaje":return"Entregar";default:return null}})(a.status),{progress:g,timeRemaining:h,totalPrepTime:i,isReady:k}=(a=>{if(!a.createdAt)return{progress:0,timeRemaining:"Calculando...",totalPrepTime:30,isReady:!1};let b=a.dishes.map(a=>({prepTime:a.prepTime||"30 min",quantity:a.quantity})),c=(0,af.Dm)(b),d=a.createdAt?.toDate()||new Date,e=(0,af.uA)(d,c),f=(0,af.$B)(d,c),g=e>=100||"ready"===a.status;return{progress:e,timeRemaining:f,totalPrepTime:c,isReady:g}})(a);return(0,d.jsxs)("div",{className:`border rounded-lg p-4 space-y-3 cursor-pointer hover:bg-gray-100 transition-colors ${k?"ring-2 ring-green-200 bg-green-50":""}`,onClick:()=>{aL(a),aJ(!0)},children:[(0,d.jsxs)("div",{className:"flex justify-between items-start",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h4",{className:"font-medium",children:e?.name||"Plato desconocido"}),(0,d.jsxs)("p",{className:"text-sm text-gray-600",children:["De: ",c?.displayName||"Cocinero desconocido"]}),(0,d.jsxs)("p",{className:"text-sm text-gray-600",children:["Para: ",a.customerName]})]}),(0,d.jsx)(D.E,{className:a1(a.status),children:a2(a.status)})]}),["accepted","preparing"].includes(a.status)&&(0,d.jsxs)("div",{className:"bg-white p-3 rounded-lg border",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(Q.A,{className:"h-4 w-4 text-muted-foreground"}),(0,d.jsx)("span",{className:"text-sm font-medium",children:"Progreso de preparaci\xf3n"})]}),(0,d.jsx)("span",{className:"text-sm font-mono font-bold",children:k?"\uD83D\uDFE2 LISTO":h})]}),(0,d.jsx)(E.k,{value:g,className:"h-2"}),(0,d.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground mt-1",children:[(0,d.jsxs)("span",{children:["Iniciado: ",a.createdAt?.toDate().toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"})]}),(0,d.jsxs)("span",{children:["Estimado: ",(0,af.bC)(a.createdAt?.toDate()||new Date,i).toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"})]})]})]}),a.dishes.length>1&&(0,d.jsxs)("div",{className:"bg-gray-50 p-3 rounded-lg",children:[(0,d.jsxs)("h4",{className:"font-medium text-sm mb-2 flex items-center gap-2",children:[(0,d.jsx)(K.A,{className:"h-4 w-4"}),"Platos (",a.dishes.length,")"]}),(0,d.jsx)("div",{className:"space-y-1",children:a.dishes.map((a,b)=>(0,d.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,d.jsxs)("span",{children:[a.dishName," x ",a.quantity]}),(0,d.jsx)("span",{className:"text-xs text-muted-foreground",children:a.prepTime||"30 min"})]},b))}),(0,d.jsxs)("div",{className:"text-xs text-muted-foreground mt-2 flex items-center gap-1",children:[(0,d.jsx)(Q.A,{className:"h-3 w-3"}),"Tiempo basado en el plato que toma m\xe1s tiempo"]})]}),(0,d.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[(0,d.jsxs)("span",{className:"flex items-center",children:[(0,d.jsx)(S.A,{className:"h-4 w-4 mr-1"}),a.deliveryInfo.address]}),(0,d.jsxs)("span",{className:"font-medium",children:["$",a.total.toLocaleString("es-CL")]})]}),f&&(0,d.jsx)(j.$,{onClick:c=>{c.stopPropagation(),"ready"===a.status?aZ(a.id,"delivering"):"delivering"===a.status?a_(a.id):"en_viaje"===a.status&&b.push("/driver/delivery-verification")},className:"w-full",size:"sm",children:f})]},a.id)})})})]}),(0,d.jsxs)(m.Zp,{children:[(0,d.jsx)(m.aR,{children:(0,d.jsxs)(m.ZB,{className:"flex items-center",children:[(0,d.jsx)(t.A,{className:"h-5 w-5 mr-2"}),"Pedidos Recientes"]})}),(0,d.jsx)(m.Wu,{children:0===r.filter(a=>"delivered"===a.status).length?(0,d.jsxs)("div",{className:"text-center py-8",children:[(0,d.jsx)(t.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,d.jsx)("p",{className:"text-gray-500",children:"No hay entregas recientes"}),(0,d.jsx)("p",{className:"text-sm text-gray-400 mt-2",children:"Tus entregas completadas aparecer\xe1n aqu\xed"})]}):(0,d.jsx)("div",{className:"space-y-4",children:r.filter(a=>"delivered"===a.status).slice(0,5).map(a=>{let b=aE.get(a.cookerId),c=aG.get(a.dishes[0]?.dishId||"");return(0,d.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,d.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("h4",{className:"font-medium",children:c?.name||"Plato desconocido"}),(0,d.jsx)("p",{className:"text-sm text-gray-600",children:b?.displayName||"Cocinero desconocido"})]}),(0,d.jsx)(D.E,{className:"bg-green-100 text-green-800",children:"Entregado"})]}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,d.jsxs)("span",{className:"flex items-center text-gray-600",children:[(0,d.jsx)(R.A,{className:"h-4 w-4 mr-1"}),a.actualDeliveryTime?.toDate?.()?.toLocaleDateString("es-CL")||a.createdAt?.toDate?.()?.toLocaleDateString("es-CL")||"Fecha no disponible"]}),(0,d.jsxs)("div",{className:"text-right",children:[(0,d.jsxs)("span",{className:"text-green-600 font-medium",children:["+$",(a.deliveryFee||2500).toLocaleString("es-CL")]}),(0,d.jsx)("p",{className:"text-xs text-gray-500",children:"Ganancia por entrega"})]})]}),a.actualDeliveryTime&&(0,d.jsxs)("div",{className:"text-xs text-gray-500",children:["Completado: ",a.actualDeliveryTime?.toDate()?.toLocaleTimeString("es-CL",{hour:"2-digit",minute:"2-digit"})||"N/A"]})]})]},a.id)})})})]})]})]}),"earnings"===B&&(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,d.jsxs)(m.Zp,{children:[(0,d.jsx)(m.aR,{children:(0,d.jsxs)(m.ZB,{className:"flex items-center",children:[(0,d.jsx)(L.A,{className:"h-5 w-5 mr-2 text-green-600"}),"Ganancias de Hoy"]})}),(0,d.jsxs)(m.Wu,{children:[(0,d.jsxs)("div",{className:"text-3xl font-bold text-green-600",children:["$",ar.todayEarnings.toLocaleString("es-CL")]}),(0,d.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:[ar.todayDeliveries," entregas realizadas"]})]})]}),(0,d.jsxs)(m.Zp,{children:[(0,d.jsx)(m.aR,{children:(0,d.jsxs)(m.ZB,{className:"flex items-center",children:[(0,d.jsx)(T.A,{className:"h-5 w-5 mr-2 text-blue-600"}),"Esta Semana"]})}),(0,d.jsxs)(m.Wu,{children:[(0,d.jsxs)("div",{className:"text-3xl font-bold text-blue-600",children:["$",ar.weekEarnings.toLocaleString("es-CL")]}),(0,d.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:[ar.weekDeliveries," entregas esta semana"]})]})]}),(0,d.jsxs)(m.Zp,{children:[(0,d.jsx)(m.aR,{children:(0,d.jsxs)(m.ZB,{className:"flex items-center",children:[(0,d.jsx)(U.A,{className:"h-5 w-5 mr-2 text-purple-600"}),"Este Mes"]})}),(0,d.jsxs)(m.Wu,{children:[(0,d.jsxs)("div",{className:"text-3xl font-bold text-purple-600",children:["$",ar.monthEarnings.toLocaleString("es-CL")]}),(0,d.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:[ar.monthDeliveries," entregas este mes"]})]})]})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,d.jsxs)(m.Zp,{children:[(0,d.jsx)(m.aR,{children:(0,d.jsx)(m.ZB,{children:"Desglose de Ganancias"})}),(0,d.jsx)(m.Wu,{children:(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[(0,d.jsx)("span",{className:"text-sm font-medium",children:"Tarifas base de entrega"}),(0,d.jsxs)("span",{className:"font-semibold",children:["$",(.8*ar.todayEarnings).toLocaleString("es-CL")]})]}),(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[(0,d.jsx)("span",{className:"text-sm font-medium",children:"Propinas"}),(0,d.jsxs)("span",{className:"font-semibold",children:["$",(.15*ar.todayEarnings).toLocaleString("es-CL")]})]}),(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[(0,d.jsx)("span",{className:"text-sm font-medium",children:"Bonificaciones"}),(0,d.jsxs)("span",{className:"font-semibold",children:["$",(.05*ar.todayEarnings).toLocaleString("es-CL")]})]}),(0,d.jsx)("div",{className:"border-t pt-2",children:(0,d.jsxs)("div",{className:"flex justify-between items-center font-semibold",children:[(0,d.jsx)("span",{children:"Total del d\xeda"}),(0,d.jsxs)("span",{className:"text-green-600",children:["$",ar.todayEarnings.toLocaleString("es-CL")]})]})})]})})]}),(0,d.jsxs)(m.Zp,{children:[(0,d.jsx)(m.aR,{children:(0,d.jsx)(m.ZB,{children:"Estad\xedsticas de Ganancias"})}),(0,d.jsx)(m.Wu,{children:(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[(0,d.jsx)("span",{className:"text-sm font-medium",children:"Ganancia promedio por entrega"}),(0,d.jsxs)("span",{className:"font-semibold",children:["$",ar.totalDeliveries>0?(ar.totalEarnings/ar.totalDeliveries).toLocaleString("es-CL"):"0"]})]}),(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[(0,d.jsx)("span",{className:"text-sm font-medium",children:"Entregas por hora (promedio)"}),(0,d.jsx)("span",{className:"font-semibold",children:"2.3"})]}),(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[(0,d.jsx)("span",{className:"text-sm font-medium",children:"Ganancia por hora"}),(0,d.jsx)("span",{className:"font-semibold",children:"$5,750"})]}),(0,d.jsxs)("div",{className:"flex justify-between items-center",children:[(0,d.jsx)("span",{className:"text-sm font-medium",children:"Mejor d\xeda del mes"}),(0,d.jsx)("span",{className:"font-semibold text-green-600",children:"$18,500"})]})]})})]})]})]}),"performance"===B&&(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,d.jsxs)(m.Zp,{children:[(0,d.jsx)(m.aR,{children:(0,d.jsxs)(m.ZB,{className:"flex items-center",children:[(0,d.jsx)(R.A,{className:"h-5 w-5 mr-2 text-blue-600"}),"Tiempo Promedio"]})}),(0,d.jsxs)(m.Wu,{children:[(0,d.jsxs)("div",{className:"text-2xl font-bold",children:[ar.averageDeliveryTime," min"]}),(0,d.jsx)("p",{className:"text-sm text-muted-foreground",children:"Por entrega"})]})]}),(0,d.jsxs)(m.Zp,{children:[(0,d.jsx)(m.aR,{children:(0,d.jsxs)(m.ZB,{className:"flex items-center",children:[(0,d.jsx)(M.A,{className:"h-5 w-5 mr-2 text-green-600"}),"Entregas a Tiempo"]})}),(0,d.jsxs)(m.Wu,{children:[(0,d.jsxs)("div",{className:"text-2xl font-bold",children:[ar.onTimeDeliveryRate,"%"]}),(0,d.jsx)("p",{className:"text-sm text-muted-foreground",children:"Puntualidad"})]})]}),(0,d.jsxs)(m.Zp,{children:[(0,d.jsx)(m.aR,{children:(0,d.jsxs)(m.ZB,{className:"flex items-center",children:[(0,d.jsx)(V.A,{className:"h-5 w-5 mr-2 text-purple-600"}),"Satisfacci\xf3n Cliente"]})}),(0,d.jsxs)(m.Wu,{children:[(0,d.jsxs)("div",{className:"text-2xl font-bold",children:[ar.customerSatisfactionRate,"%"]}),(0,d.jsx)("p",{className:"text-sm text-muted-foreground",children:"Calificaci\xf3n promedio"})]})]}),(0,d.jsxs)(m.Zp,{children:[(0,d.jsx)(m.aR,{children:(0,d.jsxs)(m.ZB,{className:"flex items-center",children:[(0,d.jsx)(W,{className:"h-5 w-5 mr-2 text-orange-600"}),"Eficiencia"]})}),(0,d.jsxs)(m.Wu,{children:[(0,d.jsx)("div",{className:"text-2xl font-bold",children:ar.fuelEfficiency}),(0,d.jsx)("p",{className:"text-sm text-muted-foreground",children:"Consumo combustible"})]})]})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,d.jsxs)(m.Zp,{children:[(0,d.jsx)(m.aR,{children:(0,d.jsxs)(m.ZB,{className:"flex items-center",children:[(0,d.jsx)(X.A,{className:"h-5 w-5 mr-2"}),"Logros y Metas"]})}),(0,d.jsx)(m.Wu,{children:(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(Y,{className:"h-5 w-5 mr-2 text-green-600"}),(0,d.jsx)("span",{className:"text-sm font-medium",children:"Conductor Confiable"})]}),(0,d.jsx)(D.E,{className:"bg-green-100 text-green-800",children:"Conseguido"})]}),(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(P.A,{className:"h-5 w-5 mr-2 text-yellow-600"}),(0,d.jsx)("span",{className:"text-sm font-medium",children:"5 Estrellas"})]}),(0,d.jsx)(D.E,{className:"bg-yellow-100 text-yellow-800",children:"Conseguido"})]}),(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(K.A,{className:"h-5 w-5 mr-2 text-blue-600"}),(0,d.jsx)("span",{className:"text-sm font-medium",children:"100 Entregas"})]}),(0,d.jsx)(D.E,{variant:"outline",children:"En Progreso"})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,d.jsx)("span",{children:"Progreso hacia 100 entregas"}),(0,d.jsxs)("span",{children:[ar.totalDeliveries,"/100"]})]}),(0,d.jsx)(E.k,{value:ar.totalDeliveries/100*100,className:"h-2"})]})]})})]}),(0,d.jsxs)(m.Zp,{children:[(0,d.jsx)(m.aR,{children:(0,d.jsxs)(m.ZB,{className:"flex items-center",children:[(0,d.jsx)(Z.A,{className:"h-5 w-5 mr-2"}),"M\xe9tricas de Rendimiento"]})}),(0,d.jsx)(m.Wu,{children:(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,d.jsx)("span",{children:"Puntualidad"}),(0,d.jsxs)("span",{children:[ar.onTimeDeliveryRate,"%"]})]}),(0,d.jsx)(E.k,{value:ar.onTimeDeliveryRate,className:"h-2"})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,d.jsx)("span",{children:"Tasa de Aceptaci\xf3n"}),(0,d.jsxs)("span",{children:[ar.completionRate,"%"]})]}),(0,d.jsx)(E.k,{value:ar.completionRate,className:"h-2"})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,d.jsx)("span",{children:"Satisfacci\xf3n del Cliente"}),(0,d.jsxs)("span",{children:[ar.customerSatisfactionRate,"%"]})]}),(0,d.jsx)(E.k,{value:ar.customerSatisfactionRate,className:"h-2"})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,d.jsx)("span",{children:"Calificaci\xf3n General"}),(0,d.jsxs)("span",{children:[ar.averageRating.toFixed(1),"/5.0"]})]}),(0,d.jsx)(E.k,{value:ar.averageRating/5*100,className:"h-2"})]})]})})]})]})]}),"navigation"===B&&(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,d.jsxs)(m.Zp,{className:"lg:col-span-2",children:[(0,d.jsx)(m.aR,{children:(0,d.jsxs)(m.ZB,{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(N,{className:"h-5 w-5 mr-2"}),"\xd3rdenes Disponibles (",z.length,")"]}),(0,d.jsx)(j.$,{onClick:a3,disabled:an||0===z.length,className:"bg-orange-600 hover:bg-orange-700",children:an?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)($.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Optimizando..."]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(q.A,{className:"h-4 w-4 mr-2"}),"Optimizar Ruta"]})})]})}),(0,d.jsx)(m.Wu,{children:0===z.length?(0,d.jsxs)("div",{className:"text-center py-8",children:[(0,d.jsx)(K.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,d.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay \xf3rdenes disponibles"}),(0,d.jsx)("p",{className:"text-gray-500",children:"Las \xf3rdenes listas para entrega aparecer\xe1n aqu\xed para ser optimizadas."})]}):(0,d.jsx)("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:z.map(a=>{let b=aE[a.cookerId];return(0,d.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,d.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,d.jsx)("div",{className:"w-8 h-8 bg-orange-100 rounded-full flex items-center justify-center",children:(0,d.jsx)(K.A,{className:"h-4 w-4 text-orange-600"})}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("h4",{className:"font-medium text-sm",children:["#",a.id.slice(-8)]}),(0,d.jsxs)("p",{className:"text-xs text-gray-500",children:[b?b.businessName:"Cocinero"," • ",a.customerName]})]})]}),(0,d.jsxs)("div",{className:"text-right",children:[(0,d.jsxs)("p",{className:"font-medium text-sm",children:["$",a.total.toLocaleString("es-CL")]}),(0,d.jsxs)("p",{className:"text-xs text-gray-500",children:[a.deliveryInfo.address.slice(0,30),"..."]})]})]},a.id)})})})]}),(0,d.jsxs)(m.Zp,{children:[(0,d.jsx)(m.aR,{children:(0,d.jsxs)(m.ZB,{className:"flex items-center",children:[(0,d.jsx)(_.A,{className:"h-5 w-5 mr-2"}),"Configuraci\xf3n"]})}),(0,d.jsx)(m.Wu,{children:(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("label",{className:"text-sm font-medium",children:"Priorizar Pedidos Costosos"}),(0,d.jsx)("input",{type:"checkbox",checked:ap.prioritizeHighValue,onChange:a=>aq({...ap,prioritizeHighValue:a.target.checked}),className:"rounded"})]}),(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsx)("label",{className:"text-sm font-medium",children:"Considerar Tr\xe1fico"}),(0,d.jsx)("input",{type:"checkbox",checked:ap.considerTraffic,onChange:a=>aq({...ap,considerTraffic:a.target.checked}),className:"rounded"})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("label",{className:"text-sm font-medium block mb-2",children:["Tiempo M\xe1ximo (min): ",ap.maxDeliveryTime]}),(0,d.jsx)("input",{type:"range",min:"60",max:"180",value:ap.maxDeliveryTime,onChange:a=>aq({...ap,maxDeliveryTime:parseInt(a.target.value)}),className:"w-full"})]})]})})]})]}),aj&&(0,d.jsxs)(m.Zp,{children:[(0,d.jsx)(m.aR,{children:(0,d.jsxs)(m.ZB,{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(aa,{className:"h-5 w-5 mr-2"}),"Ruta Optimizada"]}),(0,d.jsxs)("div",{className:"flex space-x-2",children:[(0,d.jsxs)(j.$,{variant:"outline",onClick:()=>{if(!aj||0===aj.points.length)return void i.oR.error("Primero optimiza la ruta");let a=ax.generateNavigationUrl(aj.points,!0);a?(window.open(a,"_blank"),i.oR.success("Navegaci\xf3n iniciada en Google Maps")):i.oR.error("Error al generar la URL de navegaci\xf3n")},className:"text-blue-600 border-blue-600 hover:bg-blue-50",children:[(0,d.jsx)(ab.A,{className:"h-4 w-4 mr-2"}),"Navegar"]}),(0,d.jsxs)(j.$,{onClick:a4,className:"bg-green-600 hover:bg-green-700",children:[(0,d.jsx)(t.A,{className:"h-4 w-4 mr-2"}),"Aceptar Todas"]})]})]})}),(0,d.jsxs)(m.Wu,{children:[(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,d.jsxs)("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[(0,d.jsx)(N,{className:"h-6 w-6 text-blue-600 mx-auto mb-2"}),(0,d.jsx)("p",{className:"text-sm text-gray-600",children:"Total Entregas"}),(0,d.jsx)("p",{className:"text-lg font-bold text-blue-600",children:aj.points.length})]}),(0,d.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,d.jsx)(H.A,{className:"h-6 w-6 text-green-600 mx-auto mb-2"}),(0,d.jsx)("p",{className:"text-sm text-gray-600",children:"Distancia"}),(0,d.jsxs)("p",{className:"text-lg font-bold text-green-600",children:[aj.totalDistance," km"]})]}),(0,d.jsxs)("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[(0,d.jsx)(R.A,{className:"h-6 w-6 text-orange-600 mx-auto mb-2"}),(0,d.jsx)("p",{className:"text-sm text-gray-600",children:"Tiempo Total"}),(0,d.jsxs)("p",{className:"text-lg font-bold text-orange-600",children:[Math.round(aj.totalTime)," min"]})]}),(0,d.jsxs)("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[(0,d.jsx)(W,{className:"h-6 w-6 text-purple-600 mx-auto mb-2"}),(0,d.jsx)("p",{className:"text-sm text-gray-600",children:"Costo Combustible"}),(0,d.jsxs)("p",{className:"text-lg font-bold text-purple-600",children:["$",aj.estimatedFuelCost]})]})]}),(0,d.jsxs)("div",{className:"mb-6",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,d.jsx)("span",{className:"text-sm font-medium",children:"Eficiencia de la Ruta"}),(0,d.jsxs)("span",{className:"text-sm font-bold",children:[aj.efficiency,"%"]})]}),(0,d.jsx)(E.k,{value:aj.efficiency,className:"h-2"}),(0,d.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:aj.efficiency>=80?"\xa1Excelente optimizaci\xf3n!":aj.efficiency>=60?"Buena optimizaci\xf3n":"Ruta poco eficiente"})]}),(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsx)("h4",{className:"font-medium text-gray-900",children:"Secuencia de Entregas:"}),aj.points.map((a,b)=>{let c=z.find(b=>b.id===a.orderId),e=c?aE[c.cookerId]:null;return(0,d.jsxs)("div",{className:"flex items-center space-x-4 p-3 bg-gray-50 rounded-lg",children:[(0,d.jsx)("div",{className:"flex-shrink-0 w-8 h-8 bg-orange-600 text-white rounded-full flex items-center justify-center text-sm font-bold",children:b+1}),(0,d.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)("h5",{className:"font-medium text-sm truncate",children:["Pedido #",a.orderId.slice(-8)]}),(0,d.jsxs)("p",{className:"text-xs text-gray-500",children:[e?e.businessName:"Cocinero"," → ",a.customerName]})]}),(0,d.jsxs)("div",{className:"text-right",children:[(0,d.jsxs)("p",{className:"text-sm font-medium",children:["$",a.orderValue.toLocaleString("es-CL")]}),(0,d.jsxs)(D.E,{className:`text-xs ${"high"===a.priority?"bg-red-100 text-red-800":"medium"===a.priority?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:["high"===a.priority?"Alta":"medium"===a.priority?"Media":"Baja"," Prioridad"]})]})]}),(0,d.jsxs)("div",{className:"flex items-center mt-2",children:[(0,d.jsx)(S.A,{className:"h-3 w-3 text-gray-400 mr-1"}),(0,d.jsx)("p",{className:"text-xs text-gray-600 truncate",children:a.address})]}),(0,d.jsxs)("div",{className:"flex items-center mt-1",children:[(0,d.jsx)(R.A,{className:"h-3 w-3 text-gray-400 mr-1"}),(0,d.jsxs)("p",{className:"text-xs text-gray-500",children:["~",Math.round(a.estimatedDeliveryTime)," min de entrega"]})]})]}),(0,d.jsx)("div",{className:"flex-shrink-0",children:(0,d.jsx)(j.$,{variant:"outline",size:"sm",onClick:()=>{let b=encodeURIComponent(a.address);window.open(`https://www.google.com/maps/search/?api=1&query=${b}`,"_blank")},children:(0,d.jsx)(H.A,{className:"h-3 w-3"})})}),b<aj.points.length-1&&(0,d.jsx)("div",{className:"absolute left-4 mt-12 w-0.5 h-6 bg-gray-300"})]},a.id)})]}),aj.totalTime>120&&(0,d.jsx)("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(ac.A,{className:"h-4 w-4 text-yellow-600 mr-2"}),(0,d.jsx)("p",{className:"text-sm text-yellow-800",children:"Esta ruta tomar\xe1 m\xe1s de 2 horas. Considera dividir las entregas en m\xfaltiples viajes."})]})})]})]}),!aj&&z.length>0&&(0,d.jsxs)(m.Zp,{children:[(0,d.jsx)(m.aR,{children:(0,d.jsx)(m.ZB,{className:"text-lg",children:"\xbfC\xf3mo usar la optimizaci\xf3n de rutas?"})}),(0,d.jsxs)(m.Wu,{children:[(0,d.jsxs)("div",{className:"space-y-3 text-sm text-gray-600",children:[(0,d.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,d.jsx)("div",{className:"w-6 h-6 bg-orange-600 text-white rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0",children:"1"}),(0,d.jsx)("span",{children:"Configura las preferencias de optimizaci\xf3n (prioridad, tr\xe1fico, tiempo m\xe1ximo)"})]}),(0,d.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,d.jsx)("div",{className:"w-6 h-6 bg-orange-600 text-white rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0",children:"2"}),(0,d.jsx)("span",{children:'Presiona "Optimizar Ruta" para calcular la mejor secuencia de entregas'})]}),(0,d.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,d.jsx)("div",{className:"w-6 h-6 bg-orange-600 text-white rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0",children:"3"}),(0,d.jsx)("span",{children:"Revisa la ruta propuesta, m\xe9tricas de eficiencia y secuencia de entregas"})]}),(0,d.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,d.jsx)("div",{className:"w-6 h-6 bg-orange-600 text-white rounded-full flex items-center justify-center text-xs font-bold flex-shrink-0",children:"4"}),(0,d.jsx)("span",{children:"Acepta todas las \xf3rdenes de la ruta optimizada o navega individualmente"})]})]}),(0,d.jsxs)("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[(0,d.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"Beneficios de la optimizaci\xf3n:"}),(0,d.jsxs)("ul",{className:"text-sm text-blue-800 space-y-1",children:[(0,d.jsx)("li",{children:"• Reduce distancia total y tiempo de entrega"}),(0,d.jsx)("li",{children:"• Prioriza pedidos de alto valor y urgencia"}),(0,d.jsx)("li",{children:"• Minimiza costos de combustible"}),(0,d.jsx)("li",{children:"• Mejora eficiencia y satisfacci\xf3n del cliente"})]})]})]})]})]}),"orders"===B&&(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,d.jsxs)(m.Zp,{children:[(0,d.jsx)(m.aR,{children:(0,d.jsxs)(m.ZB,{className:"flex items-center",children:[(0,d.jsx)(K.A,{className:"h-5 w-5 mr-2 text-blue-600"}),"Disponibles"]})}),(0,d.jsxs)(m.Wu,{children:[(0,d.jsx)("div",{className:"text-2xl font-bold",children:z.length}),(0,d.jsx)("p",{className:"text-sm text-muted-foreground",children:"\xd3rdenes disponibles"})]})]}),(0,d.jsxs)(m.Zp,{children:[(0,d.jsx)(m.aR,{children:(0,d.jsxs)(m.ZB,{className:"flex items-center",children:[(0,d.jsx)(R.A,{className:"h-5 w-5 mr-2 text-orange-600"}),"En Progreso"]})}),(0,d.jsxs)(m.Wu,{children:[(0,d.jsx)("div",{className:"text-2xl font-bold",children:r.filter(a=>["accepted","preparing","ready","delivering"].includes(a.status)).length}),(0,d.jsx)("p",{className:"text-sm text-muted-foreground",children:"\xd3rdenes activas"})]})]}),(0,d.jsxs)(m.Zp,{children:[(0,d.jsx)(m.aR,{children:(0,d.jsxs)(m.ZB,{className:"flex items-center",children:[(0,d.jsx)(t.A,{className:"h-5 w-5 mr-2 text-green-600"}),"Completadas Hoy"]})}),(0,d.jsxs)(m.Wu,{children:[(0,d.jsx)("div",{className:"text-2xl font-bold",children:ar.todayDeliveries}),(0,d.jsx)("p",{className:"text-sm text-muted-foreground",children:"Entregas de hoy"})]})]})]}),(0,d.jsx)("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg w-fit",children:[{id:"available",label:"Disponibles",count:z.length},{id:"active",label:"Activas",count:r.filter(a=>["accepted","preparing","ready","delivering"].includes(a.status)&&a.driverId===c?.uid).length},{id:"completed",label:"Completadas",count:r.filter(a=>"delivered"===a.status&&a.driverId===c?.uid).length}].map(a=>(0,d.jsxs)("button",{onClick:()=>ai(a.id),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${ah===a.id?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[a.label," (",a.count,")"]},a.id))}),(0,d.jsx)("div",{className:"grid gap-4",children:(a=[],("available"===ah?a=z:"active"===ah?a=r.filter(a=>["accepted","preparing","ready","delivering"].includes(a.status)&&a.driverId===c?.uid):"completed"===ah&&(a=r.filter(a=>"delivered"===a.status&&a.driverId===c?.uid).slice(0,10)),0===a.length)?(0,d.jsx)(m.Zp,{children:(0,d.jsxs)(m.Wu,{className:"flex flex-col items-center justify-center py-12",children:[(0,d.jsx)(K.A,{className:"h-12 w-12 text-gray-400 mb-4"}),(0,d.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:["available"===ah&&"No hay \xf3rdenes disponibles","active"===ah&&"No tienes \xf3rdenes activas","completed"===ah&&"No has completado entregas hoy"]}),(0,d.jsxs)("p",{className:"text-gray-500 text-center max-w-sm",children:["available"===ah&&"Las nuevas \xf3rdenes aparecer\xe1n aqu\xed cuando est\xe9n listas para entrega.","active"===ah&&"Las \xf3rdenes que aceptes aparecer\xe1n aqu\xed.","completed"===ah&&"Tus entregas completadas aparecer\xe1n aqu\xed."]})]})}):a.map(a=>{let b=aE[a.cookerId],c=a.dishes.reduce((a,b)=>a+b.quantity,0);return(0,d.jsx)(m.Zp,{className:"hover:shadow-md transition-shadow",children:(0,d.jsx)(m.Wu,{className:"p-6",children:(0,d.jsx)("div",{className:"flex items-start justify-between",children:(0,d.jsxs)("div",{className:"flex-1 space-y-3",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between",children:[(0,d.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,d.jsx)("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center",children:(0,d.jsx)(K.A,{className:"h-5 w-5 text-orange-600"})}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("h3",{className:"font-semibold text-gray-900",children:["Pedido #",a.id.slice(-8)]}),(0,d.jsx)("p",{className:"text-sm text-gray-500",children:b?b.businessName:"Cocinero desconocido"})]})]}),(0,d.jsxs)("div",{className:"text-right",children:[(0,d.jsxs)("div",{className:"text-lg font-bold text-gray-900",children:["$",a.total.toLocaleString("es-CL")]}),(0,d.jsx)(D.E,{className:a1(a.status),children:a2(a.status)})]})]}),(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)(ad.A,{className:"h-4 w-4 text-gray-400"}),(0,d.jsx)("span",{className:"text-gray-600",children:a.customerName})]}),(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)(ae.A,{className:"h-4 w-4 text-gray-400"}),(0,d.jsxs)("span",{className:"text-gray-600",children:[c," platos"]})]}),(0,d.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,d.jsx)(R.A,{className:"h-4 w-4 text-gray-400"}),(0,d.jsx)("span",{className:"text-gray-600",children:(0,ay.GP)(a.createdAt.toDate(),"HH:mm")})]})]}),(0,d.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,d.jsx)(S.A,{className:"h-4 w-4 text-gray-400 mt-0.5"}),(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsx)("p",{className:"text-sm text-gray-600",children:a.deliveryInfo.address}),a.deliveryInfo.instructions&&(0,d.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Instrucciones: ",a.deliveryInfo.instructions]})]})]}),(0,d.jsxs)("div",{className:"flex space-x-2 pt-2",children:[(0,d.jsx)(j.$,{variant:"outline",size:"sm",onClick:()=>{aL(a),aJ(!0)},children:"Ver Detalles"}),"available"===ah&&av&&(0,d.jsx)(j.$,{size:"sm",onClick:()=>a$(a.id),className:"bg-green-600 hover:bg-green-700",children:"Aceptar Entrega"}),"active"===ah&&"accepted"===a.status&&(0,d.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,d.jsx)(D.E,{variant:"outline",className:"text-yellow-600 border-yellow-300",children:"Esperando confirmaci\xf3n del cocinero"}),(0,d.jsx)("p",{className:"text-xs text-muted-foreground",children:"El cocinero debe confirmar que puede preparar el pedido"})]}),"active"===ah&&"preparing"===a.status&&(0,d.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,d.jsxs)(D.E,{variant:"outline",className:"text-blue-600 border-blue-300",children:["Preparando (",a.estimatedReadyTime||"Calculando...",")"]}),(0,d.jsx)("p",{className:"text-xs text-muted-foreground",children:"El cocinero est\xe1 preparando el pedido"})]}),"active"===ah&&"ready"===a.status&&(0,d.jsx)(j.$,{size:"sm",onClick:()=>aZ(a.id,"delivering"),className:"bg-blue-600 hover:bg-blue-700",children:"Recoger y Entregar"}),"active"===ah&&"delivering"===a.status&&(0,d.jsx)(j.$,{size:"sm",onClick:()=>aZ(a.id,"delivered"),className:"bg-green-600 hover:bg-green-700",children:"Confirmar Entrega"}),a.deliveryInfo.address&&(0,d.jsxs)(j.$,{variant:"outline",size:"sm",onClick:()=>{let b=encodeURIComponent(a.deliveryInfo.address);window.open(`https://www.google.com/maps/search/?api=1&query=${b}`,"_blank")},children:[(0,d.jsx)(H.A,{className:"h-4 w-4 mr-1"}),"Navegar"]})]})]})})})},a.id)}))})]})]}),(0,d.jsx)(ak,{isOpen:aI,onClose:()=>aJ(!1),order:aK,cooksMap:aE,dishesMap:aG,onAcceptOrder:a$,onUpdateOrderStatus:aZ,isDriverOnline:av,isOrderAssignedToDriver:aK?.driverId===c?.uid})]}):(0,d.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,d.jsx)("div",{className:"text-center",children:(0,d.jsx)("p",{className:"text-gray-600",children:"Por favor, inicia sesi\xf3n para continuar."})})})}},41025:a=>{"use strict";a.exports=require("next/dist/server/app-render/dynamic-access-async-storage.external.js")},41692:a=>{"use strict";a.exports=require("node:tls")},41862:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(62688).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},42097:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>d});let d=(0,c(61369).registerClientReference)(function(){throw Error("Attempted to call the default export of \"D:\\\\Moai\\\\moai-app\\\\app\\\\driver\\\\dashboard\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"D:\\Moai\\moai-app\\app\\driver\\dashboard\\page.tsx","default")},44708:a=>{"use strict";a.exports=require("node:https")},45583:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(62688).A)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},46234:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(62688).A)("chef-hat",[["path",{d:"M17 21a1 1 0 0 0 1-1v-5.35c0-.457.316-.844.727-1.041a4 4 0 0 0-2.134-7.589 5 5 0 0 0-9.186 0 4 4 0 0 0-2.134 7.588c.411.198.727.585.727 1.041V20a1 1 0 0 0 1 1Z",key:"1qvrer"}],["path",{d:"M6 17h12",key:"1jwigz"}]])},48161:a=>{"use strict";a.exports=require("node:os")},48730:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(62688).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},53053:a=>{"use strict";a.exports=require("node:diagnostics_channel")},55511:a=>{"use strict";a.exports=require("crypto")},55629:(a,b,c)=>{"use strict";c.d(b,{SQ:()=>m,_2:()=>n,mB:()=>o,rI:()=>k,ty:()=>l});var d=c(60687),e=c(43210),f=c(26312),g=c(14952),h=c(13964),i=c(65822),j=c(96241);let k=f.bL,l=f.l9;f.YJ,f.ZL,f.Pb,f.z6,e.forwardRef(({className:a,inset:b,children:c,...e},h)=>(0,d.jsxs)(f.ZP,{ref:h,className:(0,j.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",b&&"pl-8",a),...e,children:[c,(0,d.jsx)(g.A,{className:"ml-auto h-4 w-4"})]})).displayName=f.ZP.displayName,e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.G5,{ref:c,className:(0,j.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...b})).displayName=f.G5.displayName;let m=e.forwardRef(({className:a,sideOffset:b=4,...c},e)=>(0,d.jsx)(f.ZL,{children:(0,d.jsx)(f.UC,{ref:e,sideOffset:b,className:(0,j.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...c})}));m.displayName=f.UC.displayName;let n=e.forwardRef(({className:a,inset:b,...c},e)=>(0,d.jsx)(f.q7,{ref:e,className:(0,j.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",b&&"pl-8",a),...c}));n.displayName=f.q7.displayName,e.forwardRef(({className:a,children:b,checked:c,...e},g)=>(0,d.jsxs)(f.H_,{ref:g,className:(0,j.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),checked:c,...e,children:[(0,d.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,d.jsx)(f.VF,{children:(0,d.jsx)(h.A,{className:"h-4 w-4"})})}),b]})).displayName=f.H_.displayName,e.forwardRef(({className:a,children:b,...c},e)=>(0,d.jsxs)(f.hN,{ref:e,className:(0,j.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...c,children:[(0,d.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,d.jsx)(f.VF,{children:(0,d.jsx)(i.A,{className:"h-2 w-2 fill-current"})})}),b]})).displayName=f.hN.displayName,e.forwardRef(({className:a,inset:b,...c},e)=>(0,d.jsx)(f.JU,{ref:e,className:(0,j.cn)("px-2 py-1.5 text-sm font-semibold",b&&"pl-8",a),...c})).displayName=f.JU.displayName;let o=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.wv,{ref:c,className:(0,j.cn)("-mx-1 my-1 h-px bg-muted",a),...b}));o.displayName=f.wv.displayName},56801:a=>{"use strict";a.exports=require("import-in-the-middle")},57075:a=>{"use strict";a.exports=require("node:stream")},57975:a=>{"use strict";a.exports=require("node:util")},58559:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(62688).A)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},62369:(a,b,c)=>{"use strict";c.d(b,{b:()=>j});var d=c(43210),e=c(14163),f=c(60687),g="horizontal",h=["horizontal","vertical"],i=d.forwardRef((a,b)=>{var c;let{decorative:d,orientation:i=g,...j}=a,k=(c=i,h.includes(c))?i:g;return(0,f.jsx)(e.sG.div,{"data-orientation":k,...d?{role:"none"}:{"aria-orientation":"vertical"===k?k:void 0,role:"separator"},...j,ref:b})});i.displayName="Separator";var j=i},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63974:(a,b,c)=>{"use strict";c.d(b,{bq:()=>m,eb:()=>q,gC:()=>p,l6:()=>k,yv:()=>l});var d=c(60687),e=c(43210),f=c(25911),g=c(78272),h=c(3589),i=c(13964),j=c(96241);let k=f.bL;f.YJ;let l=f.WT,m=e.forwardRef(({className:a,children:b,...c},e)=>(0,d.jsxs)(f.l9,{ref:e,className:(0,j.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...c,children:[b,(0,d.jsx)(f.In,{asChild:!0,children:(0,d.jsx)(g.A,{className:"h-4 w-4 opacity-50"})})]}));m.displayName=f.l9.displayName;let n=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.PP,{ref:c,className:(0,j.cn)("flex cursor-default items-center justify-center py-1",a),...b,children:(0,d.jsx)(h.A,{className:"h-4 w-4"})}));n.displayName=f.PP.displayName;let o=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.wn,{ref:c,className:(0,j.cn)("flex cursor-default items-center justify-center py-1",a),...b,children:(0,d.jsx)(g.A,{className:"h-4 w-4"})}));o.displayName=f.wn.displayName;let p=e.forwardRef(({className:a,children:b,position:c="popper",...e},g)=>(0,d.jsx)(f.ZL,{children:(0,d.jsxs)(f.UC,{ref:g,className:(0,j.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===c&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:c,...e,children:[(0,d.jsx)(n,{}),(0,d.jsx)(f.LM,{className:(0,j.cn)("p-1","popper"===c&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:b}),(0,d.jsx)(o,{})]})}));p.displayName=f.UC.displayName,e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.JU,{ref:c,className:(0,j.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...b})).displayName=f.JU.displayName;let q=e.forwardRef(({className:a,children:b,...c},e)=>(0,d.jsxs)(f.q7,{ref:e,className:(0,j.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...c,children:[(0,d.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,d.jsx)(f.VF,{children:(0,d.jsx)(i.A,{className:"h-4 w-4"})})}),(0,d.jsx)(f.p4,{children:b})]}));q.displayName=f.q7.displayName,e.forwardRef(({className:a,...b},c)=>(0,d.jsx)(f.wv,{ref:c,className:(0,j.cn)("-mx-1 my-1 h-px bg-muted",a),...b})).displayName=f.wv.displayName},64398:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(62688).A)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]])},67138:(a,b,c)=>{Promise.resolve().then(c.bind(c,40981))},73024:a=>{"use strict";a.exports=require("node:fs")},73496:a=>{"use strict";a.exports=require("http2")},73566:a=>{"use strict";a.exports=require("worker_threads")},74075:a=>{"use strict";a.exports=require("zlib")},74998:a=>{"use strict";a.exports=require("perf_hooks")},75919:a=>{"use strict";a.exports=require("node:worker_threads")},76760:a=>{"use strict";a.exports=require("node:path")},77030:a=>{"use strict";a.exports=require("node:net")},78377:(a,b,c)=>{"use strict";c.d(b,{w:()=>h});var d=c(60687),e=c(43210),f=c(62369),g=c(96241);let h=e.forwardRef(({className:a,orientation:b="horizontal",decorative:c=!0,...e},h)=>(0,d.jsx)(f.b,{ref:h,decorative:c,orientation:b,className:(0,g.cn)("shrink-0 bg-border","horizontal"===b?"h-[1px] w-full":"h-full w-[1px]",a),...e}));h.displayName=f.b.displayName},79551:a=>{"use strict";a.exports=require("url")},79646:a=>{"use strict";a.exports=require("child_process")},80481:a=>{"use strict";a.exports=require("node:readline")},81630:a=>{"use strict";a.exports=require("http")},83997:a=>{"use strict";a.exports=require("tty")},84297:a=>{"use strict";a.exports=require("async_hooks")},86287:(a,b,c)=>{"use strict";c.d(b,{k:()=>h});var d=c(60687),e=c(43210),f=c(25177),g=c(96241);let h=e.forwardRef(({className:a,value:b,...c},e)=>(0,d.jsx)(f.bL,{ref:e,className:(0,g.cn)("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",a),...c,children:(0,d.jsx)(f.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(b||0)}%)`}})}));h.displayName=f.bL.displayName},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},86561:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(62688).A)("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]])},86592:a=>{"use strict";a.exports=require("node:inspector")},91645:a=>{"use strict";a.exports=require("net")},92200:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(62688).A)("navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]])},94258:(a,b,c)=>{"use strict";c.d(b,{U:()=>k});var d=c(60687);c(43210);var e=c(363),f=c(21134),g=c(34318),h=c(40303),i=c(24934),j=c(55629);function k(){let{theme:a,setTheme:b,resolvedTheme:c}=(0,h.D)();return(0,d.jsxs)(j.rI,{children:[(0,d.jsx)(j.ty,{asChild:!0,children:(0,d.jsxs)(i.$,{variant:"outline",size:"sm",className:"h-9 w-9 p-0",children:["dark"===c?(0,d.jsx)(e.A,{className:"h-4 w-4"}):(0,d.jsx)(f.A,{className:"h-4 w-4"}),(0,d.jsx)("span",{className:"sr-only",children:"Toggle theme"})]})}),(0,d.jsxs)(j.SQ,{align:"end",children:[(0,d.jsxs)(j._2,{onClick:()=>b("light"),className:"cursor-pointer",children:[(0,d.jsx)(f.A,{className:"mr-2 h-4 w-4"}),(0,d.jsx)("span",{children:"Claro"}),"light"===a&&(0,d.jsx)("span",{className:"ml-auto",children:"✓"})]}),(0,d.jsxs)(j._2,{onClick:()=>b("dark"),className:"cursor-pointer",children:[(0,d.jsx)(e.A,{className:"mr-2 h-4 w-4"}),(0,d.jsx)("span",{children:"Oscuro"}),"dark"===a&&(0,d.jsx)("span",{className:"ml-auto",children:"✓"})]}),(0,d.jsxs)(j._2,{onClick:()=>b("system"),className:"cursor-pointer",children:[(0,d.jsx)(g.A,{className:"mr-2 h-4 w-4"}),(0,d.jsx)("span",{children:"Sistema"}),"system"===a&&(0,d.jsx)("span",{className:"ml-auto",children:"✓"})]})]})]})}},94735:a=>{"use strict";a.exports=require("events")},96624:(a,b,c)=>{"use strict";c.r(b),c.d(b,{GlobalError:()=>B.default,__next_app__:()=>H,handler:()=>J,pages:()=>G,routeModule:()=>I,tree:()=>F});var d=c(65239),e=c(48088),f=c(47220),g=c(81289),h=c(26191),i=c(14823),j=c(71998),k=c(92603),l=c(54649),m=c(32781),n=c(82602),o=c(61268),p=c(4853),q=c(261),r=c(5052),s=c(9977),t=c(26713),u=c(43365),v=c(71454),w=c(67778),x=c(46143),y=c(39105),z=c(38171),A=c(86439),B=c(46076),C=c(30893),D=c(52836),E={};for(let a in C)0>["default","tree","pages","GlobalError","__next_app__","routeModule","handler"].indexOf(a)&&(E[a]=()=>C[a]);c.d(b,E);let F={children:["",{children:["driver",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(c.bind(c,42097)),"D:\\Moai\\moai-app\\app\\driver\\dashboard\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(c.bind(c,62087)),"D:\\Moai\\moai-app\\app\\layout.tsx"],"global-error":[()=>Promise.resolve().then(c.bind(c,46076)),"D:\\Moai\\moai-app\\app\\global-error.tsx"],"global-error":[()=>Promise.resolve().then(c.bind(c,46076)),"D:\\Moai\\moai-app\\app\\global-error.tsx"],"not-found":[()=>Promise.resolve().then(c.t.bind(c,80849,23)),"next/dist/client/components/builtin/not-found.js"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,29868,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,79615,23)),"next/dist/client/components/builtin/unauthorized.js"]}]}.children,G=["D:\\Moai\\moai-app\\app\\driver\\dashboard\\page.tsx"],H={require:c,loadChunk:()=>Promise.resolve()},I=new d.AppPageRouteModule({definition:{kind:e.RouteKind.APP_PAGE,page:"/driver/dashboard/page",pathname:"/driver/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:F},distDir:".next",projectDir:""});async function J(a,b,c){var d;let E="/driver/dashboard/page";"/index"===E&&(E="/");let K="false",L=(0,h.getRequestMeta)(a,"postponed"),M=(0,h.getRequestMeta)(a,"minimalMode"),N=await I.prepare(a,b,{srcPage:E,multiZoneDraftMode:K});if(!N)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:O,query:P,params:Q,parsedUrl:R,pageIsDynamic:S,buildManifest:T,nextFontManifest:U,reactLoadableManifest:V,serverActionsManifest:W,clientReferenceManifest:X,subresourceIntegrityManifest:Y,prerenderManifest:Z,isDraftMode:$,resolvedPathname:_,revalidateOnlyGenerated:aa,routerServerContext:ab,nextConfig:ac}=N,ad=R.pathname||"/",ae=(0,q.normalizeAppPath)(E),{isOnDemandRevalidate:af}=N,ag=Z.dynamicRoutes[ae],ah=Z.routes[_],ai=!!(ag||ah||Z.routes[ae]),aj=a.headers["user-agent"]||"",ak=(0,t.getBotType)(aj),al=(0,o.isHtmlBotRequest)(a),am=(0,h.getRequestMeta)(a,"isPrefetchRSCRequest")??!!a.headers[s.NEXT_ROUTER_PREFETCH_HEADER],an=(0,h.getRequestMeta)(a,"isRSCRequest")??!!a.headers[s.RSC_HEADER],ao=(0,r.getIsPossibleServerAction)(a),ap=(0,l.checkIsAppPPREnabled)(ac.experimental.ppr)&&(null==(d=Z.routes[ae]??Z.dynamicRoutes[ae])?void 0:d.renderingMode)==="PARTIALLY_STATIC",aq=!1,ar=!1,as=ap?L:void 0,at=ap&&an&&!am,au=(0,h.getRequestMeta)(a,"segmentPrefetchRSCRequest"),av=!aj||(0,o.shouldServeStreamingMetadata)(aj,ac.htmlLimitedBots);al&&ap&&(ai=!1,av=!1);let aw=!0===I.isDev||!ai||"string"==typeof L||at,ax=al&&ap,ay=null;$||!ai||aw||ao||as||at||(ay=_);let az=ay;!az&&I.isDev&&(az=_);let aA={...C,tree:F,pages:G,GlobalError:B.default,handler:J,routeModule:I,__next_app__:H};W&&X&&(0,n.setReferenceManifestsSingleton)({page:E,clientReferenceManifest:X,serverActionsManifest:W,serverModuleMap:(0,p.createServerModuleMap)({serverActionsManifest:W})});let aB=a.method||"GET",aC=(0,g.getTracer)(),aD=aC.getActiveScopeSpan();try{let d=async(c,d)=>{let e=new k.NodeNextRequest(a),f=new k.NodeNextResponse(b);return I.render(e,f,d).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=aC.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==i.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${aB} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${aB} ${a.url}`)})},f=async({span:e,postponed:f,fallbackRouteParams:g})=>{let i={query:P,params:Q,page:ae,sharedContext:{buildId:O},serverComponentsHmrCache:(0,h.getRequestMeta)(a,"serverComponentsHmrCache"),fallbackRouteParams:g,renderOpts:{App:()=>null,Document:()=>null,pageConfig:{},ComponentMod:aA,Component:(0,j.T)(aA),params:Q,routeModule:I,page:E,postponed:f,shouldWaitOnAllReady:ax,serveStreamingMetadata:av,supportsDynamicResponse:"string"==typeof f||aw,buildManifest:T,nextFontManifest:U,reactLoadableManifest:V,subresourceIntegrityManifest:Y,serverActionsManifest:W,clientReferenceManifest:X,setIsrStatus:null==ab?void 0:ab.setIsrStatus,dir:I.projectDir,isDraftMode:$,isRevalidate:ai&&!f&&!at,botType:ak,isOnDemandRevalidate:af,isPossibleServerAction:ao,assetPrefix:ac.assetPrefix,nextConfigOutput:ac.output,crossOrigin:ac.crossOrigin,trailingSlash:ac.trailingSlash,previewProps:Z.preview,deploymentId:ac.deploymentId,enableTainting:ac.experimental.taint,htmlLimitedBots:ac.htmlLimitedBots,devtoolSegmentExplorer:ac.experimental.devtoolSegmentExplorer,reactMaxHeadersLength:ac.reactMaxHeadersLength,multiZoneDraftMode:K,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:ac.experimental.cacheLife,basePath:ac.basePath,serverActions:ac.experimental.serverActions,...aq?{nextExport:!0,supportsDynamicResponse:!1,isStaticGeneration:!0,isRevalidate:!0,isDebugDynamicAccesses:aq}:{},experimental:{isRoutePPREnabled:ap,expireTime:ac.expireTime,staleTimes:ac.experimental.staleTimes,dynamicIO:!!ac.experimental.dynamicIO,clientSegmentCache:!!ac.experimental.clientSegmentCache,dynamicOnHover:!!ac.experimental.dynamicOnHover,inlineCss:!!ac.experimental.inlineCss,authInterrupts:!!ac.experimental.authInterrupts,clientTraceMetadata:ac.experimental.clientTraceMetadata||[]},waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:()=>{},onInstrumentationRequestError:(b,c,d)=>I.onRequestError(a,b,d,ab),err:(0,h.getRequestMeta)(a,"invokeError"),dev:I.isDev}},k=await d(e,i),{metadata:l}=k,{cacheControl:m,headers:n={},fetchTags:o}=l;if(o&&(n[x.NEXT_CACHE_TAGS_HEADER]=o),a.fetchMetrics=l.fetchMetrics,ai&&(null==m?void 0:m.revalidate)===0&&!I.isDev&&!ap){let a=l.staticBailoutInfo,b=Object.defineProperty(Error(`Page changed from static to dynamic at runtime ${_}${(null==a?void 0:a.description)?`, reason: ${a.description}`:""}
see more here https://nextjs.org/docs/messages/app-static-to-dynamic-error`),"__NEXT_ERROR_CODE",{value:"E132",enumerable:!1,configurable:!0});if(null==a?void 0:a.stack){let c=a.stack;b.stack=b.message+c.substring(c.indexOf("\n"))}throw b}return{value:{kind:u.CachedRouteKind.APP_PAGE,html:k,headers:n,rscData:l.flightData,postponed:l.postponed,status:l.statusCode,segmentData:l.segmentData},cacheControl:m}},l=async({hasResolved:d,previousCacheEntry:g,isRevalidating:i,span:j})=>{let k,l=!1===I.isDev,n=d||b.writableEnded;if(af&&aa&&!g&&!M)return(null==ab?void 0:ab.render404)?await ab.render404(a,b):(b.statusCode=404,b.end("This page could not be found")),null;if(ag&&(k=(0,v.parseFallbackField)(ag.fallback)),k===v.FallbackMode.PRERENDER&&(0,t.isBot)(aj)&&(k=v.FallbackMode.BLOCKING_STATIC_RENDER),(null==g?void 0:g.isStale)===-1&&(af=!0),af&&(k!==v.FallbackMode.NOT_FOUND||g)&&(k=v.FallbackMode.BLOCKING_STATIC_RENDER),!M&&k!==v.FallbackMode.BLOCKING_STATIC_RENDER&&az&&!n&&!$&&S&&(l||!ah)){let b;if((l||ag)&&k===v.FallbackMode.NOT_FOUND)throw new A.NoFallbackError;if(ap&&!an){if(b=await I.handleResponse({cacheKey:l?ae:null,req:a,nextConfig:ac,routeKind:e.RouteKind.APP_PAGE,isFallback:!0,prerenderManifest:Z,isRoutePPREnabled:ap,responseGenerator:async()=>f({span:j,postponed:void 0,fallbackRouteParams:l||ar?(0,m.u)(ae):null}),waitUntil:c.waitUntil}),null===b)return null;if(b)return delete b.cacheControl,b}}let o=af||i||!as?void 0:as;if(aq&&void 0!==o)return{cacheControl:{revalidate:1,expire:void 0},value:{kind:u.CachedRouteKind.PAGES,html:w.default.fromStatic(""),pageData:{},headers:void 0,status:void 0}};let p=S&&ap&&((0,h.getRequestMeta)(a,"renderFallbackShell")||ar)?(0,m.u)(ad):null;return f({span:j,postponed:o,fallbackRouteParams:p})},n=async d=>{var g,i,j,k,m;let n,o=await I.handleResponse({cacheKey:ay,responseGenerator:a=>l({span:d,...a}),routeKind:e.RouteKind.APP_PAGE,isOnDemandRevalidate:af,isRoutePPREnabled:ap,req:a,nextConfig:ac,prerenderManifest:Z,waitUntil:c.waitUntil});if($&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate"),I.isDev&&b.setHeader("Cache-Control","no-store, must-revalidate"),!o){if(ay)throw Object.defineProperty(Error("invariant: cache entry required but not generated"),"__NEXT_ERROR_CODE",{value:"E62",enumerable:!1,configurable:!0});return null}if((null==(g=o.value)?void 0:g.kind)!==u.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant app-page handler received invalid cache entry ${null==(j=o.value)?void 0:j.kind}`),"__NEXT_ERROR_CODE",{value:"E707",enumerable:!1,configurable:!0});let p="string"==typeof o.value.postponed;ai&&!at&&(!p||am)&&(M||b.setHeader("x-nextjs-cache",af?"REVALIDATED":o.isMiss?"MISS":o.isStale?"STALE":"HIT"),b.setHeader(s.NEXT_IS_PRERENDER_HEADER,"1"));let{value:q}=o;if(as)n={revalidate:0,expire:void 0};else if(M&&an&&!am&&ap)n={revalidate:0,expire:void 0};else if(!I.isDev)if($)n={revalidate:0,expire:void 0};else if(ai){if(o.cacheControl)if("number"==typeof o.cacheControl.revalidate){if(o.cacheControl.revalidate<1)throw Object.defineProperty(Error(`Invalid revalidate configuration provided: ${o.cacheControl.revalidate} < 1`),"__NEXT_ERROR_CODE",{value:"E22",enumerable:!1,configurable:!0});n={revalidate:o.cacheControl.revalidate,expire:(null==(k=o.cacheControl)?void 0:k.expire)??ac.expireTime}}else n={revalidate:x.CACHE_ONE_YEAR,expire:void 0}}else b.getHeader("Cache-Control")||(n={revalidate:0,expire:void 0});if(o.cacheControl=n,"string"==typeof au&&(null==q?void 0:q.kind)===u.CachedRouteKind.APP_PAGE&&q.segmentData){b.setHeader(s.NEXT_DID_POSTPONE_HEADER,"2");let c=null==(m=q.headers)?void 0:m[x.NEXT_CACHE_TAGS_HEADER];M&&ai&&c&&"string"==typeof c&&b.setHeader(x.NEXT_CACHE_TAGS_HEADER,c);let d=q.segmentData.get(au);return void 0!==d?(0,z.sendRenderResult)({req:a,res:b,type:"rsc",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:w.default.fromStatic(d),cacheControl:o.cacheControl}):(b.statusCode=204,(0,z.sendRenderResult)({req:a,res:b,type:"rsc",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:w.default.fromStatic(""),cacheControl:o.cacheControl}))}let r=(0,h.getRequestMeta)(a,"onCacheEntry");if(r&&await r({...o,value:{...o.value,kind:"PAGE"}},{url:(0,h.getRequestMeta)(a,"initURL")}))return null;if(p&&as)throw Object.defineProperty(Error("Invariant: postponed state should not be present on a resume request"),"__NEXT_ERROR_CODE",{value:"E396",enumerable:!1,configurable:!0});if(q.headers){let a={...q.headers};for(let[c,d]of(M&&ai||delete a[x.NEXT_CACHE_TAGS_HEADER],Object.entries(a)))if(void 0!==d)if(Array.isArray(d))for(let a of d)b.appendHeader(c,a);else"number"==typeof d&&(d=d.toString()),b.appendHeader(c,d)}let t=null==(i=q.headers)?void 0:i[x.NEXT_CACHE_TAGS_HEADER];if(M&&ai&&t&&"string"==typeof t&&b.setHeader(x.NEXT_CACHE_TAGS_HEADER,t),!q.status||an&&ap||(b.statusCode=q.status),!M&&q.status&&D.RedirectStatusCode[q.status]&&an&&(b.statusCode=200),p&&b.setHeader(s.NEXT_DID_POSTPONE_HEADER,"1"),an&&!$){if(void 0===q.rscData){if(q.postponed)throw Object.defineProperty(Error("Invariant: Expected postponed to be undefined"),"__NEXT_ERROR_CODE",{value:"E372",enumerable:!1,configurable:!0});return(0,z.sendRenderResult)({req:a,res:b,type:"rsc",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:q.html,cacheControl:at?{revalidate:0,expire:void 0}:o.cacheControl})}return(0,z.sendRenderResult)({req:a,res:b,type:"rsc",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:w.default.fromStatic(q.rscData),cacheControl:o.cacheControl})}let v=q.html;if(!p||M)return(0,z.sendRenderResult)({req:a,res:b,type:"html",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:v,cacheControl:o.cacheControl});if(aq)return v.chain(new ReadableStream({start(a){a.enqueue(y.ENCODED_TAGS.CLOSED.BODY_AND_HTML),a.close()}})),(0,z.sendRenderResult)({req:a,res:b,type:"html",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:v,cacheControl:{revalidate:0,expire:void 0}});let A=new TransformStream;return v.chain(A.readable),f({span:d,postponed:q.postponed,fallbackRouteParams:null}).then(async a=>{var b,c;if(!a)throw Object.defineProperty(Error("Invariant: expected a result to be returned"),"__NEXT_ERROR_CODE",{value:"E463",enumerable:!1,configurable:!0});if((null==(b=a.value)?void 0:b.kind)!==u.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant: expected a page response, got ${null==(c=a.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E305",enumerable:!1,configurable:!0});await a.value.html.pipeTo(A.writable)}).catch(a=>{A.writable.abort(a).catch(a=>{console.error("couldn't abort transformer",a)})}),(0,z.sendRenderResult)({req:a,res:b,type:"html",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:v,cacheControl:{revalidate:0,expire:void 0}})};if(!aD)return await aC.withPropagatedContext(a.headers,()=>aC.trace(i.BaseServerSpan.handleRequest,{spanName:`${aB} ${a.url}`,kind:g.SpanKind.SERVER,attributes:{"http.method":aB,"http.target":a.url}},n));await n(aD)}catch(b){throw aD||b instanceof A.NoFallbackError||await I.onRequestError(a,b,{routerKind:"App Router",routePath:E,routeType:"render",revalidateReason:(0,f.c)({isRevalidate:ai,isOnDemandRevalidate:af})},ab),b}}},98682:(a,b,c)=>{Promise.resolve().then(c.bind(c,42097))},99891:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(62688).A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[4985,9510,7400,246,3600,8307,9146],()=>b(b.s=96624));module.exports=c})();
"use strict";exports.id=8469,exports.ids=[8469],exports.modules={13861:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(62688).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},63105:(a,b,c)=>{c.d(b,{VK:()=>k});var d=c(75535),e=c(56525);c(43210);class f{constructor(a){this.cache=new Map,this.defaultTTL=3e5,this.maxSize=1e3,this.prefix="moai_cache_",a?.ttl&&(this.defaultTTL=a.ttl),a?.maxSize&&(this.maxSize=a.maxSize),a?.prefix&&(this.prefix=a.prefix),setInterval(()=>this.cleanup(),3e5)}generateKey(a){return`${this.prefix}${a}`}isExpired(a){return Date.now()>a.expiry}evictOldest(){if(this.cache.size<this.maxSize)return;let a="",b=Date.now();for(let[c,d]of this.cache.entries())d.timestamp<b&&(b=d.timestamp,a=c);a&&this.cache.delete(a)}set(a,b,c){let d=this.generateKey(a),e=Date.now()+(c||this.defaultTTL);this.evictOldest(),this.cache.set(d,{data:b,timestamp:Date.now(),expiry:e})}get(a){let b=this.generateKey(a),c=this.cache.get(b);return!c||this.isExpired(c)?(c&&this.cache.delete(b),null):c.data}has(a){let b=this.generateKey(a),c=this.cache.get(b);return!(!c||this.isExpired(c))||(c&&this.cache.delete(b),!1)}delete(a){let b=this.generateKey(a);return this.cache.delete(b)}clear(){this.cache.clear()}cleanup(){for(let[a,b]of this.cache.entries())this.isExpired(b)&&this.cache.delete(a)}getStats(){let a=this.cache.size;return{size:a,maxSize:this.maxSize,hitRate:0,memoryUsage:`${Math.round(.1*a)}KB`}}cached(a,b,c){return new Promise(async(d,e)=>{try{let e=this.get(a);if(null!==e)return void d(e);let f=await b();this.set(a,f,c),d(f)}catch(a){e(a)}})}invalidatePattern(a){let b=new RegExp(a);for(let a of this.cache.keys())b.test(a)&&this.cache.delete(a)}getKeys(){return Array.from(this.cache.keys())}}let g=new f({ttl:6e5,maxSize:500,prefix:"dish_"}),h=new f({ttl:9e5,maxSize:200,prefix:"cook_"});new f({ttl:12e4,maxSize:300,prefix:"order_"}),new f({ttl:18e5,maxSize:100,prefix:"user_"});let i=new f({ttl:3e5,maxSize:200,prefix:"search_"});new f({ttl:36e5,maxSize:100,prefix:"location_"}),new f;class j{constructor(a,b={}){this.cursors=[],this.currentPage=0,this.baseQuery=a,this.pageSize=b.pageSize||20,this.orderByField=b.orderByField||"createdAt",this.orderDirection=b.orderDirection||"desc";let c=[];b.filters&&b.filters.forEach(a=>{c.push((0,d.where)(a.field,a.operator,a.value))}),c.push((0,d.orderBy)(this.orderByField,this.orderDirection)),this.baseQuery=(0,d.query)(this.baseQuery,...c)}async getFirstPage(){try{let a=(0,d.query)(this.baseQuery,(0,d.limit)(this.pageSize)),b=await (0,d.getDocs)(a),c=b.docs.map(a=>({id:a.id,...a.data()}));return b.docs.length>0&&(this.cursors=[b.docs[b.docs.length-1]]),this.currentPage=1,{data:c,hasNextPage:b.docs.length===this.pageSize,hasPreviousPage:!1,currentPage:this.currentPage,nextCursor:b.docs[b.docs.length-1],loading:!1}}catch(a){return{data:[],hasNextPage:!1,hasPreviousPage:!1,currentPage:0,loading:!1,error:a}}}async getNextPage(){if(0===this.cursors.length)return this.getFirstPage();try{let a=this.cursors[this.cursors.length-1],b=(0,d.query)(this.baseQuery,(0,d.HM)(a),(0,d.limit)(this.pageSize)),c=await (0,d.getDocs)(b),e=c.docs.map(a=>({id:a.id,...a.data()}));return c.docs.length>0&&this.cursors.push(c.docs[c.docs.length-1]),this.currentPage++,{data:e,hasNextPage:c.docs.length===this.pageSize,hasPreviousPage:this.currentPage>1,currentPage:this.currentPage,nextCursor:c.docs[c.docs.length-1],previousCursor:this.cursors[this.cursors.length-2],loading:!1}}catch(a){return{data:[],hasNextPage:!1,hasPreviousPage:this.currentPage>1,currentPage:this.currentPage,loading:!1,error:a}}}async getPreviousPage(){if(this.cursors.length<2||this.currentPage<=1)return this.getFirstPage();try{this.cursors.pop();let a=this.cursors[this.cursors.length-1],b=(0,d.query)(this.baseQuery,(0,d.rf)(a),(0,d.limit)(this.pageSize)),c=await (0,d.getDocs)(b),e=c.docs.map(a=>({id:a.id,...a.data()}));return this.currentPage--,{data:e,hasNextPage:!0,hasPreviousPage:this.currentPage>1,currentPage:this.currentPage,nextCursor:c.docs[c.docs.length-1],previousCursor:this.cursors[this.cursors.length-2],loading:!1}}catch(a){return{data:[],hasNextPage:!1,hasPreviousPage:this.currentPage>1,currentPage:this.currentPage,loading:!1,error:a}}}reset(){this.cursors=[],this.currentPage=0}getCurrentPageInfo(){return{currentPage:this.currentPage,pageSize:this.pageSize,hasNextPage:this.cursors.length>0,hasPreviousPage:this.currentPage>1}}}class k{static{this.CACHE_TTL=6e5}static{this.DEFAULT_PAGE_SIZE=20}static async getDishes(a={}){let{cookId:b,category:d,pageSize:f=this.DEFAULT_PAGE_SIZE,useCache:h=!0}=a,i=`dishes_${b||"all"}_${d||"all"}_${f}`;if(h){let a=g.get(i);if(a)return{data:a.data,hasMore:a.hasMore}}try{let{getDocs:a,limit:b,collection:d,query:j}=await Promise.resolve().then(c.bind(c,75535)),k=j(d(e.db,"dishes"),b(f)),l=await a(k),m=l.docs.map(a=>({id:a.id,...a.data()}));return h&&g.set(i,{data:m,hasMore:l.docs.length===f},this.CACHE_TTL),{data:m,hasMore:l.docs.length===f}}catch(a){return console.error("Error fetching dishes:",a),{data:[],hasMore:!1}}}static async getDishById(a,b=!0){let c=`dish_${a}`;if(b){let a=g.get(c);if(a)return a}try{let f=await (0,d.getDoc)((0,d.doc)(e.db,"dishes",a));if(!f.exists())return null;let h={id:f.id,...f.data()};return b&&g.set(c,h,this.CACHE_TTL),h}catch(a){return console.error("Error fetching dish:",a),null}}static async getPopularDishes(a=10,b=!0){let c=`popular_dishes_${a}`;if(b){let a=g.get(c);if(a)return a}try{let f=(0,d.query)((0,d.collection)(e.db,"dishes"),(0,d.where)("isAvailable","==",!0),(0,d.orderBy)("rating","desc"),(0,d.orderBy)("reviewCount","desc"),(0,d.limit)(a)),h=(await (0,d.getDocs)(f)).docs.map(a=>({id:a.id,...a.data()}));return b&&g.set(c,h,this.CACHE_TTL),h}catch(a){return console.error("Error fetching popular dishes:",a),[]}}static async searchDishes(a,b={}){let{category:c,maxPrice:d,minRating:e=0,pageSize:f=this.DEFAULT_PAGE_SIZE,useCache:g=!0}=b,h=`search_${a}_${c||"all"}_${d||"any"}_${e}_${f}`;if(g){let c=i.get(h);if(c){let d=new j(this.buildSearchQuery(a,b),{pageSize:f});return{data:c.data,hasMore:c.hasMore,pagination:d}}}try{let c=this.buildSearchQuery(a,b),d=new j(c,{pageSize:f,orderByField:"rating",orderDirection:"desc"}),e=await d.getFirstPage();return g&&!e.error&&i.set(h,{data:e.data,hasMore:e.hasNextPage},3e5),{data:e.data,hasMore:e.hasNextPage,pagination:d}}catch(c){return console.error("Error searching dishes:",c),{data:[],hasMore:!1,pagination:new j(this.buildSearchQuery(a,b),{pageSize:f})}}}static buildDishesQuery(a){let b=(0,d.collection)(e.db,"dishes"),c=[];return a.cookId&&c.push((0,d.where)("cookerId","==",a.cookId)),a.category&&c.push((0,d.where)("category","==",a.category)),void 0!==a.isAvailable&&c.push((0,d.where)("isAvailable","==",a.isAvailable)),c.length>0?(0,d.query)(b,...c):(0,d.query)(b)}static buildSearchQuery(a,b){let c=(0,d.collection)(e.db,"dishes"),f=[(0,d.where)("isAvailable","==",!0)];if(b.category&&f.push((0,d.where)("category","==",b.category)),b.maxPrice&&f.push((0,d.where)("price","<=",b.maxPrice)),b.minRating&&b.minRating>0&&f.push((0,d.where)("rating",">=",b.minRating)),a){let b=a.toLowerCase();f.push((0,d.where)("tags","array-contains",b))}return(0,d.query)(c,...f)}static invalidateCache(a,b){a&&g.delete(`dish_${a}`),b&&g.invalidatePattern(`.*cook_${b}.*`),g.invalidatePattern("dishes_.*"),g.invalidatePattern("popular_dishes_.*"),i.clear()}}class l{static{this.CACHE_TTL=9e5}static async getCooks(a={}){let{isActive:b=!0,minRating:c=0,pageSize:d=20,useCache:e=!0}=a,f=`cooks_${b}_${c}_${d}`;if(e){let b=h.get(f);if(b){let c=new j(this.buildCooksQuery(a),{pageSize:d});return{data:b.data,hasMore:b.hasMore,pagination:c}}}try{let b=this.buildCooksQuery(a),c=new j(b,{pageSize:d,orderByField:"rating",orderDirection:"desc"}),g=await c.getFirstPage();return e&&!g.error&&h.set(f,{data:g.data,hasMore:g.hasNextPage},this.CACHE_TTL),{data:g.data,hasMore:g.hasNextPage,pagination:c}}catch(b){return console.error("Error fetching cooks:",b),{data:[],hasMore:!1,pagination:new j(this.buildCooksQuery(a),{pageSize:d})}}}static async getCookById(a,b=!0){let c=`cook_${a}`;if(b){let a=h.get(c);if(a)return a}try{let f=await (0,d.getDoc)((0,d.doc)(e.db,"cooks",a));if(!f.exists())return null;let g={id:f.id,...f.data()};return b&&h.set(c,g,this.CACHE_TTL),g}catch(a){return console.error("Error fetching cook:",a),null}}static buildCooksQuery(a){let b=(0,d.collection)(e.db,"cooks"),c=[];return void 0!==a.isActive&&c.push((0,d.where)("isActive","==",a.isActive)),a.minRating&&a.minRating>0&&c.push((0,d.where)("rating",">=",a.minRating)),c.length>0?(0,d.query)(b,...c):(0,d.query)(b)}static invalidateCache(a){a&&h.delete(`cook_${a}`),h.invalidatePattern("cooks_.*")}}}};
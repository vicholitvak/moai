"use strict";exports.id=8278,exports.ids=[8278],exports.modules={15616:(a,b,c)=>{c.d(b,{T:()=>g});var d=c(60687),e=c(43210),f=c(96241);let g=e.forwardRef(({className:a,...b},c)=>(0,d.jsx)("textarea",{className:(0,f.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:c,...b}));g.displayName="Textarea"},81620:(a,b,c)=>{c.d(b,{A:()=>d});let d=(0,c(62688).A)("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]])},86287:(a,b,c)=>{c.d(b,{k:()=>h});var d=c(60687),e=c(43210),f=c(25177),g=c(96241);let h=e.forwardRef(({className:a,value:b,...c},e)=>(0,d.jsx)(f.bL,{ref:e,className:(0,g.cn)("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",a),...c,children:(0,d.jsx)(f.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(b||0)}%)`}})}));h.displayName=f.bL.displayName},96327:(a,b,c)=>{c.d(b,{y:()=>u});var d=c(60687),e=c(43210),f=c(64398),g=c(5336),h=c(58869),i=c(40228);let j=(0,c(62688).A)("thumbs-up",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]);var k=c(72542),l=c(87675),m=c(21295),n=c(24934),o=c(15616),p=c(55192),q=c(70373),r=c(52581),s=c(86287),t=c(96241);function u({cookerId:a,dishId:b,dishName:c,orderId:u,onReviewSubmit:v}){let{user:w}=(0,m.A)(),[x,y]=(0,e.useState)([]),[z,A]=(0,e.useState)(!0),[B,C]=(0,e.useState)(!1),[D,E]=(0,e.useState)(0),[F,G]=(0,e.useState)(0),[H,I]=(0,e.useState)(""),[J,K]=(0,e.useState)(!1),[L,M]=(0,e.useState)(!1),[N,O]=(0,e.useState)({average:0,total:0,distribution:[0,0,0,0,0]}),P=async()=>{try{A(!0);let c=[];if(b?c=await l.ReviewsService.getReviewsByDish(b):a&&(c=await l.ReviewsService.getReviewsByCook(a)),y(c),c.length>0){let a=c.reduce((a,b)=>a+b.rating,0)/c.length,b=[0,0,0,0,0];c.forEach(a=>{b[a.rating-1]++}),O({average:a,total:c.length,distribution:b})}w&&c.some(a=>a.customerId===w.uid)&&M(!0)}catch(a){console.error("Error loading reviews:",a),r.oR.error("Error al cargar las rese\xf1as")}finally{A(!1)}},Q=async()=>{if(!w||!a||0===D)return void r.oR.error("Por favor selecciona una calificaci\xf3n");if(H.trim().length<10)return void r.oR.error("Por favor escribe un comentario m\xe1s detallado (m\xednimo 10 caracteres)");try{C(!0);let d={customerId:w.uid,customerName:w.displayName||"Usuario",customerAvatar:w.photoURL||"",cookerId:a,dishId:b,dishName:c,orderId:u,rating:D,comment:H.trim(),verified:!!u};await l.ReviewsService.createReview(d)&&(r.oR.success("\xa1Rese\xf1a publicada exitosamente!"),E(0),I(""),K(!1),M(!0),P(),v?.())}catch(a){console.error("Error submitting review:",a),r.oR.error("Error al publicar la rese\xf1a")}finally{C(!1)}},R=({value:a,size:b="md",interactive:c=!1,onRate:e=()=>{}})=>{let g={sm:"h-4 w-4",md:"h-5 w-5",lg:"h-6 w-6"};return(0,d.jsx)("div",{className:"flex gap-0.5",children:[1,2,3,4,5].map(h=>(0,d.jsx)("button",{type:"button",disabled:!c,onClick:()=>c&&e(h),onMouseEnter:()=>c&&G(h),onMouseLeave:()=>c&&G(0),className:(0,t.cn)("transition-all",c&&"hover:scale-110"),children:(0,d.jsx)(f.A,{className:(0,t.cn)(g[b],"transition-colors",(c&&F||a)>=h?"fill-atacama-orange text-atacama-orange":"fill-gray-200 text-gray-200")})},h))})};return z?(0,d.jsx)(p.Zp,{className:"w-full",children:(0,d.jsx)(p.Wu,{className:"p-8",children:(0,d.jsx)("div",{className:"flex items-center justify-center",children:(0,d.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-atacama-orange"})})})}):(0,d.jsxs)("div",{className:"space-y-6",children:[(0,d.jsxs)(p.Zp,{children:[(0,d.jsx)(p.aR,{children:(0,d.jsx)(p.ZB,{children:"Rese\xf1as y Calificaciones"})}),(0,d.jsxs)(p.Wu,{children:[(0,d.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("div",{className:"text-4xl font-bold text-atacama-orange",children:N.average.toFixed(1)}),(0,d.jsx)(R,{value:Math.round(N.average),size:"lg"}),(0,d.jsxs)("p",{className:"text-sm text-muted-foreground mt-1",children:[N.total," rese\xf1a",1!==N.total?"s":""]})]}),(0,d.jsx)("div",{className:"col-span-2 space-y-2",children:[5,4,3,2,1].map(a=>{let b=N.distribution[a-1],c=N.total>0?b/N.total*100:0;return(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("span",{className:"text-sm w-3",children:a}),(0,d.jsx)(f.A,{className:"h-4 w-4 fill-atacama-orange text-atacama-orange"}),(0,d.jsx)(s.k,{value:c,className:"flex-1 h-2"}),(0,d.jsx)("span",{className:"text-sm text-muted-foreground w-10 text-right",children:b})]},a)})})]}),w&&!L&&!J&&(0,d.jsx)(n.$,{onClick:()=>K(!0),className:"w-full mt-6 bg-atacama-orange hover:bg-atacama-orange/90",children:"Escribir una rese\xf1a"}),J&&(0,d.jsx)(p.Zp,{className:"mt-6 border-atacama-orange/20",children:(0,d.jsx)(p.Wu,{className:"pt-6",children:(0,d.jsxs)("div",{className:"space-y-4",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Tu calificaci\xf3n"}),(0,d.jsx)(R,{value:D,size:"lg",interactive:!0,onRate:E})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Tu comentario"}),(0,d.jsx)(o.T,{value:H,onChange:a=>I(a.target.value),placeholder:"Comparte tu experiencia con este plato o cocinero...",rows:4,className:"resize-none"}),(0,d.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"M\xednimo 10 caracteres"})]}),(0,d.jsxs)("div",{className:"flex gap-2",children:[(0,d.jsx)(n.$,{onClick:Q,disabled:B||0===D,className:"flex-1 bg-atacama-orange hover:bg-atacama-orange/90",children:B?"Publicando...":"Publicar rese\xf1a"}),(0,d.jsx)(n.$,{variant:"outline",onClick:()=>{K(!1),E(0),I("")},disabled:B,children:"Cancelar"})]})]})})}),L&&(0,d.jsx)("div",{className:"mt-6 p-4 bg-green-50 dark:bg-green-950/20 rounded-lg border border-green-200 dark:border-green-800",children:(0,d.jsxs)("div",{className:"flex items-center gap-2 text-green-700 dark:text-green-400",children:[(0,d.jsx)(g.A,{className:"h-5 w-5"}),(0,d.jsx)("span",{className:"font-medium",children:"Ya has dejado una rese\xf1a"})]})})]})]}),x.length>0&&(0,d.jsxs)(p.Zp,{children:[(0,d.jsx)(p.aR,{children:(0,d.jsx)(p.ZB,{children:"Todas las rese\xf1as"})}),(0,d.jsx)(p.Wu,{className:"space-y-4",children:x.map(a=>(0,d.jsx)(p.Zp,{className:"border-gray-100 dark:border-gray-800",children:(0,d.jsx)(p.Wu,{className:"pt-6",children:(0,d.jsxs)("div",{className:"flex items-start gap-4",children:[(0,d.jsxs)(q.eu,{children:[(0,d.jsx)(q.BK,{src:a.customerAvatar}),(0,d.jsx)(q.q5,{children:(0,d.jsx)(h.A,{className:"h-4 w-4"})})]}),(0,d.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,d.jsxs)("div",{className:"flex items-start justify-between",children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("span",{className:"font-medium",children:a.customerName}),a.verified&&(0,d.jsxs)("div",{className:"flex items-center gap-1 text-xs text-green-600 dark:text-green-400",children:[(0,d.jsx)(g.A,{className:"h-3 w-3"}),(0,d.jsx)("span",{children:"Compra verificada"})]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,d.jsx)(R,{value:a.rating,size:"sm"}),a.dishName&&(0,d.jsxs)("span",{className:"text-sm text-muted-foreground",children:["â€¢ ",a.dishName]})]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[(0,d.jsx)(i.A,{className:"h-3 w-3"}),(0,k.GP)(a.createdAt.toDate(),"dd MMM yyyy")]})]}),(0,d.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:a.comment}),(0,d.jsxs)("button",{className:"flex items-center gap-1 text-sm text-muted-foreground hover:text-atacama-orange transition-colors",children:[(0,d.jsx)(j,{className:"h-3 w-3"}),(0,d.jsx)("span",{children:"\xdatil"})]})]})]})})},a.id))})]}),0===x.length&&!J&&(0,d.jsx)(p.Zp,{children:(0,d.jsx)(p.Wu,{className:"p-8 text-center text-muted-foreground",children:(0,d.jsx)("p",{children:"A\xfan no hay rese\xf1as. \xa1S\xe9 el primero en compartir tu experiencia!"})})})]})}}};
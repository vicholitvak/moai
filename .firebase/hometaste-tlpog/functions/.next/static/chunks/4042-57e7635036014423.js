"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4042],{41085:(e,a,t)=>{t.d(a,{CG:()=>d,Fm:()=>g,Qs:()=>f,cj:()=>c,h:()=>h,qp:()=>x});var s=t(95155),r=t(12115),i=t(15452),l=t(74466),n=t(54416),o=t(53999);let c=i.bL,d=i.l9;i.bm;let u=i.ZL,m=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(i.hJ,{className:(0,o.cn)("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...r,ref:a})});m.displayName=i.hJ.displayName;let p=(0,l.F)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),h=r.forwardRef((e,a)=>{let{side:t="right",className:r,children:l,...c}=e;return(0,s.jsxs)(u,{children:[(0,s.jsx)(m,{}),(0,s.jsxs)(i.UC,{ref:a,className:(0,o.cn)(p({side:t}),r),...c,children:[l,(0,s.jsxs)(i.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,s.jsx)(n.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});h.displayName=i.UC.displayName;let g=e=>{let{className:a,...t}=e;return(0,s.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-2 text-center sm:text-left",a),...t})};g.displayName="SheetHeader";let x=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(i.hE,{ref:a,className:(0,o.cn)("text-lg font-semibold text-foreground",t),...r})});x.displayName=i.hE.displayName;let f=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(i.VY,{ref:a,className:(0,o.cn)("text-sm text-muted-foreground",t),...r})});f.displayName=i.VY.displayName},74042:(e,a,t)=>{t.d(a,{n:()=>q});var s=t(95155),r=t(12115),i=t(35695),l=t(47924),n=t(66932),o=t(51154),c=t(14186),d=t(33109),u=t(38564),m=t(55868),p=t(4516),h=t(54416),g=t(97168),x=t(89852),f=t(88482),y=t(88145),v=t(54073),j=t(53999);let b=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsxs)(v.bL,{ref:a,className:(0,j.cn)("relative flex w-full touch-none select-none items-center",t),...r,children:[(0,s.jsx)(v.CC,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,s.jsx)(v.Q6,{className:"absolute h-full bg-primary"})}),(0,s.jsx)(v.zi,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]})});b.displayName=v.bL.displayName;var N=t(76981),w=t(5196);let C=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(N.bL,{ref:a,className:(0,j.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...r,children:(0,s.jsx)(N.C1,{className:(0,j.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(w.A,{className:"h-4 w-4"})})})});C.displayName=N.bL.displayName;var S=t(82714),k=t(41085),R=t(95784),A=t(76037),L=t(81198),D=t(98199),P=t(56671),E=t(45964),T=t.n(E);function q(e){let{onResultsChange:a,initialFilters:t={},compact:v=!1}=e;(0,i.useRouter)();let N=(0,i.useSearchParams)(),[w,E]=(0,r.useState)(t.query||N.get("q")||""),[q,F]=(0,r.useState)({query:t.query||N.get("q")||"",category:t.category||N.get("category")||void 0,priceRange:t.priceRange||{min:0,max:5e4},rating:t.rating||void 0,prepTime:t.prepTime||void 0,dietary:t.dietary||[],allergens:t.allergens||[],sortBy:t.sortBy||"relevance",availability:!0}),[z,M]=(0,r.useState)(null),[$,J]=(0,r.useState)(!1),[B,I]=(0,r.useState)(!1),[O,H]=(0,r.useState)([]),[_]=(0,r.useState)(["pizza","empanadas","ensalada","pasta","hamburguesa","sushi","tacos","parrilla","vegano","postres"]),[V,Z]=(0,r.useState)(null),[U,W]=(0,r.useState)(10),G=[{value:"vegetarian",label:"Vegetariano",icon:"\uD83E\uDD57"},{value:"vegan",label:"Vegano",icon:"\uD83C\uDF31"},{value:"gluten-free",label:"Sin Gluten",icon:"\uD83C\uDF3E"},{value:"keto",label:"Keto",icon:"\uD83E\uDD51"},{value:"paleo",label:"Paleo",icon:"\uD83E\uDD69"},{value:"low-carb",label:"Bajo en Carbohidratos",icon:"\uD83E\uDD66"},{value:"dairy-free",label:"Sin L\xe1cteos",icon:"\uD83E\uDD5B"},{value:"halal",label:"Halal",icon:"☪️"},{value:"kosher",label:"Kosher",icon:"✡️"}],Q=["Nueces","Man\xed","L\xe1cteos","Huevos","Mariscos","Pescado","Soya","Gluten","S\xe9samo","Mostaza"],Y=[{value:"all",label:"Todas",icon:"\uD83C\uDF7D️"},{value:"main",label:"Platos Principales",icon:"\uD83C\uDF56"},{value:"appetizer",label:"Entradas",icon:"\uD83E\uDD5F"},{value:"dessert",label:"Postres",icon:"\uD83C\uDF70"},{value:"beverage",label:"Bebidas",icon:"\uD83E\uDD64"},{value:"breakfast",label:"Desayuno",icon:"\uD83E\uDD5E"},{value:"lunch",label:"Almuerzo",icon:"\uD83E\uDD57"},{value:"dinner",label:"Cena",icon:"\uD83C\uDF5D"},{value:"snack",label:"Snacks",icon:"\uD83C\uDF7F"}],K=[{value:"15",label:"< 15 min",icon:"⚡"},{value:"30",label:"< 30 min",icon:"\uD83D\uDD50"},{value:"45",label:"< 45 min",icon:"\uD83D\uDD51"},{value:"60",label:"< 1 hora",icon:"\uD83D\uDD52"},{value:"60+",label:"> 1 hora",icon:"\uD83D\uDD53"}];(0,r.useEffect)(()=>{let e=localStorage.getItem("recentSearches");e&&H(JSON.parse(e).slice(0,5))},[]),(0,r.useEffect)(()=>{D.N.getCurrentLocation().then(e=>{e&&(Z(e),F(a=>({...a,location:e})))})},[]);let X=(0,r.useCallback)(T()(async e=>{J(!0);try{let t=await L.S.search(e);if(M(t),null==a||a(t),e.query&&e.query.trim()){let a=[e.query,...O.filter(a=>a!==e.query)].slice(0,5);H(a),localStorage.setItem("recentSearches",JSON.stringify(a))}}catch(e){console.error("Search error:",e),P.oR.error("Error al buscar. Por favor intenta nuevamente.")}finally{J(!1)}},500),[O,a]);(0,r.useEffect)(()=>{X({...q,query:w})},[w,q]);let ee=e=>{E(e),F(a=>({...a,query:e}))},ea=()=>{E(""),F({query:"",availability:!0,sortBy:"relevance",priceRange:{min:0,max:5e4}})},et=[q.category&&"all"!==q.category,q.rating,q.prepTime,q.dietary&&q.dietary.length>0,q.allergens&&q.allergens.length>0,q.priceRange&&(q.priceRange.min>0||q.priceRange.max<5e4)].filter(Boolean).length;if(v)return(0,s.jsxs)("div",{className:"relative w-full max-w-2xl",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(l.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-5 w-5"}),(0,s.jsx)(x.p,{type:"text",placeholder:"Buscar platos, cocineros, ingredientes...",value:w,onChange:e=>E(e.target.value),className:"pl-10 pr-24 h-12 text-base"}),(0,s.jsxs)("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 flex gap-2",children:[(0,s.jsxs)(g.$,{variant:"ghost",size:"sm",onClick:()=>I(!0),className:"relative",children:[(0,s.jsx)(n.A,{className:"h-4 w-4"}),et>0&&(0,s.jsx)(y.E,{variant:"destructive",className:"absolute -top-1 -right-1 h-5 w-5 p-0 flex items-center justify-center",children:et})]}),$&&(0,s.jsx)(o.A,{className:"h-4 w-4 animate-spin text-muted-foreground"})]})]}),!w&&(0,s.jsxs)("div",{className:"absolute top-full left-0 right-0 mt-2 p-4 bg-background border rounded-lg shadow-lg z-10",children:[O.length>0&&(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"B\xfasquedas recientes"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:O.map(e=>(0,s.jsxs)(g.$,{variant:"outline",size:"sm",onClick:()=>ee(e),className:"text-xs",children:[(0,s.jsx)(c.A,{className:"h-3 w-3 mr-1"}),e]},e))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Tendencias"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:_.slice(0,6).map(e=>(0,s.jsxs)(g.$,{variant:"ghost",size:"sm",onClick:()=>ee(e),className:"text-xs",children:[(0,s.jsx)(d.A,{className:"h-3 w-3 mr-1 text-atacama-orange"}),e]},e))})]})]}),(0,s.jsx)(k.cj,{open:B,onOpenChange:I,children:(0,s.jsxs)(k.h,{className:"w-full sm:max-w-lg overflow-y-auto",children:[(0,s.jsxs)(k.Fm,{children:[(0,s.jsx)(k.qp,{children:"Filtros de B\xfasqueda"}),(0,s.jsx)(k.Qs,{children:"Refina tu b\xfasqueda con filtros avanzados"})]}),es()]})})]});function es(){var e,a,t,r;return(0,s.jsxs)("div",{className:"space-y-6 mt-6",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(S.J,{children:"Ordenar por"}),(0,s.jsxs)(R.l6,{value:q.sortBy,onValueChange:e=>F(a=>({...a,sortBy:e})),children:[(0,s.jsx)(R.bq,{children:(0,s.jsx)(R.yv,{})}),(0,s.jsxs)(R.gC,{children:[(0,s.jsx)(R.eb,{value:"relevance",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(u.A,{className:"h-4 w-4 mr-2"}),"Relevancia"]})}),(0,s.jsx)(R.eb,{value:"price_low",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Precio: Menor a Mayor"]})}),(0,s.jsx)(R.eb,{value:"price_high",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Precio: Mayor a Menor"]})}),(0,s.jsx)(R.eb,{value:"rating",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(u.A,{className:"h-4 w-4 mr-2"}),"Mejor Calificaci\xf3n"]})}),(0,s.jsx)(R.eb,{value:"prep_time",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(c.A,{className:"h-4 w-4 mr-2"}),"Tiempo de Preparaci\xf3n"]})}),V&&(0,s.jsx)(R.eb,{value:"distance",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(p.A,{className:"h-4 w-4 mr-2"}),"M\xe1s Cercano"]})})]})]})]}),(0,s.jsx)(A.w,{}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(S.J,{children:"Categor\xeda"}),(0,s.jsx)("div",{className:"grid grid-cols-3 gap-2",children:Y.map(e=>(0,s.jsxs)(g.$,{variant:q.category===e.value?"default":"outline",size:"sm",onClick:()=>F(a=>({...a,category:"all"===e.value?void 0:e.value})),className:"justify-start",children:[(0,s.jsx)("span",{className:"mr-2",children:e.icon}),(0,s.jsx)("span",{className:"text-xs",children:e.label})]},e.value))})]}),(0,s.jsx)(A.w,{}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(S.J,{children:"Rango de Precio"}),(0,s.jsxs)("div",{className:"px-2",children:[(0,s.jsx)(b,{value:[(null==(e=q.priceRange)?void 0:e.min)||0,(null==(a=q.priceRange)?void 0:a.max)||5e4],onValueChange:e=>{let[a,t]=e;return F(e=>({...e,priceRange:{min:a,max:t}}))},max:5e4,step:1e3,className:"mb-2"}),(0,s.jsxs)("div",{className:"flex justify-between text-sm text-muted-foreground",children:[(0,s.jsx)("span",{children:(0,j.$g)((null==(t=q.priceRange)?void 0:t.min)||0)}),(0,s.jsx)("span",{children:(0,j.$g)((null==(r=q.priceRange)?void 0:r.max)||5e4)})]})]})]}),(0,s.jsx)(A.w,{}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(S.J,{children:"Calificaci\xf3n M\xednima"}),(0,s.jsx)("div",{className:"flex gap-2",children:[4,3,2,1].map(e=>(0,s.jsxs)(g.$,{variant:q.rating===e?"default":"outline",size:"sm",onClick:()=>F(a=>({...a,rating:a.rating===e?void 0:e})),children:[(0,s.jsx)(u.A,{className:"h-3 w-3 mr-1 fill-yellow-400 text-yellow-400"}),e,"+"]},e))})]}),(0,s.jsx)(A.w,{}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(S.J,{children:"Tiempo de Preparaci\xf3n"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2",children:K.map(e=>(0,s.jsxs)(g.$,{variant:q.prepTime===e.value?"default":"outline",size:"sm",onClick:()=>F(a=>({...a,prepTime:a.prepTime===e.value?void 0:e.value})),className:"justify-start",children:[(0,s.jsx)("span",{className:"mr-2",children:e.icon}),(0,s.jsx)("span",{className:"text-xs",children:e.label})]},e.value))})]}),(0,s.jsx)(A.w,{}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(S.J,{children:"Preferencias Diet\xe9ticas"}),(0,s.jsx)("div",{className:"grid grid-cols-2 gap-2",children:G.map(e=>{var a;return(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(C,{id:e.value,checked:null==(a=q.dietary)?void 0:a.includes(e.value),onCheckedChange:a=>{F(t=>{var s;return{...t,dietary:a?[...t.dietary||[],e.value]:(null==(s=t.dietary)?void 0:s.filter(a=>a!==e.value))||[]}})}}),(0,s.jsxs)(S.J,{htmlFor:e.value,className:"text-sm font-normal cursor-pointer",children:[(0,s.jsx)("span",{className:"mr-1",children:e.icon}),e.label]})]},e.value)})})]}),(0,s.jsx)(A.w,{}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(S.J,{children:"Excluir Al\xe9rgenos"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:Q.map(e=>{var a,t;return(0,s.jsxs)(y.E,{variant:(null==(a=q.allergens)?void 0:a.includes(e))?"destructive":"outline",className:"cursor-pointer",onClick:()=>{F(a=>{var t;return{...a,allergens:(null==(t=a.allergens)?void 0:t.includes(e))?a.allergens.filter(a=>a!==e):[...a.allergens||[],e]}})},children:[(null==(t=q.allergens)?void 0:t.includes(e))&&(0,s.jsx)(h.A,{className:"h-3 w-3 mr-1"}),e]},e)})})]}),V&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(A.w,{}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(S.J,{children:"Distancia M\xe1xima"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(p.A,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsx)(b,{value:[U],onValueChange:e=>{let[a]=e;W(a),F(e=>({...e,maxDistance:a}))},max:30,min:1,step:1,className:"flex-1"}),(0,s.jsxs)("span",{className:"text-sm font-medium w-12",children:[U," km"]})]})]})]}),(0,s.jsx)(A.w,{}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(g.$,{variant:"outline",className:"flex-1",onClick:ea,children:"Limpiar Filtros"}),(0,s.jsx)(g.$,{className:"flex-1 bg-atacama-orange hover:bg-atacama-orange/90",onClick:()=>I(!1),children:"Aplicar Filtros"})]})]})}return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)(f.Zp,{children:[(0,s.jsx)(f.aR,{children:(0,s.jsx)(f.ZB,{children:"B\xfasqueda Avanzada"})}),(0,s.jsx)(f.Wu,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(l.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-5 w-5"}),(0,s.jsx)(x.p,{type:"text",placeholder:"Buscar platos, cocineros, ingredientes...",value:w,onChange:e=>E(e.target.value),className:"pl-10 pr-4 h-12 text-base"}),$&&(0,s.jsx)(o.A,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-4 w-4 animate-spin text-muted-foreground"})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Populares:"}),_.map(e=>(0,s.jsx)(y.E,{variant:"secondary",className:"cursor-pointer hover:bg-secondary/80",onClick:()=>ee(e),children:e},e))]})]})})]}),(0,s.jsxs)(f.Zp,{children:[(0,s.jsx)(f.aR,{children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)(f.ZB,{children:"Filtros"}),et>0&&(0,s.jsxs)(g.$,{variant:"ghost",size:"sm",onClick:ea,children:["Limpiar (",et,")"]})]})}),(0,s.jsx)(f.Wu,{children:es()})]}),z&&(0,s.jsx)(f.Zp,{children:(0,s.jsx)(f.Wu,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:[z.totalResults," resultado",1!==z.totalResults?"s":""," encontrado",1!==z.totalResults?"s":""," ","en ",z.searchTime,"ms"]}),z.suggestions&&z.suggestions.length>0&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Sugerencias:"}),z.suggestions.map(e=>(0,s.jsx)(y.E,{variant:"outline",className:"cursor-pointer",onClick:()=>ee(e),children:e},e))]})]})})})]})}},76037:(e,a,t)=>{t.d(a,{w:()=>n});var s=t(95155),r=t(12115),i=t(87489),l=t(53999);let n=r.forwardRef((e,a)=>{let{className:t,orientation:r="horizontal",decorative:n=!0,...o}=e;return(0,s.jsx)(i.b,{ref:a,decorative:n,orientation:r,className:(0,l.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",t),...o})});n.displayName=i.b.displayName},81198:(e,a,t)=>{t.d(a,{S:()=>i});var s=t(46751),r=t(98199);class i{static async search(e){let a=Date.now();try{let t=await s.DishesService.getAllDishes();!1!==e.availability&&(t=t.filter(e=>e.isAvailable)),e.query&&(t=this.applyTextSearch(t,e.query),this.trackSearch(e.query)),e.category&&(t=t.filter(a=>{var t;return a.category.toLowerCase()===(null==(t=e.category)?void 0:t.toLowerCase())})),e.priceRange&&(t=t.filter(a=>a.price>=e.priceRange.min&&a.price<=e.priceRange.max)),e.rating&&(t=t.filter(a=>a.rating>=e.rating)),e.prepTime&&(t=this.applyPrepTimeFilter(t,e.prepTime)),e.dietary&&e.dietary.length>0&&(t=this.applyDietaryFilters(t,e.dietary)),e.allergens&&e.allergens.length>0&&(t=t.filter(a=>!a.allergens.some(a=>e.allergens.includes(a.toLowerCase())))),e.cookingStyle&&(t=await this.applyCookingStyleFilter(t,e.cookingStyle)),e.location&&(t=await this.applyLocationFilter(t,e.location,e.maxDistance)),t=this.calculateSearchScores(t,e),t=this.applySorting(t,e.sortBy||"relevance");let r=await this.generateFacets(t),i=this.generateSuggestions(e.query),l=Date.now()-a;return{dishes:t,totalResults:t.length,facets:r,suggestions:i,searchTime:l}}catch(e){return console.error("Search error:",e),{dishes:[],totalResults:0,facets:this.getEmptyFacets(),searchTime:Date.now()-a}}}static applyTextSearch(e,a){let t=a.toLowerCase().split(" ").filter(e=>e.length>1);return e.filter(e=>{let a=[e.name,e.description,e.category,...e.tags,...e.ingredients,e.cookerName].join(" ").toLowerCase();return t.some(e=>a.includes(e))})}static applyPrepTimeFilter(e,a){let t=parseInt(a);return e.filter(e=>{let s=parseInt(e.prepTime);return a.includes("60+")?s>=60:s<=t})}static applyDietaryFilters(e,a){return e.filter(e=>a.some(a=>e.tags.some(e=>e.toLowerCase().includes(a.toLowerCase()))||e.description.toLowerCase().includes(a.toLowerCase())))}static async applyCookingStyleFilter(e,a){try{let t=(await s.CooksService.getAllCooks()).filter(e=>{var t;return(null==(t=e.cookingStyle)?void 0:t.toLowerCase())===a.toLowerCase()}).map(e=>e.id);return e.filter(e=>t.includes(e.cookerId))}catch(a){return console.error("Error applying cooking style filter:",a),e}}static async applyLocationFilter(e,a){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15;try{let s=await r.N.getNearbyCooks(a.latitude,a.longitude,t);return e.filter(e=>s.find(a=>a.id===e.cookerId)).map(e=>{let t=s.find(a=>a.id===e.cookerId),i=r.N.calculateDeliveryFee(a,t.location.coordinates);return{...e,distance:null==t?void 0:t.distance,deliveryFee:i.totalFee,estimatedDeliveryTime:i.estimatedTime}})}catch(a){return console.error("Error applying location filter:",a),e}}static calculateSearchScores(e,a){return e.map(e=>{let t,s=[];if(t=0+10*e.rating+Math.min(.5*e.reviewCount,20),a.query){let r=a.query.toLowerCase();e.name.toLowerCase().includes(r)&&(t+=50,s.push("Nombre del plato")),e.description.toLowerCase().includes(r)&&(t+=30,s.push("Descripci\xf3n")),e.tags.some(e=>e.toLowerCase().includes(r))&&(t+=20,s.push("Categor\xeda"))}return a.category&&e.category.toLowerCase()===a.category.toLowerCase()&&(t+=25,s.push("Categor\xeda exacta")),e.rating>=4.5&&(t+=15,s.push("Muy bien valorado")),e.reviewCount>=20&&(t+=10,s.push("Muy popular")),{...e,score:t,matchReasons:s}})}static applySorting(e,a){switch(a){case"price_low":return e.sort((e,a)=>e.price-a.price);case"price_high":return e.sort((e,a)=>a.price-e.price);case"rating":return e.sort((e,a)=>a.rating-e.rating);case"prep_time":return e.sort((e,a)=>parseInt(e.prepTime)-parseInt(a.prepTime));case"distance":return e.sort((e,a)=>(e.distance||0)-(a.distance||0));default:return e.sort((e,a)=>(a.score||0)-(e.score||0))}}static async generateFacets(e){let a={};e.forEach(e=>{a[e.category]=(a[e.category]||0)+1}),e.map(e=>e.price);let t=this.generatePriceRanges(e),r={};e.forEach(e=>{let a=Math.floor(e.rating);r[a]=(r[a]||0)+1});let i={};try{let a=await s.CooksService.getAllCooks();e.forEach(e=>{let t=a.find(a=>a.id===e.cookerId);(null==t?void 0:t.cookingStyle)&&(i[t.cookingStyle]=(i[t.cookingStyle]||0)+1)})}catch(e){console.error("Error generating cooking style facets:",e)}let l={},n=["vegetarian","vegan","gluten-free","keto","paleo"];e.forEach(e=>{let a="".concat(e.description," ").concat(e.tags.join(" ")).toLowerCase();n.forEach(e=>{a.includes(e)&&(l[e]=(l[e]||0)+1)})});let o={};return e.forEach(e=>{let a=parseInt(e.prepTime),t="60+ min";a<=15?t="15 min":a<=30?t="30 min":a<=45&&(t="45 min"),o[t]=(o[t]||0)+1}),{categories:Object.entries(a).map(e=>{let[a,t]=e;return{name:a,count:t}}),priceRanges:t,ratings:Object.entries(r).map(e=>{let[a,t]=e;return{rating:parseInt(a),count:t}}),cookingStyles:Object.entries(i).map(e=>{let[a,t]=e;return{style:a,count:t}}),dietary:Object.entries(l).map(e=>{let[a,t]=e;return{type:a,count:t}}),prepTimes:Object.entries(o).map(e=>{let[a,t]=e;return{time:a,count:t}})}}static generatePriceRanges(e){return[{range:"Hasta $5.000",min:0,max:5e3},{range:"$5.000 - $10.000",min:5e3,max:1e4},{range:"$10.000 - $15.000",min:1e4,max:15e3},{range:"$15.000 - $20.000",min:15e3,max:2e4},{range:"M\xe1s de $20.000",min:2e4,max:1/0}].map(a=>({...a,count:e.filter(e=>e.price>=a.min&&e.price<a.max).length})).filter(e=>e.count>0)}static generateSuggestions(e){let a=["pizza","empanadas","sushi","hamburguesa","pasta","ensalada","pollo","vegetariano","vegan","sin gluten","postre","comida casera"];return e?a.filter(a=>a.includes(e.toLowerCase())).slice(0,5):a.slice(0,5)}static trackSearch(e){this.searchHistory.unshift(e),this.searchHistory=this.searchHistory.slice(0,100),this.popularSearches[e]=(this.popularSearches[e]||0)+1}static getEmptyFacets(){return{categories:[],priceRanges:[],ratings:[],cookingStyles:[],dietary:[],prepTimes:[]}}static async getRecommendations(e){try{let a=await s.DishesService.getAllDishes();if(a=a.filter(e=>e.isAvailable),e.location){let t=await r.N.getDishesForLocation(e.location,15);a=t.length>0?t:a}let t=a.map(a=>{var t,s;let r=0,i=[];if(r+=10*a.rating,r+=Math.min(.5*a.reviewCount,20),(null==(t=e.favoriteCategories)?void 0:t.includes(a.category))&&(r+=40,i.push("Te gusta ".concat(a.category))),e.dietaryPreferences){let t="".concat(a.description," ").concat(a.tags.join(" ")).toLowerCase();e.dietaryPreferences.forEach(e=>{t.includes(e.toLowerCase())&&(r+=30,i.push("Coincide con tu preferencia: ".concat(e)))})}return e.pricePreference&&("budget"===e.pricePreference&&a.price<=8e3?(r+=20,i.push("Precio econ\xf3mico")):"mid"===e.pricePreference&&a.price>8e3&&a.price<=15e3?(r+=20,i.push("Precio moderado")):"premium"===e.pricePreference&&a.price>15e3&&(r+=20,i.push("Opci\xf3n premium"))),a.rating>=4.5&&(r+=15,i.push("Muy bien valorado")),a.createdAt&&a.createdAt.toDate()>new Date(Date.now()-6048e5)&&(r+=10,i.push("Plato nuevo")),(null==(s=e.orderHistory)?void 0:s.includes(a.id))&&(r-=20),{...a,recommendationScore:r,recommendationReason:i[0]||"Recomendado para ti"}}).sort((e,a)=>a.recommendationScore-e.recommendationScore).slice(0,e.limit||10),i=Array.from(new Set(t.flatMap(e=>e.recommendationReason?[e.recommendationReason]:[])));return{dishes:t,reasons:i}}catch(e){return console.error("Error generating recommendations:",e),{dishes:[],reasons:[]}}}static async getSimilarDishes(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;try{let t=await s.DishesService.getAllDishes(),r=t.find(a=>a.id===e);if(!r)return[];return t.filter(a=>a.id!==e&&a.isAvailable).map(e=>{let a=0;e.category===r.category&&(a+=40);let t=e.tags.filter(e=>r.tags.includes(e)).length;a+=10*t,Math.abs(e.price-r.price)/r.price<=.3&&(a+=20),e.cookerId===r.cookerId&&(a+=30);let s=e.ingredients.filter(e=>r.ingredients.includes(e)).length;return a+=5*s,{...e,similarity:a}}).sort((e,a)=>a.similarity-e.similarity).slice(0,a)}catch(e){return console.error("Error getting similar dishes:",e),[]}}static async getTrendingDishes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;try{return(await s.DishesService.getAllDishes()).filter(e=>e.isAvailable).map(e=>{let a;return a=0+2*e.reviewCount+10*e.rating,e.createdAt&&e.createdAt.toDate()>new Date(Date.now()-12096e5)&&(a+=50),{...e,trendScore:a}}).sort((e,a)=>a.trendScore-e.trendScore).slice(0,e)}catch(e){return console.error("Error getting trending dishes:",e),[]}}static async getPopularCategories(){try{let e=await s.DishesService.getAllDishes(),a={};return e.filter(e=>e.isAvailable).forEach(e=>{a[e.category]||(a[e.category]={count:0,totalRating:0}),a[e.category].count++,a[e.category].totalRating+=e.rating}),Object.entries(a).map(e=>{let[a,t]=e;return{category:a,count:t.count,avgRating:t.totalRating/t.count}}).sort((e,a)=>a.count-e.count)}catch(e){return console.error("Error getting popular categories:",e),[]}}static getSearchAnalytics(){return{recentSearches:this.searchHistory.slice(0,10),popularSearches:Object.entries(this.popularSearches).sort((e,a)=>{let[,t]=e,[,s]=a;return s-t}).slice(0,10).map(e=>{let[a,t]=e;return{query:a,count:t}})}}}i.searchHistory=[],i.popularSearches={}},82714:(e,a,t)=>{t.d(a,{J:()=>l});var s=t(95155);t(12115);var r=t(40968),i=t(53999);function l(e){let{className:a,...t}=e;return(0,s.jsx)(r.b,{"data-slot":"label",className:(0,i.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",a),...t})}},95784:(e,a,t)=>{t.d(a,{bq:()=>m,eb:()=>x,gC:()=>g,l6:()=>d,yv:()=>u});var s=t(95155),r=t(12115),i=t(22918),l=t(66474),n=t(47863),o=t(5196),c=t(53999);let d=i.bL;i.YJ;let u=i.WT,m=r.forwardRef((e,a)=>{let{className:t,children:r,...n}=e;return(0,s.jsxs)(i.l9,{ref:a,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[r,(0,s.jsx)(i.In,{asChild:!0,children:(0,s.jsx)(l.A,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=i.l9.displayName;let p=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(i.PP,{ref:a,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,s.jsx)(n.A,{className:"h-4 w-4"})})});p.displayName=i.PP.displayName;let h=r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(i.wn,{ref:a,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",t),...r,children:(0,s.jsx)(l.A,{className:"h-4 w-4"})})});h.displayName=i.wn.displayName;let g=r.forwardRef((e,a)=>{let{className:t,children:r,position:l="popper",...n}=e;return(0,s.jsx)(i.ZL,{children:(0,s.jsxs)(i.UC,{ref:a,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:l,...n,children:[(0,s.jsx)(p,{}),(0,s.jsx)(i.LM,{className:(0,c.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,s.jsx)(h,{})]})})});g.displayName=i.UC.displayName,r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(i.JU,{ref:a,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...r})}).displayName=i.JU.displayName;let x=r.forwardRef((e,a)=>{let{className:t,children:r,...l}=e;return(0,s.jsxs)(i.q7,{ref:a,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...l,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(i.VF,{children:(0,s.jsx)(o.A,{className:"h-4 w-4"})})}),(0,s.jsx)(i.p4,{children:r})]})});x.displayName=i.q7.displayName,r.forwardRef((e,a)=>{let{className:t,...r}=e;return(0,s.jsx)(i.wv,{ref:a,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",t),...r})}).displayName=i.wv.displayName}}]);
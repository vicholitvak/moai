(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4560],{25731:(e,t,i)=>{"use strict";i.d(t,{A:()=>c,AuthProvider:()=>d});var s=i(95155),a=i(12115),r=i(66579),o=i(45404),n=i(35317);let l=(0,a.createContext)({user:null,role:null,loading:!0,logout:async()=>{}}),d=e=>{let{children:t}=e,[i,d]=(0,a.useState)(null),[c,u]=(0,a.useState)(null),[m,h]=(0,a.useState)(!0);(0,a.useEffect)(()=>{let e=(0,o.hg)(r.j,async e=>{try{if(e){d(e);let t="admin@moai.com"===e.email||"admin"===e.uid||e.email&&e.email.includes("admin"),i=(0,n.doc)(r.db,"users",e.uid),s=await (0,n.getDoc)(i),a=0,o=t?2:5;for(;!s.exists()&&a<o;){let t=Math.min(500*Math.pow(2,a),8e3);console.log("AuthContext: Retrying user document fetch (".concat(a+1,"/").concat(o,") after ").concat(t,"ms for ").concat(e.email)),await new Promise(e=>setTimeout(e,t)),s=await (0,n.getDoc)(i),a++}if(s.exists()){let a=s.data().role;t&&"Admin"!==a&&(a="Admin",await (0,n.BN)(i,{role:"Admin"},{merge:!0})),u(a),console.log("AuthContext: User ".concat(e.email," has role: ").concat(a))}else if(t)await (0,n.BN)(i,{role:"Admin"},{merge:!0}),u("Admin"),console.log("AuthContext: Created Admin role for ".concat(e.email));else{console.warn("AuthContext: User ".concat(e.email," document not found after ").concat(a," retries. This may indicate a network issue or missing registration.")),setTimeout(()=>{u(null),console.log("AuthContext: Set role to null for ".concat(e.email," after extended wait"))},2e3);return}}else d(null),u(null)}catch(t){console.error("Auth state change error:",t),e?(d(e),u("admin@moai.com"===e.email||"admin"===e.uid||e.email&&e.email.includes("admin")?"Admin":null)):(d(null),u(null))}finally{h(!1)}});return()=>e()},[]);let p=async()=>{try{await (0,o.CI)(r.j);try{await fetch("/api/auth/logout",{method:"POST"})}catch(e){console.warn("API logout failed, but Firebase logout succeeded:",e)}}catch(e){console.error("Error signing out:",e)}};return(0,s.jsx)(l.Provider,{value:{user:i,role:c,loading:m,logout:p},children:t})},c=()=>(0,a.useContext)(l)},53999:(e,t,i)=>{"use strict";i.d(t,{$B:()=>m,$g:()=>o,Dm:()=>d,HM:()=>l,bC:()=>u,cn:()=>r,generateDeliveryCode:()=>n,uA:()=>c});var s=i(52596),a=i(39688);function r(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return(0,a.QP)((0,s.$)(t))}function o(e){return"$".concat(Math.round(e).toLocaleString("es-CL"))}function n(){return Math.floor(1e3+9e3*Math.random()).toString()}function l(e){return e.replace(/(\d{2})(\d{2})/,"$1-$2")}function d(e){let t=0;return e.forEach(e=>{let i=function(e){var t,i;let s=e.toLowerCase();return s.includes("hour")?60*parseFloat((null==(t=s.match(/(\d+(?:\.\d+)?)/))?void 0:t[1])||"1"):s.includes("min")?parseInt((null==(i=s.match(/(\d+)/))?void 0:i[1])||"30"):30}(e.prepTime);i>t&&(t=i)}),t}function c(e,t){return Math.min(Math.max((new Date().getTime()-e.getTime())/6e4/t*100,0),100)}function u(e,t){let i=new Date(e);return i.setMinutes(i.getMinutes()+t),i}function m(e,t){let i=new Date,s=u(e,t).getTime()-i.getTime();if(s<=0)return"Listo";let a=Math.ceil(s/6e4);if(a<60)return"".concat(a," min");{let e=Math.floor(a/60);return"".concat(e,"h ").concat(a%60,"m")}}},57501:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>z});var s=i(95155),a=i(12115),r=i(35695),o=i(25731),n=i(46751),l=i(35317),d=i(67503),c=i(14186),u=i(40646),m=i(50744),h=i(37108),p=i(29799),f=i(85339),x=i(35169),g=i(66516),v=i(4516),j=i(24357),b=i(19420),y=i(81497),N=i(81586),w=i(71007),A=i(38564),k=i(97168),C=i(88482),S=i(88145),E=i(69663),P=i(41397),R=i(76037),I=i(53999),T=i(56671),D=i(60760),L=i(38274),B=i(55028),$=i(22610);let O=(0,B.default)(()=>Promise.all([i.e(9484),i.e(1761),i.e(7546),i.e(3904)]).then(i.bind(i,57546)),{loadableGenerated:{webpack:()=>[57546]},ssr:!1,loading:()=>(0,s.jsx)("div",{className:"h-96 bg-muted rounded-lg flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-2"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Cargando mapa..."})]})})}),M={pending:{label:"Pendiente",color:"yellow",icon:c.A,description:"Tu pedido est\xe1 esperando confirmaci\xf3n del cocinero"},accepted:{label:"Aceptado",color:"blue",icon:u.A,description:"El cocinero ha aceptado tu pedido"},preparing:{label:"Preparando",color:"orange",icon:m.A,description:"Tu pedido est\xe1 siendo preparado con amor"},ready:{label:"Listo",color:"green",icon:h.A,description:"\xa1Tu pedido est\xe1 listo para ser recogido!"},delivering:{label:"En camino",color:"purple",icon:p.A,description:"Tu pedido est\xe1 en camino hacia ti"},en_viaje:{label:"En viaje",color:"blue",icon:p.A,description:"El repartidor est\xe1 en camino. Puedes seguir su ubicaci\xf3n en tiempo real"},delivered:{label:"Entregado",color:"green",icon:u.A,description:"\xa1Tu pedido ha sido entregado exitosamente!"},cancelled:{label:"Cancelado",color:"red",icon:f.A,description:"Este pedido ha sido cancelado"}},z=()=>{var e,t,i,m,h,p,B,z,Z;let{orderId:W}=(0,r.useParams)(),_=(0,r.useRouter)(),{user:q}=(0,o.A)(),[U,F]=(0,a.useState)(null),[J,V]=(0,a.useState)(!0),[H,K]=(0,a.useState)(""),[G,X]=(0,a.useState)(null),[Q,Y]=(0,a.useState)(45),[ee,et]=(0,a.useState)(0),[ei,es]=(0,a.useState)(""),[ea,er]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(!q||!W)return void _.push("/login");eo();let e=en();return()=>{e&&e()}},[W,q]);let eo=async()=>{try{var e,t;V(!0);let i=await n.OrdersService.getOrderById(W);if(!i){T.oR.error("Pedido no encontrado");let e=(null==q?void 0:q.email)==="admin@moai.com"||(null==q||null==(t=q.email)?void 0:t.includes("admin"));_.push(e?"/admin/dashboard":"/client/home");return}let s=(null==q?void 0:q.email)==="admin@moai.com"||(null==q||null==(e=q.email)?void 0:e.includes("admin"));if(i.customerId!==(null==q?void 0:q.uid)&&!s){T.oR.error("No tienes permiso para ver este pedido"),_.push(s?"/admin/dashboard":"/client/home");return}F(i),K(i.deliveryCode||ed()),"delivered"!==i.status||i.reviewed||er(!0)}catch(e){console.error("Error fetching order:",e),T.oR.error("Error al cargar el pedido")}finally{V(!1)}},en=()=>{if(W)return n.OrdersService.subscribeToOrder(W,e=>{F(e),e&&e.status!==(null==U?void 0:U.status)&&(d.J.notifyOrderStatusChange(e.id,e.status,"customer"),el(e.status)),e&&"delivering"===e.status&&e.driverLocation&&X(e.driverLocation)})},el=e=>{Y({pending:45,accepted:40,preparing:30,ready:15,delivering:10,delivered:0}[e]||45)},ed=()=>Math.random().toString(36).substr(2,6).toUpperCase(),ec=async()=>{if(U&&"pending"===U.status)try{await n.OrdersService.updateOrder(U.id,{status:"cancelled",cancelledAt:l.Dc.now()}),T.oR.success("Pedido cancelado exitosamente"),_.push("/client/home")}catch(e){console.error("Error cancelling order:",e),T.oR.error("Error al cancelar el pedido")}};if(J)return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})});if(!U)return(0,s.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,s.jsx)(C.Zp,{children:(0,s.jsxs)(C.Wu,{className:"p-8 text-center",children:[(0,s.jsx)(f.A,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Pedido no encontrado"}),(0,s.jsx)("p",{className:"text-muted-foreground mb-4",children:"No pudimos encontrar el pedido que buscas"}),(0,s.jsx)(k.$,{onClick:()=>{var e;let t=(null==q?void 0:q.email)==="admin@moai.com"||(null==q||null==(e=q.email)?void 0:e.includes("admin"));_.push(t?"/admin/dashboard":"/client/home")},children:"Volver al inicio"})]})})});let eu=(null==(e=M[U.status])?void 0:e.icon)||c.A,em=M[U.status];return(0,s.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,s.jsx)("div",{className:"sticky top-0 z-50 border-b bg-background/95 backdrop-blur",children:(0,s.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(k.$,{variant:"ghost",size:"sm",onClick:()=>_.back(),children:(0,s.jsx)(x.A,{className:"h-4 w-4"})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"text-xl font-bold",children:["Pedido #",U.id.slice(-6)]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:new Date(null==(t=U.createdAt)?void 0:t.toDate()).toLocaleString()})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(k.$,{variant:"ghost",size:"sm",onClick:()=>{navigator.share?navigator.share({title:"Pedido #".concat(U.id.slice(-6)),text:"Mi pedido de Moai est\xe1 ".concat(M[U.status].label),url:window.location.href}):(navigator.clipboard.writeText(window.location.href),T.oR.success("Enlace copiado al portapapeles"))},children:(0,s.jsx)(g.A,{className:"h-4 w-4"})}),"pending"===U.status&&(0,s.jsx)(k.$,{variant:"destructive",size:"sm",onClick:ec,children:"Cancelar pedido"})]})]})})}),(0,s.jsx)("div",{className:"container mx-auto px-4 py-6",children:(0,s.jsxs)("div",{className:"grid lg:grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,s.jsxs)(C.Zp,{children:[(0,s.jsx)(C.aR,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(eu,{className:"h-6 w-6 text-".concat(null==em?void 0:em.color,"-500")}),(0,s.jsxs)("div",{children:[(0,s.jsx)(C.ZB,{children:null==em?void 0:em.label}),(0,s.jsx)(C.BT,{children:null==em?void 0:em.description})]})]}),(0,s.jsx)(S.E,{variant:(null==em?void 0:em.color)==="green"?"default":"secondary",children:null==em?void 0:em.label})]})}),(0,s.jsxs)(C.Wu,{children:[(0,s.jsx)(P.k,{value:(()=>{let e=["pending","accepted","preparing","ready","delivering","delivered"];return(e.indexOf((null==U?void 0:U.status)||"pending")+1)/e.length*100})(),className:"mb-4"}),("delivering"===U.status||"en_viaje"===U.status)&&(0,s.jsx)(D.N,{children:(0,s.jsxs)(L.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-primary/10 border border-primary/20 rounded-lg p-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("span",{className:"font-medium",children:"Tiempo estimado de llegada"}),(0,s.jsxs)("span",{className:"text-2xl font-bold",children:[Q," min"]})]}),G&&(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,s.jsx)(v.A,{className:"inline h-4 w-4 mr-1"}),"El repartidor est\xe1 cerca de tu ubicaci\xf3n"]})]})}),"en_viaje"===U.status&&U.deliveryInfo&&(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)(O,{orderId:U.id,customerLocation:{lat:-33.4489,lng:-70.6693,address:U.deliveryInfo.address},estimatedTime:Q,onTrackingUpdate:e=>{var t;if(null==(t=e.route)?void 0:t.duration){let t=parseInt(e.route.duration.replace(/\D/g,""));t&&Y(t)}}})}),"delivered"===U.status&&(0,s.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-2 text-green-700",children:[(0,s.jsx)(u.A,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"font-medium",children:"\xa1Pedido entregado exitosamente!"})]})})]})]}),(0,s.jsxs)(C.Zp,{children:[(0,s.jsxs)(C.aR,{children:[(0,s.jsx)(C.ZB,{children:"Detalles del pedido"}),(0,s.jsxs)(C.BT,{children:[(null==(i=U.dishes)?void 0:i.length)||0," items"]})]}),(0,s.jsx)(C.Wu,{children:(0,s.jsxs)("div",{className:"space-y-4",children:[null==(m=U.dishes)?void 0:m.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h4",{className:"font-medium",children:e.dishName}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Cantidad: ",e.quantity," • ",(0,I.$g)(e.price)," c/u"]})]}),(0,s.jsx)("span",{className:"font-semibold",children:(0,I.$g)(e.price*e.quantity)})]},t)),(0,s.jsx)(R.w,{}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{children:"Subtotal"}),(0,s.jsx)("span",{children:(0,I.$g)(U.subtotal)})]}),(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{children:"Delivery"}),(0,s.jsx)("span",{children:(0,I.$g)(U.deliveryFee)})]}),(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{children:"Tarifa de servicio"}),(0,s.jsx)("span",{children:(0,I.$g)(U.serviceFee)})]}),(0,s.jsx)(R.w,{}),(0,s.jsxs)("div",{className:"flex justify-between font-semibold text-lg",children:[(0,s.jsx)("span",{children:"Total"}),(0,s.jsx)("span",{children:(0,I.$g)(U.total)})]})]})]})})]}),ea&&"delivered"===U.status&&(0,s.jsx)($.y,{cookerId:U.cookerId,orderId:U.id,dishName:(null==(p=U.dishes)||null==(h=p[0])?void 0:h.dishName)||"Pedido",onReviewSubmit:async()=>{er(!1),await n.OrdersService.updateOrder(U.id,{reviewed:!0}),T.oR.success("\xa1Gracias por tu rese\xf1a!")}})]}),(0,s.jsxs)("div",{className:"space-y-6",children:["delivered"!==U.status&&"cancelled"!==U.status&&(0,s.jsxs)(C.Zp,{children:[(0,s.jsxs)(C.aR,{children:[(0,s.jsx)(C.ZB,{className:"text-lg",children:"C\xf3digo de entrega"}),(0,s.jsx)(C.BT,{children:"Comparte este c\xf3digo con el repartidor"})]}),(0,s.jsx)(C.Wu,{children:(0,s.jsxs)("div",{className:"bg-primary/10 rounded-lg p-4 text-center",children:[(0,s.jsx)("div",{className:"text-3xl font-bold tracking-wider mb-2",children:H}),(0,s.jsxs)(k.$,{variant:"ghost",size:"sm",onClick:()=>{navigator.clipboard.writeText(H),T.oR.success("C\xf3digo copiado al portapapeles")},className:"w-full",children:[(0,s.jsx)(j.A,{className:"h-4 w-4 mr-2"}),"Copiar c\xf3digo"]})]})})]}),(0,s.jsxs)(C.Zp,{children:[(0,s.jsx)(C.aR,{children:(0,s.jsx)(C.ZB,{className:"text-lg",children:"Informaci\xf3n de entrega"})}),(0,s.jsxs)(C.Wu,{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(v.A,{className:"h-4 w-4 mt-1 text-muted-foreground"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Direcci\xf3n"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:(null==(B=U.deliveryInfo)?void 0:B.address)||"No especificada"})]})]}),(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(b.A,{className:"h-4 w-4 mt-1 text-muted-foreground"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Tel\xe9fono"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:(null==(z=U.deliveryInfo)?void 0:z.phone)||"No especificado"})]})]}),(null==(Z=U.deliveryInfo)?void 0:Z.instructions)&&(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(y.A,{className:"h-4 w-4 mt-1 text-muted-foreground"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Instrucciones"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:U.deliveryInfo.instructions})]})]})]})]}),(0,s.jsxs)(C.Zp,{children:[(0,s.jsx)(C.aR,{children:(0,s.jsx)(C.ZB,{className:"text-lg",children:"Informaci\xf3n de pago"})}),(0,s.jsxs)(C.Wu,{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(N.A,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"M\xe9todo de pago"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"MercadoPago - Pagado"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(u.A,{className:"h-4 w-4 text-green-500"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Estado del pago"}),(0,s.jsx)("p",{className:"text-sm text-green-600",children:"Completado"})]})]})]})]}),"delivering"===U.status&&U.driverInfo&&(0,s.jsxs)(C.Zp,{children:[(0,s.jsx)(C.aR,{children:(0,s.jsx)(C.ZB,{className:"text-lg",children:"Tu repartidor"})}),(0,s.jsxs)(C.Wu,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,s.jsxs)(E.eu,{children:[(0,s.jsx)(E.BK,{src:U.driverInfo.avatar}),(0,s.jsx)(E.q5,{children:(0,s.jsx)(w.A,{className:"h-4 w-4"})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:U.driverInfo.name}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(A.A,{className:"h-3 w-3 fill-yellow-400 text-yellow-400"}),(0,s.jsx)("span",{className:"text-sm",children:U.driverInfo.rating})]})]})]}),(0,s.jsxs)(k.$,{variant:"outline",className:"w-full",children:[(0,s.jsx)(b.A,{className:"h-4 w-4 mr-2"}),"Llamar al repartidor"]})]})]}),(0,s.jsxs)(C.Zp,{children:[(0,s.jsx)(C.aR,{children:(0,s.jsx)(C.ZB,{className:"text-lg",children:"\xbfNecesitas ayuda?"})}),(0,s.jsxs)(C.Wu,{className:"space-y-2",children:[(0,s.jsxs)(k.$,{variant:"outline",className:"w-full justify-start",children:[(0,s.jsx)(y.A,{className:"h-4 w-4 mr-2"}),"Chat de soporte"]}),(0,s.jsxs)(k.$,{variant:"outline",className:"w-full justify-start",children:[(0,s.jsx)(b.A,{className:"h-4 w-4 mr-2"}),"Llamar a soporte"]})]})]})]})]})})]})}},66579:(e,t,i)=>{"use strict";let s;i.d(t,{db:()=>l,j:()=>n,y:()=>s});var a=i(23915),r=i(45404),o=i(35317);s=(0,a.Dk)().length?(0,a.Dk)()[0]:(0,a.Wp)({apiKey:"AIzaSyBptLm3y63BDBH9Xgt_UY40ZjsgUvMOKGI",authDomain:"hometaste-tlpog.firebaseapp.com",projectId:"hometaste-tlpog",storageBucket:"hometaste-tlpog.firebasestorage.app",messagingSenderId:"72297856520",appId:"1:72297856520:web:c7d851e4c00c67ec419bbd"});let n=(0,r.xI)(s),l=(0,o.aU)(s)},67503:(e,t,i)=>{"use strict";i.d(t,{J:()=>a});var s=i(56671);class a{static initialize(){this.requestPermission(),this.setupServiceWorker(),this.loadPreferences()}static async requestPermission(){if("Notification"in window){let e=await Notification.requestPermission();this.pushEnabled="granted"===e}}static setupServiceWorker(){"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(e=>{console.log("Service Worker registered:",e)}).catch(e=>{console.error("Service Worker registration failed:",e)})}static loadPreferences(){let e=localStorage.getItem("notificationPreferences");if(e){let{soundEnabled:t}=JSON.parse(e);this.soundEnabled=t}}static create(e){let t={...e,id:this.generateId(),timestamp:new Date,read:!1};return this.notifications.unshift(t),this.notifyListeners(),this.showToast(t),this.playSound(t),this.showPushNotification(t),this.persistNotifications(),t.id}static notifyOrderReceived(e,t,i){return this.create({title:"\xa1Nuevo Pedido Recibido!",message:"".concat(t," ha realizado un pedido por $").concat(i.toLocaleString("es-CL")),type:"success",priority:"high",category:"order",action:{label:"Ver Pedido",onClick:()=>window.location.href="/cooker/dashboard?order=".concat(e)},metadata:{orderId:e,customerName:t,total:i}})}static notifyOrderStatusChange(e,t,i){return this.create({title:"Estado del Pedido Actualizado",message:{accepted:"Tu pedido ha sido aceptado y est\xe1 siendo preparado",preparing:"Tu pedido est\xe1 siendo preparado",ready:"\xa1Tu pedido est\xe1 listo para recoger!",delivering:"Tu pedido est\xe1 en camino",delivered:"\xa1Tu pedido ha sido entregado!"}[t]||"Estado: ".concat(t),type:"info",priority:"medium",category:"order",metadata:{orderId:e,status:t,role:i}})}static notifyPaymentSuccess(e,t){return this.create({title:"Pago Exitoso",message:"Tu pago de $".concat(t.toLocaleString("es-CL")," ha sido procesado correctamente"),type:"success",priority:"high",category:"payment",metadata:{orderId:e,amount:t}})}static notifyPaymentFailed(e,t){return this.create({title:"Error en el Pago",message:"No se pudo procesar tu pago: ".concat(t),type:"error",priority:"high",category:"payment",action:{label:"Reintentar",onClick:()=>window.location.href="/payment/retry?order=".concat(e)},metadata:{orderId:e,reason:t}})}static notifyDriverAssigned(e,t){return this.create({title:"Repartidor Asignado",message:"".concat(t," ha sido asignado a tu pedido"),type:"info",priority:"medium",category:"delivery",metadata:{orderId:e,driverName:t}})}static notifyDeliveryUpdate(e,t){return this.create({title:"Actualizaci\xf3n de Entrega",message:t,type:"info",priority:"medium",category:"delivery",metadata:{orderId:e}})}static notifyPromotion(e,t,i){return this.create({title:e,message:"".concat(t," - ").concat(i,"% de descuento"),type:"info",priority:"low",category:"promotion",action:{label:"Ver Oferta",onClick:()=>window.location.href="/promotions"},metadata:{discount:i}})}static markAsRead(e){let t=this.notifications.find(t=>t.id===e);t&&(t.read=!0,this.notifyListeners(),this.persistNotifications())}static markAllAsRead(){this.notifications.forEach(e=>e.read=!0),this.notifyListeners(),this.persistNotifications()}static delete(e){this.notifications=this.notifications.filter(t=>t.id!==e),this.notifyListeners(),this.persistNotifications()}static clearAll(){this.notifications=[],this.notifyListeners(),this.persistNotifications()}static getUnreadCount(){return this.notifications.filter(e=>!e.read).length}static getNotifications(e){let t=this.notifications;return(null==e?void 0:e.category)&&(t=t.filter(t=>t.category===e.category)),(null==e?void 0:e.read)!==void 0&&(t=t.filter(t=>t.read===e.read)),(null==e?void 0:e.priority)&&(t=t.filter(t=>t.priority===e.priority)),t}static subscribe(e){return this.listeners.add(e),()=>this.listeners.delete(e)}static notifyListeners(){this.listeners.forEach(e=>e([...this.notifications]))}static persistNotifications(){try{localStorage.setItem("notifications",JSON.stringify(this.notifications))}catch(e){console.error("Error persisting notifications:",e)}}static loadPersistedNotifications(){try{let e=localStorage.getItem("notifications");e&&(this.notifications=JSON.parse(e).map(e=>({...e,timestamp:new Date(e.timestamp)})),this.notifyListeners())}catch(e){console.error("Error loading persisted notifications:",e)}}static generateId(){return"notif_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))}static showToast(e){let t={duration:e.duration||("high"===e.priority?5e3:3e3),action:e.action?{label:e.action.label,onClick:e.action.onClick}:void 0};switch(e.type){case"success":s.oR.success(e.title,{description:e.message,...t});break;case"error":s.oR.error(e.title,{description:e.message,...t});break;case"warning":s.oR.warning(e.title,{description:e.message,...t});break;default:s.oR.info(e.title,{description:e.message,...t})}}static playSound(e){if(this.soundEnabled&&"low"!==e.priority)try{let e=new Audio("/sounds/notification.mp3");e.volume=.3,e.play().catch(e=>{console.warn("Could not play notification sound:",e)})}catch(e){console.warn("Error playing notification sound:",e)}}static showPushNotification(e){this.pushEnabled&&"low"!==e.priority&&"Notification"in window&&"granted"===Notification.permission&&new Notification(e.title,{body:e.message,icon:"/icon-192x192.png",badge:"/icon-96x96.png",tag:e.id,requireInteraction:"high"===e.priority})}static setSoundEnabled(e){this.soundEnabled=e,localStorage.setItem("notificationPreferences",JSON.stringify({soundEnabled:e}))}static isSoundEnabled(){return this.soundEnabled}static setPushEnabled(e){this.pushEnabled=e,e&&this.requestPermission()}static isPushEnabled(){return this.pushEnabled}static cleanup(){let e=new Date;e.setDate(e.getDate()-7),this.notifications=this.notifications.filter(t=>t.timestamp>e||"high"===t.priority),this.notifyListeners(),this.persistNotifications()}static getMetrics(){let e=this.notifications.length;return{total:e,unread:this.getUnreadCount(),byCategory:this.notifications.reduce((e,t)=>(e[t.category]=(e[t.category]||0)+1,e),{})}}}a.notifications=[],a.listeners=new Set,a.soundEnabled=!0,a.pushEnabled=!1},69663:(e,t,i)=>{"use strict";i.d(t,{BK:()=>n,eu:()=>o,q5:()=>l});var s=i(95155),a=i(12115),r=i(53999);let o=a.forwardRef((e,t)=>{let{className:i,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",i),...a})});o.displayName="Avatar";let n=a.forwardRef((e,t)=>{let{className:i,...o}=e,[n,l]=a.useState(!1);return n||!o.src?null:(0,s.jsx)("img",{ref:t,className:(0,r.cn)("aspect-square h-full w-full object-cover",i),onError:()=>l(!0),...o})});n.displayName="AvatarImage";let l=a.forwardRef((e,t)=>{let{className:i,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted text-muted-foreground",i),...a})});l.displayName="AvatarFallback"},76037:(e,t,i)=>{"use strict";i.d(t,{w:()=>n});var s=i(95155),a=i(12115),r=i(87489),o=i(53999);let n=a.forwardRef((e,t)=>{let{className:i,orientation:a="horizontal",decorative:n=!0,...l}=e;return(0,s.jsx)(r.b,{ref:t,decorative:n,orientation:a,className:(0,o.cn)("shrink-0 bg-border","horizontal"===a?"h-[1px] w-full":"h-full w-[1px]",i),...l})});n.displayName=r.b.displayName},88145:(e,t,i)=>{"use strict";i.d(t,{E:()=>n});var s=i(95155);i(12115);var a=i(74466),r=i(53999);let o=(0,a.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:t,variant:i,...a}=e;return(0,s.jsx)("div",{className:(0,r.cn)(o({variant:i}),t),...a})}},88482:(e,t,i)=>{"use strict";i.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>l,Zp:()=>o,aR:()=>n});var s=i(95155),a=i(12115),r=i(53999);let o=a.forwardRef((e,t)=>{let{className:i,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm transition-all duration-300 hover:shadow-lg",i),...a})});o.displayName="Card";let n=a.forwardRef((e,t)=>{let{className:i,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",i),...a})});n.displayName="CardHeader";let l=a.forwardRef((e,t)=>{let{className:i,...a}=e;return(0,s.jsx)("h3",{ref:t,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",i),...a})});l.displayName="CardTitle";let d=a.forwardRef((e,t)=>{let{className:i,...a}=e;return(0,s.jsx)("p",{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",i),...a})});d.displayName="CardDescription";let c=a.forwardRef((e,t)=>{let{className:i,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",i),...a})});c.displayName="CardContent",a.forwardRef((e,t)=>{let{className:i,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",i),...a})}).displayName="CardFooter"},93182:(e,t,i)=>{Promise.resolve().then(i.bind(i,57501))},97168:(e,t,i)=>{"use strict";i.d(t,{$:()=>c});var s=i(95155),a=i(12115),r=i(99708),o=i(74466),n=i(38274),l=i(53999);let d=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-xl text-sm font-semibold transition-all duration-300 transform hover:scale-105 active:scale-95 disabled:pointer-events-none disabled:opacity-50 disabled:hover:scale-100 disabled:active:scale-100 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:ring-2 focus-visible:ring-offset-2 relative overflow-hidden group",{variants:{variant:{default:"bg-gradient-to-r from-moai-500 to-moai-600 text-white shadow-lg hover:shadow-xl hover:shadow-moai-500/25 border-0 hover:from-moai-600 hover:to-moai-700",destructive:"bg-gradient-to-r from-red-500 to-red-600 text-white shadow-lg hover:shadow-xl hover:shadow-red-500/25 hover:from-red-600 hover:to-red-700",outline:"border-2 border-moai-200 bg-background/80 backdrop-blur-sm shadow-sm hover:bg-moai-50 hover:text-moai-700 hover:border-moai-300 hover:shadow-md",secondary:"bg-gradient-to-r from-pacific-500 to-pacific-600 text-white shadow-lg hover:shadow-xl hover:shadow-pacific-500/25 hover:from-pacific-600 hover:to-pacific-700",ghost:"hover:bg-moai-50/80 hover:text-moai-700 hover:backdrop-blur-sm",link:"text-moai-600 underline-offset-4 hover:underline hover:text-moai-700 p-0 h-auto shadow-none hover:shadow-none",glass:"bg-white/10 backdrop-blur-md border border-white/20 text-white shadow-lg hover:bg-white/20 hover:shadow-xl",premium:"bg-gradient-to-r from-amber-400 via-orange-500 to-red-500 text-white shadow-lg hover:shadow-xl hover:shadow-orange-500/30 hover:from-amber-500 hover:via-orange-600 hover:to-red-600"},size:{default:"h-11 px-6 py-2",sm:"h-9 rounded-lg gap-1.5 px-4 text-xs",lg:"h-12 rounded-xl px-8 text-base",xl:"h-14 rounded-xl px-10 text-lg",icon:"size-11"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,t)=>{let{className:i,variant:a,size:o,asChild:c=!1,loading:u=!1,icon:m,glow:h=!1,children:p,...f}=e,x=c?r.DX:"button";return(0,s.jsxs)(x,{className:(0,l.cn)(d({variant:a,size:o,className:i})),ref:t,disabled:u||f.disabled,...f,children:[(0,s.jsx)("div",{className:"absolute inset-0 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 bg-gradient-to-r from-transparent via-white/20 to-transparent"}),h&&(0,s.jsx)("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-moai-500/20 to-pacific-500/20 blur-xl group-hover:blur-2xl transition-all duration-300 opacity-0 group-hover:opacity-100"}),u&&(0,s.jsx)(n.P.div,{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),m&&!u&&(0,s.jsx)(n.P.div,{whileHover:{scale:1.1},transition:{type:"spring",stiffness:400,damping:10},children:m}),(0,s.jsx)("span",{className:"relative z-10 flex items-center gap-2",children:p})]})});c.displayName="Button"}},e=>{e.O(0,[9135,3965,6331,2670,6671,2378,4872,8236,6751,2610,8441,5964,7358],()=>e(e.s=93182)),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1048],{381:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},4516:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},14186:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},19420:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]])},19946:(e,t,r)=>{"use strict";r.d(t,{A:()=>c});var a=r(12115);let i=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},s=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:i=24,strokeWidth:n=2,absoluteStrokeWidth:c,className:l="",children:d,iconNode:u,...m}=e;return(0,a.createElement)("svg",{ref:t,...o,width:i,height:i,stroke:r,strokeWidth:c?24*Number(n)/Number(i):n,className:s("lucide",l),...!d&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(m)&&{"aria-hidden":"true"},...m},[...u.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),c=(e,t)=>{let r=(0,a.forwardRef)((r,o)=>{let{className:c,...l}=r;return(0,a.createElement)(n,{ref:o,iconNode:t,className:s("lucide-".concat(i(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),c),...l})});return r.displayName=i(e),r}},23861:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]])},24357:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},25539:(e,t,r)=>{"use strict";r.d(t,{T:()=>a});class a{static async initialize(){try{if(!("serviceWorker"in navigator))return console.warn("Service Workers not supported"),{permission:"denied",supported:!1,serviceWorkerRegistered:!1};if(!("Notification"in window))return console.warn("Notifications not supported"),{permission:"denied",supported:!1,serviceWorkerRegistered:!1};try{return this.serviceWorkerRegistration=await navigator.serviceWorker.register("/sw.js",{scope:"/"}),console.log("Service Worker registered successfully:",this.serviceWorkerRegistration),await navigator.serviceWorker.ready,this.isInitialized=!0,navigator.serviceWorker.addEventListener("message",this.handleServiceWorkerMessage),{permission:Notification.permission,supported:!0,serviceWorkerRegistered:!0}}catch(e){return console.error("Service Worker registration failed:",e),{permission:Notification.permission,supported:!0,serviceWorkerRegistered:!1}}}catch(e){return console.error("Error initializing push notifications:",e),{permission:"denied",supported:!1,serviceWorkerRegistered:!1}}}static async requestPermission(){try{if(!("Notification"in window))return console.warn("Notifications not supported"),"denied";if("granted"===Notification.permission)return"granted";if("denied"===Notification.permission)return console.warn("Notification permission denied by user"),"denied";let e=await Notification.requestPermission();return console.log("Notification permission:",e),e}catch(e){return console.error("Error requesting notification permission:",e),"denied"}}static async showLocalNotification(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{if(!("Notification"in window))return void console.warn("Notifications not supported");if("granted"!==Notification.permission)return void console.warn("Notification permission not granted");let r={icon:"/icon-192x192.png",badge:"/icon-96x96.png",vibrate:[200,100,200],requireInteraction:!1,...t},a=new Notification(e,r);r.requireInteraction||setTimeout(()=>{a.close()},8e3),a.onclick=e=>{e.preventDefault(),a.close(),t.data&&t.data.url?(window.focus(),window.location.href=t.data.url):window.focus()}}catch(e){console.error("Error showing local notification:",e)}}static async showServiceWorkerNotification(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{if(!this.serviceWorkerRegistration)return console.warn("Service Worker not registered, falling back to local notification"),this.showLocalNotification(e,t);await this.serviceWorkerRegistration.showNotification(e,{icon:"/icon-192x192.png",badge:"/icon-96x96.png",vibrate:[200,100,200],requireInteraction:!1,...t})}catch(r){return console.error("Error showing service worker notification:",r),this.showLocalNotification(e,t)}}static async showOrderNotification(e){try{if("granted"!==Notification.permission)return void console.warn("Notification permission not granted");let t="Moai - Actualizaci\xf3n de Pedido",r="Tu pedido ha sido actualizado",a="/icon-192x192.png",i=!1,s=[200,100,200],o=[];switch(e.orderStatus){case"accepted":t="✅ Pedido Confirmado",r="Tu pedido #".concat(e.orderId.slice(-8)," ha sido confirmado").concat(e.cookerName?" por ".concat(e.cookerName):""),a="/notifications/accepted.png",o=[{action:"view",title:"Ver Pedido"}];break;case"preparing":t="\uD83D\uDC68‍\uD83C\uDF73 Preparando tu Pedido",r="".concat(e.cookerName||"El cocinero"," est\xe1 preparando tu pedido. \xa1Ya casi est\xe1 listo!"),a="/notifications/preparing.png",o=[{action:"track",title:"Ver Progreso"}];break;case"ready":t="\uD83C\uDF7D️ \xa1Pedido Listo!",r="Tu comida est\xe1 lista. Buscando conductor para la entrega.",a="/notifications/ready.png",s=[300,100,300,100,300],i=!0;break;case"delivering":t="\uD83D\uDE97 Conductor Asignado",r="".concat(e.driverName||"Un conductor"," est\xe1 en camino con tu pedido").concat(e.eta?". ETA: ".concat(e.eta):""),a="/notifications/delivering.png",o=[{action:"track",title:"Seguir en Tiempo Real"}],s=[200,100,200],i=!0;break;case"delivered":t="\uD83C\uDF89 \xa1Pedido Entregado!",r="\xa1Disfruta tu comida! No olvides calificar tu experiencia.",a="/notifications/delivered.png",o=[{action:"rate",title:"Calificar"}],s=[300,100,300,100,300,100,300],i=!0;break;case"cancelled":t="❌ Pedido Cancelado",r="Tu pedido ha sido cancelado. Te reembolsaremos el dinero.",a="/notifications/cancelled.png",o=[{action:"support",title:"Contactar Soporte"}];break;default:r=e.message||"Tu pedido ha sido actualizado"}let n={body:r,icon:a,badge:"/icon-96x96.png",vibrate:s,requireInteraction:i,actions:o,data:{orderId:e.orderId,orderStatus:e.orderStatus,url:e.url||"/orders/".concat(e.orderId,"/tracking"),timestamp:Date.now()},tag:"order-".concat(e.orderId),renotify:!0};this.serviceWorkerRegistration?await this.showServiceWorkerNotification(t,n):await this.showLocalNotification(t,n)}catch(e){console.error("Error showing order notification:",e)}}static getPermissionStatus(){return{permission:"Notification"in window?Notification.permission:"denied",supported:"Notification"in window&&"serviceWorker"in navigator,serviceWorkerRegistered:!!this.serviceWorkerRegistration}}static async showTestNotification(){await this.showOrderNotification({orderId:"test-order-123",orderStatus:"delivering",driverName:"Juan P\xe9rez",eta:"15 min",message:"Esta es una notificaci\xf3n de prueba"})}static cleanup(){"serviceWorker"in navigator&&navigator.serviceWorker.removeEventListener("message",this.handleServiceWorkerMessage)}static async setNotificationsEnabled(e){try{localStorage.setItem("moai-notifications-enabled",e.toString()),e&&"granted"!==Notification.permission&&await this.requestPermission(),console.log("Notifications",e?"enabled":"disabled")}catch(e){console.error("Error setting notification preference:",e)}}static areNotificationsEnabled(){let e=localStorage.getItem("moai-notifications-enabled");return null===e||"true"===e}}a.serviceWorkerRegistration=null,a.isInitialized=!1,a.handleServiceWorkerMessage=e=>{console.log("Received message from service worker:",e.data),e.data&&"NOTIFICATION_CLICKED"===e.data.type&&console.log("Notification was clicked:",e.data)}},25731:(e,t,r)=>{"use strict";r.d(t,{A:()=>d,AuthProvider:()=>l});var a=r(95155),i=r(12115),s=r(66579),o=r(45404),n=r(35317);let c=(0,i.createContext)({user:null,role:null,loading:!0,logout:async()=>{}}),l=e=>{let{children:t}=e,[r,l]=(0,i.useState)(null),[d,u]=(0,i.useState)(null),[m,h]=(0,i.useState)(!0);(0,i.useEffect)(()=>{let e=(0,o.hg)(s.j,async e=>{try{if(e){l(e);let t="admin@moai.com"===e.email||"admin"===e.uid||e.email&&e.email.includes("admin"),r=(0,n.doc)(s.db,"users",e.uid),a=await (0,n.getDoc)(r),i=0,o=t?2:5;for(;!a.exists()&&i<o;){let t=Math.min(500*Math.pow(2,i),8e3);console.log("AuthContext: Retrying user document fetch (".concat(i+1,"/").concat(o,") after ").concat(t,"ms for ").concat(e.email)),await new Promise(e=>setTimeout(e,t)),a=await (0,n.getDoc)(r),i++}if(a.exists()){let i=a.data().role;t&&"Admin"!==i&&(i="Admin",await (0,n.BN)(r,{role:"Admin"},{merge:!0})),u(i),console.log("AuthContext: User ".concat(e.email," has role: ").concat(i))}else if(t)await (0,n.BN)(r,{role:"Admin"},{merge:!0}),u("Admin"),console.log("AuthContext: Created Admin role for ".concat(e.email));else{console.warn("AuthContext: User ".concat(e.email," document not found after ").concat(i," retries. This may indicate a network issue or missing registration.")),setTimeout(()=>{u(null),console.log("AuthContext: Set role to null for ".concat(e.email," after extended wait"))},2e3);return}}else l(null),u(null)}catch(t){console.error("Auth state change error:",t),e?(l(e),u("admin@moai.com"===e.email||"admin"===e.uid||e.email&&e.email.includes("admin")?"Admin":null)):(l(null),u(null))}finally{h(!1)}});return()=>e()},[]);let p=async()=>{try{await (0,o.CI)(s.j);try{await fetch("/api/auth/logout",{method:"POST"})}catch(e){console.warn("API logout failed, but Firebase logout succeeded:",e)}}catch(e){console.error("Error signing out:",e)}};return(0,a.jsx)(c.Provider,{value:{user:r,role:d,loading:m,logout:p},children:t})},d=()=>(0,i.useContext)(c)},29799:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]])},35169:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},35695:(e,t,r)=>{"use strict";var a=r(18999);r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},35742:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]])},40646:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},53999:(e,t,r)=>{"use strict";r.d(t,{$B:()=>m,$g:()=>o,Dm:()=>l,HM:()=>c,bC:()=>u,cn:()=>s,generateDeliveryCode:()=>n,uA:()=>d});var a=r(52596),i=r(39688);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,i.QP)((0,a.$)(t))}function o(e){return"$".concat(Math.round(e).toLocaleString("es-CL"))}function n(){return Math.floor(1e3+9e3*Math.random()).toString()}function c(e){return e.replace(/(\d{2})(\d{2})/,"$1-$2")}function l(e){let t=0;return e.forEach(e=>{let r=function(e){var t,r;let a=e.toLowerCase();return a.includes("hour")?60*parseFloat((null==(t=a.match(/(\d+(?:\.\d+)?)/))?void 0:t[1])||"1"):a.includes("min")?parseInt((null==(r=a.match(/(\d+)/))?void 0:r[1])||"30"):30}(e.prepTime);r>t&&(t=r)}),t}function d(e,t){return Math.min(Math.max((new Date().getTime()-e.getTime())/6e4/t*100,0),100)}function u(e,t){let r=new Date(e);return r.setMinutes(r.getMinutes()+t),r}function m(e,t){let r=new Date,a=u(e,t).getTime()-r.getTime();if(a<=0)return"Listo";let i=Math.ceil(a/6e4);if(i<60)return"".concat(i," min");{let e=Math.floor(i/60);return"".concat(e,"h ").concat(i%60,"m")}}},54416:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},54861:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},63655:(e,t,r)=>{"use strict";r.d(t,{hO:()=>c,sG:()=>n});var a=r(12115),i=r(47650),s=r(99708),o=r(95155),n=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=(0,s.TL)(`Primitive.${t}`),i=a.forwardRef((e,a)=>{let{asChild:i,...s}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,o.jsx)(i?r:t,{...s,ref:a})});return i.displayName=`Primitive.${t}`,{...e,[t]:i}},{});function c(e,t){e&&i.flushSync(()=>e.dispatchEvent(t))}},66579:(e,t,r)=>{"use strict";let a;r.d(t,{db:()=>c,j:()=>n,y:()=>a});var i=r(23915),s=r(45404),o=r(35317);a=(0,i.Dk)().length?(0,i.Dk)()[0]:(0,i.Wp)({apiKey:"AIzaSyBptLm3y63BDBH9Xgt_UY40ZjsgUvMOKGI",authDomain:"hometaste-tlpog.firebaseapp.com",projectId:"hometaste-tlpog",storageBucket:"hometaste-tlpog.firebasestorage.app",messagingSenderId:"72297856520",appId:"1:72297856520:web:c7d851e4c00c67ec419bbd"});let n=(0,s.xI)(a),c=(0,o.aU)(a)},71007:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},75525:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},76037:(e,t,r)=>{"use strict";r.d(t,{w:()=>n});var a=r(95155),i=r(12115),s=r(87489),o=r(53999);let n=i.forwardRef((e,t)=>{let{className:r,orientation:i="horizontal",decorative:n=!0,...c}=e;return(0,a.jsx)(s.b,{ref:t,decorative:n,orientation:i,className:(0,o.cn)("shrink-0 bg-border","horizontal"===i?"h-[1px] w-full":"h-full w-[1px]",r),...c})});n.displayName=s.b.displayName},85339:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},87489:(e,t,r)=>{"use strict";r.d(t,{b:()=>l});var a=r(12115),i=r(63655),s=r(95155),o="horizontal",n=["horizontal","vertical"],c=a.forwardRef((e,t)=>{var r;let{decorative:a,orientation:c=o,...l}=e,d=(r=c,n.includes(r))?c:o;return(0,s.jsx)(i.sG.div,{"data-orientation":d,...a?{role:"none"}:{"aria-orientation":"vertical"===d?d:void 0,role:"separator"},...l,ref:t})});c.displayName="Separator";var l=c},87992:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>T});var a=r(95155),i=r(12115),s=r(35695),o=r(25731),n=r(46751),c=r(53999),l=r(56671),d=r(14186),u=r(40646),m=r(95747),h=r(85339),p=r(29799),g=r(54861),f=r(35169),x=r(71007),v=r(75525),b=r(24357),w=r(4516),y=r(19420),N=r(35742),j=r(97168),k=r(88482),A=r(88145),C=r(76037),S=r(23861);let P=(0,r(19946).A)("bell-off",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M17 17H4a1 1 0 0 1-.74-1.673C4.59 13.956 6 12.499 6 8a6 6 0 0 1 .258-1.742",key:"178tsu"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M8.668 3.01A6 6 0 0 1 18 8c0 2.687.77 4.653 1.707 6.05",key:"1hqiys"}]]);var E=r(381),R=r(54416),z=r(25539);function M(e){let{onPermissionGranted:t,onPermissionDenied:r,className:s="",showTestButton:o=!1}=e,[n,c]=(0,i.useState)({permission:"default",supported:!1,serviceWorkerRegistered:!1}),[d,m]=(0,i.useState)(!1),[p,g]=(0,i.useState)(!1),[f,x]=(0,i.useState)(!0);(0,i.useEffect)(()=>{v(),g("true"===localStorage.getItem("moai-notification-banner-dismissed")),x(z.T.areNotificationsEnabled())},[]);let v=async()=>{try{let e=await z.T.initialize();c(e)}catch(e){console.error("Error initializing notifications:",e)}},b=async()=>{m(!0);try{let e=await z.T.requestPermission(),a={...n,permission:e};c(a),"granted"===e?(l.oR.success("\xa1Notificaciones activadas! Te mantendremos informado sobre tus pedidos."),null==t||t(),g(!0),localStorage.setItem("moai-notification-banner-dismissed","true")):"denied"===e&&(l.oR.error("Notificaciones desactivadas. Puedes activarlas desde la configuraci\xf3n del navegador."),null==r||r())}catch(e){console.error("Error requesting notification permission:",e),l.oR.error("Error al solicitar permisos de notificaci\xf3n")}finally{m(!1)}},w=async()=>{try{await z.T.showTestNotification(),l.oR.success("\xa1Notificaci\xf3n de prueba enviada!")}catch(e){console.error("Error showing test notification:",e),l.oR.error("Error al enviar notificaci\xf3n de prueba")}},y=async()=>{let e=!f;x(e),await z.T.setNotificationsEnabled(e),e&&"granted"!==n.permission?b():l.oR.success(e?"Notificaciones activadas":"Notificaciones desactivadas")};if(!n.supported||p||"granted"===n.permission&&f&&!o)return null;let N="granted"===n.permission?{icon:(0,a.jsx)(u.A,{className:"h-5 w-5 text-green-600"}),status:"Activadas",color:"bg-green-50 border-green-200",textColor:"text-green-800"}:"denied"===n.permission?{icon:(0,a.jsx)(h.A,{className:"h-5 w-5 text-red-600"}),status:"Bloqueadas",color:"bg-red-50 border-red-200",textColor:"text-red-800"}:{icon:(0,a.jsx)(S.A,{className:"h-5 w-5 text-blue-600"}),status:"Disponibles",color:"bg-blue-50 border-blue-200",textColor:"text-blue-800"};return(0,a.jsx)(k.Zp,{className:"".concat(N.color," ").concat(s),children:(0,a.jsx)(k.Wu,{className:"p-4",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3 flex-1",children:[N.icon,(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("h3",{className:"font-semibold ".concat(N.textColor),children:"Notificaciones de Pedidos"}),(0,a.jsx)(A.E,{variant:"outline",className:"text-xs",children:N.status})]}),(0,a.jsx)("p",{className:"text-sm ".concat(N.textColor," mb-3"),children:"granted"===n.permission?f?"Recibir\xe1s notificaciones cuando tu pedido cambie de estado.":"Las notificaciones est\xe1n desactivadas. Act\xedvalas para recibir actualizaciones de tus pedidos.":"denied"===n.permission?"Las notificaciones est\xe1n bloqueadas. Puedes activarlas desde la configuraci\xf3n del navegador.":"Activa las notificaciones para recibir actualizaciones en tiempo real de tus pedidos."}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:["default"===n.permission&&(0,a.jsx)(j.$,{onClick:b,disabled:d,size:"sm",className:"bg-blue-600 hover:bg-blue-700",children:d?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Activando..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.A,{className:"h-4 w-4 mr-2"}),"Activar Notificaciones"]})}),"granted"===n.permission&&(0,a.jsx)(j.$,{onClick:y,size:"sm",variant:f?"outline":"default",children:f?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(P,{className:"h-4 w-4 mr-2"}),"Desactivar"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.A,{className:"h-4 w-4 mr-2"}),"Activar"]})}),"denied"===n.permission&&(0,a.jsxs)(j.$,{onClick:()=>{l.oR.info("Ve a la configuraci\xf3n de tu navegador para activar las notificaciones de Moai")},size:"sm",variant:"outline",children:[(0,a.jsx)(E.A,{className:"h-4 w-4 mr-2"}),"Configuraci\xf3n"]}),o&&"granted"===n.permission&&f&&(0,a.jsxs)(j.$,{onClick:w,size:"sm",variant:"outline",children:[(0,a.jsx)(S.A,{className:"h-4 w-4 mr-2"}),"Probar"]})]})]})]}),(0,a.jsx)(j.$,{variant:"ghost",size:"sm",onClick:()=>{g(!0),localStorage.setItem("moai-notification-banner-dismissed","true")},className:"ml-2 h-8 w-8 p-0 hover:bg-white/50",children:(0,a.jsx)(R.A,{className:"h-4 w-4"})})]})})})}let T=()=>{let e=(0,s.useRouter)(),{user:t,logout:r}=(0,o.A)(),[S,P]=(0,i.useState)([]),[E,R]=(0,i.useState)(!0);(0,i.useEffect)(()=>{t&&(async()=>{try{let e=await n.OrdersService.getOrdersByCustomer(t.uid);P(e)}catch(e){console.error("Error fetching orders:",e),l.oR.error("Error al cargar los pedidos")}finally{R(!1)}})()},[t]);let z=async e=>{try{await navigator.clipboard.writeText(e),l.oR.success("C\xf3digo copiado al portapapeles")}catch(e){l.oR.error("Error al copiar c\xf3digo")}};return E?(0,a.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):(0,a.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,a.jsx)("div",{className:"border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,a.jsx)("div",{className:"container mx-auto px-4 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)(j.$,{variant:"ghost",size:"sm",onClick:()=>e.back(),children:[(0,a.jsx)(f.A,{className:"h-4 w-4 mr-2"}),"Volver"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Mis Pedidos"}),(0,a.jsxs)("p",{className:"text-muted-foreground",children:[S.length," pedidos encontrados"]})]})]}),(0,a.jsxs)(j.$,{variant:"outline",size:"sm",onClick:r,className:"text-muted-foreground hover:text-destructive",children:[(0,a.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Cerrar Sesi\xf3n"]})]})})}),(0,a.jsxs)("div",{className:"container mx-auto px-4 py-6",children:[(0,a.jsx)(M,{className:"mb-6",onPermissionGranted:()=>{console.log("User granted notification permission")}}),0===S.length?(0,a.jsx)(k.Zp,{className:"text-center py-12",children:(0,a.jsxs)(k.Wu,{children:[(0,a.jsx)(m.A,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No tienes pedidos a\xfan"}),(0,a.jsx)("p",{className:"text-muted-foreground mb-4",children:"Explora nuestros deliciosos platos y haz tu primer pedido"}),(0,a.jsx)(j.$,{onClick:()=>e.push("/dishes"),children:"Ver Platos Disponibles"})]})}):(0,a.jsx)("div",{className:"space-y-6",children:S.map(t=>{var r,i,s;return(0,a.jsxs)(k.Zp,{children:[(0,a.jsx)(k.aR,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)(k.ZB,{className:"text-lg",children:["Pedido #",t.id.slice(-8)]}),(0,a.jsx)(k.BT,{children:null==(r=t.createdAt)?void 0:r.toDate().toLocaleDateString("es-CL",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})]}),(0,a.jsx)(A.E,{className:(e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"accepted":case"delivered":return"bg-green-100 text-green-800";case"preparing":return"bg-blue-100 text-blue-800";case"ready":return"bg-orange-100 text-orange-800";case"delivering":return"bg-purple-100 text-purple-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(t.status),children:(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(e=>{switch(e){case"pending":return(0,a.jsx)(d.A,{className:"h-4 w-4 text-yellow-500"});case"accepted":return(0,a.jsx)(u.A,{className:"h-4 w-4 text-green-500"});case"preparing":return(0,a.jsx)(m.A,{className:"h-4 w-4 text-blue-500"});case"ready":return(0,a.jsx)(h.A,{className:"h-4 w-4 text-orange-500"});case"delivering":return(0,a.jsx)(p.A,{className:"h-4 w-4 text-purple-500"});case"delivered":return(0,a.jsx)(u.A,{className:"h-4 w-4 text-green-600"});case"cancelled":return(0,a.jsx)(g.A,{className:"h-4 w-4 text-red-500"});default:return(0,a.jsx)(d.A,{className:"h-4 w-4 text-gray-400"})}})(t.status),(e=>{switch(e){case"pending":return"Pendiente";case"accepted":return"Aceptado";case"preparing":return"Preparando";case"ready":return"Listo para entrega";case"delivering":return"En camino";case"delivered":return"Entregado";case"cancelled":return"Cancelado";default:return e}})(t.status)]})})]})}),(0,a.jsxs)(k.Wu,{className:"space-y-4",children:["delivering"===t.status&&!t.isDelivered&&(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)(v.A,{className:"h-5 w-5 text-blue-600"}),(0,a.jsx)("span",{className:"font-semibold text-blue-800",children:"C\xf3digo de Entrega"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-2xl font-bold text-blue-800 font-mono",children:(0,c.HM)(t.deliveryCode)}),(0,a.jsxs)(j.$,{variant:"outline",size:"sm",onClick:()=>z(t.deliveryCode),className:"ml-auto",children:[(0,a.jsx)(b.A,{className:"h-4 w-4 mr-1"}),"Copiar"]})]}),(0,a.jsx)("p",{className:"text-sm text-blue-700 mt-2",children:"\uD83D\uDCF1 Proporciona este c\xf3digo al conductor para confirmar la entrega"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-medium mb-2",children:"Platos"}),(0,a.jsx)("div",{className:"space-y-2",children:t.dishes.map((e,t)=>(0,a.jsxs)("div",{className:"flex justify-between items-center text-sm",children:[(0,a.jsxs)("span",{children:[e.dishName," x ",e.quantity]}),(0,a.jsx)("span",{className:"font-medium",children:(0,c.$g)(e.price*e.quantity)})]},t))})]}),(0,a.jsx)(C.w,{}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(w.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{className:"font-medium",children:"Direcci\xf3n:"})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground ml-6",children:t.deliveryInfo.address})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(y.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{className:"font-medium",children:"Tel\xe9fono:"})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground ml-6",children:t.deliveryInfo.phone})]})]}),t.deliveryInfo.instructions&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)(h.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{className:"font-medium",children:"Instrucciones:"})]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground ml-6",children:t.deliveryInfo.instructions})]}),(0,a.jsx)(C.w,{}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{children:"Subtotal"}),(0,a.jsx)("span",{children:(0,c.$g)(t.subtotal)})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{children:"Entrega"}),(0,a.jsx)("span",{children:(0,c.$g)(t.deliveryFee)})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{children:"Servicio"}),(0,a.jsx)("span",{children:(0,c.$g)(t.serviceFee)})]}),(0,a.jsxs)("div",{className:"flex justify-between font-semibold text-lg border-t pt-2",children:[(0,a.jsx)("span",{children:"Total"}),(0,a.jsx)("span",{children:(0,c.$g)(t.total)})]})]}),t.actualDeliveryTime&&(0,a.jsx)("div",{className:"bg-green-50 border border-green-200 p-3 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(u.A,{className:"h-4 w-4 text-green-600"}),(0,a.jsxs)("span",{className:"text-sm font-medium text-green-800",children:["Entregado el ",(null==(s=t.actualDeliveryTime)||null==(i=s.toDate())?void 0:i.toLocaleString("es-CL"))||"N/A"]})]})}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 pt-4 border-t",children:[["pending","accepted","preparing","ready","delivering"].includes(t.status)&&(0,a.jsxs)(j.$,{onClick:()=>e.push("/orders/".concat(t.id,"/tracking")),className:"flex-1",variant:"default",children:[(0,a.jsx)(N.A,{className:"h-4 w-4 mr-2"}),"Ver Seguimiento"]}),"delivered"===t.status&&(0,a.jsxs)(j.$,{onClick:()=>e.push("/orders/".concat(t.id,"/tracking")),className:"flex-1",variant:"outline",children:[(0,a.jsx)(N.A,{className:"h-4 w-4 mr-2"}),"Ver Detalles"]}),"cancelled"===t.status&&(0,a.jsxs)(j.$,{disabled:!0,className:"flex-1",variant:"outline",children:[(0,a.jsx)(g.A,{className:"h-4 w-4 mr-2"}),"Pedido Cancelado"]})]})]})]},t.id)})})]})]})}},88145:(e,t,r)=>{"use strict";r.d(t,{E:()=>n});var a=r(95155);r(12115);var i=r(74466),s=r(53999);let o=(0,i.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:t,variant:r,...i}=e;return(0,a.jsx)("div",{className:(0,s.cn)(o({variant:r}),t),...i})}},88482:(e,t,r)=>{"use strict";r.d(t,{BT:()=>l,Wu:()=>d,ZB:()=>c,Zp:()=>o,aR:()=>n});var a=r(95155),i=r(12115),s=r(53999);let o=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm transition-all duration-300 hover:shadow-lg",r),...i})});o.displayName="Card";let n=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",r),...i})});n.displayName="CardHeader";let c=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("h3",{ref:t,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",r),...i})});c.displayName="CardTitle";let l=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("p",{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",r),...i})});l.displayName="CardDescription";let d=i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",r),...i})});d.displayName="CardContent",i.forwardRef((e,t)=>{let{className:r,...i}=e;return(0,a.jsx)("div",{ref:t,className:(0,s.cn)("flex items-center p-6 pt-0",r),...i})}).displayName="CardFooter"},95747:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(19946).A)("utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]])},96840:(e,t,r)=>{Promise.resolve().then(r.bind(r,87992))},97168:(e,t,r)=>{"use strict";r.d(t,{$:()=>d});var a=r(95155),i=r(12115),s=r(99708),o=r(74466),n=r(38274),c=r(53999);let l=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-xl text-sm font-semibold transition-all duration-300 transform hover:scale-105 active:scale-95 disabled:pointer-events-none disabled:opacity-50 disabled:hover:scale-100 disabled:active:scale-100 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:ring-2 focus-visible:ring-offset-2 relative overflow-hidden group",{variants:{variant:{default:"bg-gradient-to-r from-moai-500 to-moai-600 text-white shadow-lg hover:shadow-xl hover:shadow-moai-500/25 border-0 hover:from-moai-600 hover:to-moai-700",destructive:"bg-gradient-to-r from-red-500 to-red-600 text-white shadow-lg hover:shadow-xl hover:shadow-red-500/25 hover:from-red-600 hover:to-red-700",outline:"border-2 border-moai-200 bg-background/80 backdrop-blur-sm shadow-sm hover:bg-moai-50 hover:text-moai-700 hover:border-moai-300 hover:shadow-md",secondary:"bg-gradient-to-r from-pacific-500 to-pacific-600 text-white shadow-lg hover:shadow-xl hover:shadow-pacific-500/25 hover:from-pacific-600 hover:to-pacific-700",ghost:"hover:bg-moai-50/80 hover:text-moai-700 hover:backdrop-blur-sm",link:"text-moai-600 underline-offset-4 hover:underline hover:text-moai-700 p-0 h-auto shadow-none hover:shadow-none",glass:"bg-white/10 backdrop-blur-md border border-white/20 text-white shadow-lg hover:bg-white/20 hover:shadow-xl",premium:"bg-gradient-to-r from-amber-400 via-orange-500 to-red-500 text-white shadow-lg hover:shadow-xl hover:shadow-orange-500/30 hover:from-amber-500 hover:via-orange-600 hover:to-red-600"},size:{default:"h-11 px-6 py-2",sm:"h-9 rounded-lg gap-1.5 px-4 text-xs",lg:"h-12 rounded-xl px-8 text-base",xl:"h-14 rounded-xl px-10 text-lg",icon:"size-11"}},defaultVariants:{variant:"default",size:"default"}}),d=i.forwardRef((e,t)=>{let{className:r,variant:i,size:o,asChild:d=!1,loading:u=!1,icon:m,glow:h=!1,children:p,...g}=e,f=d?s.DX:"button";return(0,a.jsxs)(f,{className:(0,c.cn)(l({variant:i,size:o,className:r})),ref:t,disabled:u||g.disabled,...g,children:[(0,a.jsx)("div",{className:"absolute inset-0 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 bg-gradient-to-r from-transparent via-white/20 to-transparent"}),h&&(0,a.jsx)("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-moai-500/20 to-pacific-500/20 blur-xl group-hover:blur-2xl transition-all duration-300 opacity-0 group-hover:opacity-100"}),u&&(0,a.jsx)(n.P.div,{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),m&&!u&&(0,a.jsx)(n.P.div,{whileHover:{scale:1.1},transition:{type:"spring",stiffness:400,damping:10},children:m}),(0,a.jsx)("span",{className:"relative z-10 flex items-center gap-2",children:p})]})});d.displayName="Button"}},e=>{e.O(0,[9135,3965,6331,2670,6671,6751,8441,5964,7358],()=>e(e.s=96840)),_N_E=e.O()}]);
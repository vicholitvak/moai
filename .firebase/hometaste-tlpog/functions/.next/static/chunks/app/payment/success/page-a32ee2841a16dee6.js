(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8179],{14186:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(19946).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},19946:(e,r,t)=>{"use strict";t.d(r,{A:()=>l});var a=t(12115);let s=e=>{let r=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,t)=>t?t.toUpperCase():r.toLowerCase());return r.charAt(0).toUpperCase()+r.slice(1)},n=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return r.filter((e,r,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===r).join(" ").trim()};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,a.forwardRef)((e,r)=>{let{color:t="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:d="",children:c,iconNode:u,...m}=e;return(0,a.createElement)("svg",{ref:r,...o,width:s,height:s,stroke:t,strokeWidth:l?24*Number(i)/Number(s):i,className:n("lucide",d),...!c&&!(e=>{for(let r in e)if(r.startsWith("aria-")||"role"===r||"title"===r)return!0})(m)&&{"aria-hidden":"true"},...m},[...u.map(e=>{let[r,t]=e;return(0,a.createElement)(r,t)}),...Array.isArray(c)?c:[c]])}),l=(e,r)=>{let t=(0,a.forwardRef)((t,o)=>{let{className:l,...d}=t;return(0,a.createElement)(i,{ref:o,iconNode:r,className:n("lucide-".concat(s(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),l),...d})});return t.displayName=s(e),t}},35169:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(19946).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},35695:(e,r,t)=>{"use strict";var a=t(18999);t.o(a,"useParams")&&t.d(r,{useParams:function(){return a.useParams}}),t.o(a,"usePathname")&&t.d(r,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(r,{useSearchParams:function(){return a.useSearchParams}})},43891:(e,r,t)=>{Promise.resolve().then(t.bind(t,64752))},53999:(e,r,t)=>{"use strict";t.d(r,{$B:()=>m,$g:()=>o,Dm:()=>d,HM:()=>l,bC:()=>u,cn:()=>n,generateDeliveryCode:()=>i,uA:()=>c});var a=t(52596),s=t(39688);function n(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,s.QP)((0,a.$)(r))}function o(e){return"$".concat(Math.round(e).toLocaleString("es-CL"))}function i(){return Math.floor(1e3+9e3*Math.random()).toString()}function l(e){return e.replace(/(\d{2})(\d{2})/,"$1-$2")}function d(e){let r=0;return e.forEach(e=>{let t=function(e){var r,t;let a=e.toLowerCase();return a.includes("hour")?60*parseFloat((null==(r=a.match(/(\d+(?:\.\d+)?)/))?void 0:r[1])||"1"):a.includes("min")?parseInt((null==(t=a.match(/(\d+)/))?void 0:t[1])||"30"):30}(e.prepTime);t>r&&(r=t)}),r}function c(e,r){return Math.min(Math.max((new Date().getTime()-e.getTime())/6e4/r*100,0),100)}function u(e,r){let t=new Date(e);return t.setMinutes(t.getMinutes()+r),t}function m(e,r){let t=new Date,a=u(e,r).getTime()-t.getTime();if(a<=0)return"Listo";let s=Math.ceil(a/6e4);if(s<60)return"".concat(s," min");{let e=Math.floor(s/60);return"".concat(e,"h ").concat(s%60,"m")}}},64752:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>v});var a=t(95155),s=t(12115),n=t(35695),o=t(75525),i=t(40646);let l=(0,t(19946).A)("receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);var d=t(14186),c=t(35169),u=t(97168),m=t(88482),h=t(88145),p=t(13008),x=t(70977),f=t(56671);function g(){let e=(0,n.useRouter)(),r=(0,n.useSearchParams)(),[t,g]=(0,s.useState)(null),[v,b]=(0,s.useState)(!0),[j,y]=(0,s.useState)(!1),w=r.get("payment_id");r.get("status");let N=r.get("external_reference"),k="true"===r.get("hold");(0,s.useEffect)(()=>{(async()=>{if(w)try{let e=await p._.getPaymentStatus(w);g(e),k&&("authorized"===e.status||"approved"===e.status)&&!j&&(await C(w),y(!0))}catch(e){console.error("Error fetching payment data:",e)}b(!1)})()},[w,k,j]);let C=async e=>{try{let r=sessionStorage.getItem("pendingApprovalOrder");if(!r)return void console.error("No stored order data found");let{ordersByCook:t,orderForm:a,user:s,totals:n}=JSON.parse(r);console.log("Creating orders with approved payment:",e);let o=Object.entries(t).map(async r=>{let[o,i]=r,l={customerId:s.uid,customerName:s.displayName||s.email||"Cliente",customerEmail:s.email||"",cookerId:o,dishes:i.map(e=>({dishId:e.dishId,dishName:e.name,quantity:e.quantity,price:e.price,prepTime:e.prepTime})),subtotal:i.reduce((e,r)=>e+r.totalPrice,0),deliveryFee:n.deliveryFee/Object.keys(t).length,serviceFee:n.serviceFee/Object.keys(t).length,total:i.reduce((e,r)=>e+r.totalPrice,0)+n.deliveryFee/Object.keys(t).length+n.serviceFee/Object.keys(t).length,deliveryInfo:{address:a.deliveryAddress,phone:a.phone,instructions:a.specialInstructions},paymentMethod:"card",paymentId:e};return x.n.createOrderWithApproval(l)});(await Promise.all(o)).filter(Boolean).length>0&&(sessionStorage.removeItem("pendingApprovalOrder"),f.oR.success("\xa1\xd3rdenes creadas!",{description:"Tus \xf3rdenes han sido enviadas para aprobaci\xf3n del cocinero.",duration:4e3}))}catch(e){console.error("Error creating orders from stored data:",e),f.oR.error("Error al crear las \xf3rdenes. Por favor, contacta soporte.")}};return v?(0,a.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):(0,a.jsx)("div",{className:"min-h-screen bg-background",children:(0,a.jsx)("div",{className:"container mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,a.jsx)("div",{className:"text-center mb-8",children:k?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.A,{className:"h-20 w-20 text-blue-500 mx-auto mb-4"}),(0,a.jsx)("h1",{className:"text-3xl font-bold mb-2 text-blue-600",children:"\xa1Pago Autorizado!"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Tu pago est\xe1 en espera hasta la aprobaci\xf3n del cocinero"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.A,{className:"h-20 w-20 text-green-500 mx-auto mb-4"}),(0,a.jsx)("h1",{className:"text-3xl font-bold mb-2 text-green-600",children:"\xa1Pago Exitoso!"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Tu pago ha sido procesado correctamente"})]})}),(0,a.jsxs)(m.Zp,{className:"mb-6",children:[(0,a.jsx)(m.aR,{children:(0,a.jsxs)(m.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(l,{className:"h-5 w-5"}),"Detalles del Pago"]})}),(0,a.jsxs)(m.Wu,{className:"space-y-4",children:[t&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:"ID de Pago:"}),(0,a.jsx)("span",{className:"font-mono text-sm",children:t.id})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:"Estado:"}),(0,a.jsx)(h.E,{className:"bg-green-100 text-green-800",children:p._.getPaymentStatusText(t.status)})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:"Monto:"}),(0,a.jsx)("span",{className:"font-semibold text-lg",children:p._.formatCurrency(t.transaction_amount)})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:"M\xe9todo de Pago:"}),(0,a.jsx)("span",{className:"capitalize",children:t.payment_method_id})]}),t.date_approved&&(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:"Fecha de Aprobaci\xf3n:"}),(0,a.jsx)("span",{className:"text-sm",children:new Date(t.date_approved).toLocaleString("es-CL")})]})]}),N&&(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{children:"N\xfamero de Orden:"}),(0,a.jsx)("span",{className:"font-mono text-sm",children:N})]})]})]}),(0,a.jsx)(m.Zp,{className:"mb-6 ".concat(k?"border-blue-200 bg-blue-50":"border-green-200 bg-green-50"),children:(0,a.jsx)(m.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[k?(0,a.jsx)(o.A,{className:"h-5 w-5 text-blue-600 mt-0.5"}):(0,a.jsx)(d.A,{className:"h-5 w-5 text-green-600 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold mb-1 ".concat(k?"text-blue-800":"text-green-800"),children:"\xbfQu\xe9 sigue?"}),k?(0,a.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1",children:[(0,a.jsx)("li",{children:"• Tu pago est\xe1 autorizado y en espera"}),(0,a.jsx)("li",{children:"• El cocinero debe aprobar tu pedido primero"}),(0,a.jsx)("li",{children:"• Recibir\xe1s notificaciones cuando sea aprobado"}),(0,a.jsx)("li",{children:"• Una vez aprobado, se procesar\xe1 el pago y comenzar\xe1 la preparaci\xf3n"}),(0,a.jsx)("li",{children:"• Si es rechazado, se cancelar\xe1 la autorizaci\xf3n autom\xe1ticamente"})]}):(0,a.jsxs)("ul",{className:"text-sm text-green-700 space-y-1",children:[(0,a.jsx)("li",{children:"• Tu pedido ha sido confirmado y enviado al cocinero"}),(0,a.jsx)("li",{children:"• Recibir\xe1s notificaciones sobre el estado de tu pedido"}),(0,a.jsx)("li",{children:"• El cocinero comenzar\xe1 a preparar tu comida"}),(0,a.jsx)("li",{children:"• Un conductor recoger\xe1 y entregar\xe1 tu pedido"}),(0,a.jsx)("li",{children:"• Tiempo estimado de entrega: 45-60 minutos"})]})]})]})})}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(u.$,{className:"w-full",onClick:()=>e.push("/client/orders"),children:"Ver Mis Pedidos"}),(0,a.jsxs)(u.$,{variant:"outline",className:"w-full",onClick:()=>e.push("/dishes"),children:[(0,a.jsx)(c.A,{className:"h-4 w-4 mr-2"}),"Continuar Comprando"]})]})]})})})}function v(){return(0,a.jsx)(s.Suspense,{fallback:(0,a.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}),children:(0,a.jsx)(g,{})})}},66579:(e,r,t)=>{"use strict";let a;t.d(r,{db:()=>l,j:()=>i,y:()=>a});var s=t(23915),n=t(45404),o=t(35317);a=(0,s.Dk)().length?(0,s.Dk)()[0]:(0,s.Wp)({apiKey:"AIzaSyBptLm3y63BDBH9Xgt_UY40ZjsgUvMOKGI",authDomain:"hometaste-tlpog.firebaseapp.com",projectId:"hometaste-tlpog",storageBucket:"hometaste-tlpog.firebasestorage.app",messagingSenderId:"72297856520",appId:"1:72297856520:web:c7d851e4c00c67ec419bbd"});let i=(0,n.xI)(a),l=(0,o.aU)(a)},88145:(e,r,t)=>{"use strict";t.d(r,{E:()=>i});var a=t(95155);t(12115);var s=t(74466),n=t(53999);let o=(0,s.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:r,variant:t,...s}=e;return(0,a.jsx)("div",{className:(0,n.cn)(o({variant:t}),r),...s})}},88482:(e,r,t)=>{"use strict";t.d(r,{BT:()=>d,Wu:()=>c,ZB:()=>l,Zp:()=>o,aR:()=>i});var a=t(95155),s=t(12115),n=t(53999);let o=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm transition-all duration-300 hover:shadow-lg",t),...s})});o.displayName="Card";let i=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...s})});i.displayName="CardHeader";let l=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("h3",{ref:r,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",t),...s})});l.displayName="CardTitle";let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("p",{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",t),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("p-6 pt-0",t),...s})});c.displayName="CardContent",s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("flex items-center p-6 pt-0",t),...s})}).displayName="CardFooter"},97168:(e,r,t)=>{"use strict";t.d(r,{$:()=>c});var a=t(95155),s=t(12115),n=t(99708),o=t(74466),i=t(38274),l=t(53999);let d=(0,o.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-xl text-sm font-semibold transition-all duration-300 transform hover:scale-105 active:scale-95 disabled:pointer-events-none disabled:opacity-50 disabled:hover:scale-100 disabled:active:scale-100 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:ring-2 focus-visible:ring-offset-2 relative overflow-hidden group",{variants:{variant:{default:"bg-gradient-to-r from-moai-500 to-moai-600 text-white shadow-lg hover:shadow-xl hover:shadow-moai-500/25 border-0 hover:from-moai-600 hover:to-moai-700",destructive:"bg-gradient-to-r from-red-500 to-red-600 text-white shadow-lg hover:shadow-xl hover:shadow-red-500/25 hover:from-red-600 hover:to-red-700",outline:"border-2 border-moai-200 bg-background/80 backdrop-blur-sm shadow-sm hover:bg-moai-50 hover:text-moai-700 hover:border-moai-300 hover:shadow-md",secondary:"bg-gradient-to-r from-pacific-500 to-pacific-600 text-white shadow-lg hover:shadow-xl hover:shadow-pacific-500/25 hover:from-pacific-600 hover:to-pacific-700",ghost:"hover:bg-moai-50/80 hover:text-moai-700 hover:backdrop-blur-sm",link:"text-moai-600 underline-offset-4 hover:underline hover:text-moai-700 p-0 h-auto shadow-none hover:shadow-none",glass:"bg-white/10 backdrop-blur-md border border-white/20 text-white shadow-lg hover:bg-white/20 hover:shadow-xl",premium:"bg-gradient-to-r from-amber-400 via-orange-500 to-red-500 text-white shadow-lg hover:shadow-xl hover:shadow-orange-500/30 hover:from-amber-500 hover:via-orange-600 hover:to-red-600"},size:{default:"h-11 px-6 py-2",sm:"h-9 rounded-lg gap-1.5 px-4 text-xs",lg:"h-12 rounded-xl px-8 text-base",xl:"h-14 rounded-xl px-10 text-lg",icon:"size-11"}},defaultVariants:{variant:"default",size:"default"}}),c=s.forwardRef((e,r)=>{let{className:t,variant:s,size:o,asChild:c=!1,loading:u=!1,icon:m,glow:h=!1,children:p,...x}=e,f=c?n.DX:"button";return(0,a.jsxs)(f,{className:(0,l.cn)(d({variant:s,size:o,className:t})),ref:r,disabled:u||x.disabled,...x,children:[(0,a.jsx)("div",{className:"absolute inset-0 -translate-x-full group-hover:translate-x-full transition-transform duration-1000 bg-gradient-to-r from-transparent via-white/20 to-transparent"}),h&&(0,a.jsx)("div",{className:"absolute inset-0 rounded-xl bg-gradient-to-r from-moai-500/20 to-pacific-500/20 blur-xl group-hover:blur-2xl transition-all duration-300 opacity-0 group-hover:opacity-100"}),u&&(0,a.jsx)(i.P.div,{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full",animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),m&&!u&&(0,a.jsx)(i.P.div,{whileHover:{scale:1.1},transition:{type:"spring",stiffness:400,damping:10},children:m}),(0,a.jsx)("span",{className:"relative z-10 flex items-center gap-2",children:p})]})});c.displayName="Button"}},e=>{e.O(0,[9135,3965,6331,2670,6671,2482,6751,977,8441,5964,7358],()=>e(e.s=43891)),_N_E=e.O()}]);